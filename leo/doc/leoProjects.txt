#@+leo-ver=5-thin
#@+node:ekr.20100120072650.6089: * @file ../doc/leoProjects.txt
#@+all
#@+node:ekr.20130807203905.16727: **  porting docutils
# This project has failed.
#@+node:ekr.20130807203905.16728: *3* notes re 2to3 fixers
A fixes:
--fix=except
--fix=raise 
--fix=print
--fix=callable # no changes.
--fix=dict # changes suggested, but they don't look like they are needed.
--fix=exec # no changes.
--fix=execfile # no changes.
--fix=filter # one change, but this should be needed.
--fix=funcattrs # no changes.
--fix=has_key # changes suggested, but this code is weird.  Not sure it is wise to do this.
--fix=idioms # optional.  Not made yet.
--fix=input # no changes.
--fix=intern # no changes.
--fix=isinstance # no changes.
--fix=itertool_imports # no changes.
--fix=itertoos # no changes.
--fix=long # no changes.
--fix=map # one change suggested, suppressed by adding from future_builtins import map.
--fix=metaclass # no changes.
--fix=methodattrs # no changes.
--fix=ne # no changes.
--fix=numliterals # no changes.
--fix=paren # no changes.
--fix=raw_input # no changes.
--fix=reduce # no changes.
--fix=renames # two files changed automatically.
--fix=repr # no changes.
--fix=set_literal # no changes.
--fix=standard_error # no such fixer!
--fix=sys_exc # no changes.
--fix=throw # no changes.
--fix=tuple_params # no changes.
--fix=xrange ### Several changes.  Can be done automatically.
--fix=xreadlines # no changes.

B fixes:
--fix=basestring
    OK: docutils\nodes.py
    docutils\utils\math\math2html.py
--fix=buffer # no changes.
--fix=getcwdu # *** applied change by hand.
--fix=imports2 # no changes.
--fix=imports # see below
    These must be modified:
        docutils\writers\docutils_xml.py
        docutils\writers\odf_odt\__init__.py
--fix=next # Changes suggested.  Not sure what to do about them.
--fix=nonzero # changed nodes.py by hand.
--fix=types ### Two changes needed.
--fix=unicode # This removes U from U'string', and is probably not necessary (because the files compile correctly)
--fix=urrlib ### Several changes needed.
#@+node:ekr.20130807203905.16729: *3* New 2to3 fixers
# The python-modernize package makes these unnecessary.
#@+node:ekr.20130807203905.16730: *4* @@nosent C:\Python27\Lib\lib2to3\fixes\fix_unified_unicode.py
"""Fixer that changes u"..." into u("...") and ur("...") into u(r"...").

"""

@language python
@tabwidth -4

import re
from .. import fixer_base

_literal_re = re.compile(ur"[uU][rR]?[\'\"]")

class FixUnifiedUnicode(fixer_base.BaseFix):
    
    BM_compatible = True
    PATTERN = "STRING"

    def transform(self, node, results):
        if _literal_re.match(node.value):
            node.value = "u(%s)" % node.value[1:]
            node.changed()
#@+node:ekr.20130807203905.16731: *4* @@nosent C:\Python27\Lib\lib2to3\fixes\fix_unified_imports.py
"""
Fix incompatible imports and module references so the work with Python 2 and 3.
"""

# Authors: Collin Winter, Nick Edds, Edward K. Ream.

@language python
@tabwidth -4

<< imports >>
<< define mapping >>

@others
#@+node:ekr.20130807203905.16732: *5* << imports >>

# Local imports
from .. import fixer_base
from ..fixer_util import Name,Newline,Node,Leaf,String,attr_chain,find_binding

# EKR imports
from ..pgen2 import token

import pprint
pp = pprint.PrettyPrinter(indent=4)

import leo.core.leoGlobals as g
#@+node:ekr.20130807203905.16733: *5* << define mapping >>
MAPPING = {
    'StringIO':  'io',
    'cStringIO': 'io',
    'cPickle': 'pickle',
    '__builtin__' : 'builtins',
    'copy_reg': 'copyreg',
    'Queue': 'queue',
    'SocketServer': 'socketserver',
    'ConfigParser': 'configparser',
    'repr': 'reprlib',
    'FileDialog': 'tkinter.filedialog',
    'tkFileDialog': 'tkinter.filedialog',
    'SimpleDialog': 'tkinter.simpledialog',
    'tkSimpleDialog': 'tkinter.simpledialog',
    'tkColorChooser': 'tkinter.colorchooser',
    'tkCommonDialog': 'tkinter.commondialog',
    'Dialog': 'tkinter.dialog',
    'Tkdnd': 'tkinter.dnd',
    'tkFont': 'tkinter.font',
    'tkMessageBox': 'tkinter.messagebox',
    'ScrolledText': 'tkinter.scrolledtext',
    'Tkconstants': 'tkinter.constants',
    'Tix': 'tkinter.tix',
    'ttk': 'tkinter.ttk',
    'Tkinter': 'tkinter',
    'markupbase': '_markupbase',
    '_winreg': 'winreg',
    'thread': '_thread',
    'dummy_thread': '_dummy_thread',
    # anydbm and whichdb are handled by fix_imports2
    'dbhash': 'dbm.bsd',
    'dumbdbm': 'dbm.dumb',
    'dbm': 'dbm.ndbm',
    'gdbm': 'dbm.gnu',
    'xmlrpclib': 'xmlrpc.client',
    'DocXMLRPCServer': 'xmlrpc.server',
    'SimpleXMLRPCServer': 'xmlrpc.server',
    'httplib': 'http.client',
    'htmlentitydefs' : 'html.entities',
    'HTMLParser' : 'html.parser',
    'Cookie': 'http.cookies',
    'cookielib': 'http.cookiejar',
    'BaseHTTPServer': 'http.server',
    'SimpleHTTPServer': 'http.server',
    'CGIHTTPServer': 'http.server',
    #'test.test_support': 'test.support',
    'commands': 'subprocess',
    'UserString' : 'collections',
    'UserList' : 'collections',
    'urlparse' : 'urllib.parse',
    'robotparser' : 'urllib.robotparser',
}
#@+node:ekr.20130807203905.16734: *5* alternates
def alternates(members):
    return "(" + "|".join(map(repr, members)) + ")"

#@+node:ekr.20130807203905.16735: *5* build_pattern
def build_pattern(mapping=MAPPING):
    mod_list = ' | '.join(["module_name='%s'" % key for key in mapping])
    bare_names = alternates(mapping.keys())
    yield """name_import=import_name< 'import' ((%s) |
               multiple_imports=dotted_as_names< any* (%s) any* >) >
          """ % (mod_list, mod_list)
    yield """import_from< 'from' (%s) 'import' ['(']
              ( any | import_as_name< any 'as' any > |
                import_as_names< any* >)  [')'] >
          """ % mod_list
    yield """import_name< 'import' (dotted_as_name< (%s) 'as' any > |
               multiple_imports=dotted_as_names<
                 any* dotted_as_name< (%s) 'as' any > any* >) >
          """ % (mod_list, mod_list)

    # Find usages of module members in code e.g. thread.foo(bar)
    yield "power< bare_with_attr=(%s) trailer<'.' any > any* >" % bare_names

#@+node:ekr.20130807203905.16736: *5* class FixUnifiedImports
class FixUnifiedImports(fixer_base.BaseFix):

    BM_compatible = True
    keep_line_order = True
    # This is overridden in fix_imports2.
    mapping = MAPPING

    # We want to run this fixer late, so fix_import doesn't try to make stdlib
    # renames into relative imports.
    run_order = 6

    @others
#@+node:ekr.20130807203905.16737: *6* build_pattern
def build_pattern(self):
    return "|".join(build_pattern(self.mapping))

#@+node:ekr.20130807203905.16738: *6* compile_pattern
def compile_pattern(self):
    # We override this, so MAPPING can be pragmatically altered and the
    # changes will be reflected in PATTERN.
    self.PATTERN = self.build_pattern()
    super(FixUnifiedImports, self).compile_pattern()

#@+node:ekr.20130807203905.16739: *6* dump
def dump(self,aDict):
    if not aDict: return '<None>'
    result = []
    for key in aDict:
        result.append('')
        val = aDict.get(key)
        result.append('%s: %s' % (key,pp.pformat(val)))
    return '\n'.join(result)

#@+node:ekr.20130807203905.16740: *6* match
# Don't match the node if it's within another match.

def match(self, node):
    match = super(FixUnifiedImports, self).match
    results = match(node)
    if results:
        # Module usage could be in the trailer of an attribute lookup, so we
        # might have nested matches when "bare_with_attr" is present.
        if (
            "bare_with_attr" not in results and 
            any(match(obj) for obj in attr_chain(node, "parent"))
        ):
            return False
        return results
    return False

#@+node:ekr.20130807203905.16741: *6* start_tree
def start_tree(self, tree, filename):
    super(FixUnifiedImports, self).start_tree(tree, filename)
    self.replace = {}
    
#@+node:ekr.20130807203905.16742: *6* transform (fix_unified_imports)
@
mod_list = ' | '.join(["module_name='%s'" % key for key in mapping])

bare_names = alternates(mapping.keys())
    
"""name_import=import_name<
    'import' ((%s) |
    multiple_imports=dotted_as_names< any* (%s) any* >)
>
""" % (mod_list, mod_list)
          
"""import_from<
    'from' (%s) 'import' ['('] ( any |
    import_as_name< any 'as' any > |
    import_as_names< any* >)  [')']
>
""" % mod_list

"""import_name<
    'import' (dotted_as_name< (%s) 'as' any > |
    multiple_imports=dotted_as_names< any* dotted_as_name< (%s) 'as' any > any* >)
>
""" % (mod_list, mod_list)
@c


def transform(self, node, results):
    trace = False
    if 0:
        # print('\ntransform: node:\n%s' % node)
        print('\ntransform: results: %s\n' % self.dump(results))
    # g.trace(sorted(results.keys()))
    import_mod = results.get("module_name")
    name_import = results.get('name_import')
    # print('transform',import_mod,sorted(results.keys()))
    if import_mod:
        mod_name = import_mod.value
        new_name = unicode(self.mapping[mod_name])
        if 0: #original
            import_mod.replace(Name(new_name, prefix=import_mod.prefix))
        else:
            prefix = node.prefix # was import_mod.prefix
            clone = node.clone()
            clone2 = node.clone()
            node2 = self.find_name(clone2,mod_name)
            node2.replace(Name(new_name,prefix=import_mod.prefix))
            indent = Name('    ',prefix=prefix) # A hack.
            node.replace([ # was node.replace.
                String('if sys.version_info < (3,):',prefix=prefix),
                Newline(),indent,
                clone,
                Newline(),
                Name('else:',prefix=prefix),
                Newline(),indent,
                clone2,
                Newline(),
            ])
            
        if 1: # old code.
            if "name_import" in results:
                # If it's not a "from x import x, y" or "import x as y" import,
                # marked its usage to be replaced.
                g.trace('******',mod_name,new_name)
                self.replace[mod_name] = new_name
            if "multiple_imports" in results:
                # This is a nasty hack to fix multiple imports on a line (e.g.,
                # "import StringIO, urlparse"). The problem is that I can't
                # figure out an easy way to make a pattern recognize the keys of
                # MAPPING randomly sprinkled in an import statement.
                results = self.match(node)
                if results:
                    self.transform(node, results)
    elif 1:
        # Replace usage of the module.
        bare_name = results["bare_with_attr"][0]
        new_name = self.replace.get(bare_name.value)
        old = results.get('node').clone()
        if trace: g.trace('==== old',old)
        if new_name:
            if trace: g.trace('===== replace',bare_name,bare_name.value,new_name)
            if 0:
                bare_name.replace(Name(new_name, prefix=bare_name.prefix))
            else:
                bare_name.replace([
                    old,
                    String(' if sys.version_info < (3,) else '),
                    Name(new_name),
                ])
#@+node:ekr.20130807203905.16743: *6* find_name (EKR)
def find_name(self,root,name):
    '''Find a Name subnode of root defining name'''
    
    # print('find_name',name,root)
    for node in root.post_order():
        # print('find_name',node)
        if node.type == 1 and node.value == name:
            # print('find_name: found',node)
            return node
    return None
#@+node:ekr.20130807203905.16744: *4* trace
transform: node:
    Node(import_from, [
        Leaf(1, u'from'),
        Leaf(1, u'StringIO'),
        Leaf(1, u'import'),
        Node(import_as_name, [
            Leaf(1, u'StringIO'),
            Leaf(1, u'as'),
            Leaf(1, u'BytesIO')
        ])
    ])

transform: results: {
    'module_name': Leaf(1, u'StringIO'),
    'node': Node(import_from, [
        Leaf(1, u'from'),
        Leaf(1, u'StringIO'),
        Leaf(1, u'import'),
        Node(import_as_name, [
            Leaf(1,u'StringIO'),
            Leaf(1, u'as'),
            Leaf(1, u'BytesIO')
        ])
    ])
}

transform: node:
    Node(import_name, [
        Leaf(1, u'import'),
        Leaf(1, u'__builtin__')
    ])

transform: results: {
    'module_name': Leaf(1, u'__builtin__'),
    'name_import': Node(import_name, [Leaf(1, u'import'), Leaf(1, u'__builtin__')]),
    'node': Node(import_name, [
        Leaf(1, u'import'),
        Leaf(1, u'__builtin__')
    ])
}

transform: node:
    Node(power, [
        Leaf(1, u'__builtin__'),
        Node(trailer, [
            Leaf(23, u'.'), Leaf(1, u'__import__')
        ]),
        Node(trailer, [
            Leaf(7, u'('), Node(arglist, [
                Leaf(1, u'name'),
                Leaf(12, u','),
                Leaf(1, u'globals'),
                Leaf(12, u','),
                Leaf(1, u'locals'), Leaf(12, u','),
                Leaf(1, u'fromlist')
            ]),
            Leaf(8, u')')
        ])
    ])

transform: results: {
    'bare_with_attr': [Leaf(1, u'__builtin__')],
    'node': Node(power, [
        Leaf(1, u'__builtin__'),
        Node(trailer, [
            Leaf(23, u'.'),
            Leaf(1, u'__import__')
        ]),
        Node(trailer, [
            Leaf(7, u'('),
            Node(arglist, [
                Leaf(1, u'name'),
                Leaf(12, u','),
                Leaf(1, u'globals'),
                Leaf(12, u','),
                Leaf(1, u'locals'),
                Leaf(12, u','),
                Leaf(1, u'fromlist')
            ]), 
            Leaf(8, u')')
        ])
    ])
}

RefactoringTool: Refactored docutils\_compat.py
--- docutils\_compat.py (original)
+++ docutils\_compat.py (refactored)
@@ -20,7 +20,7 @@
 if sys.version_info < (3,0):
     b = bytes = str
     u_prefix = 'u'
-    from StringIO import StringIO as BytesIO
+    from io import StringIO as BytesIO
 else:
     import builtins
     bytes = builtins.bytes
@@ -37,7 +37,7 @@
     BytesIO = __import__('io').BytesIO

 if sys.version_info < (2,5):
-    import __builtin__
+    import builtins

     def __import__(name, globals={}, locals={}, fromlist=[], level=-1):
         """Compatibility definition for Python 2.4.
@@ -45,4 +45,4 @@
         Silently ignore the `level` argument missing in Python < 2.5.
         """
         # we need the level arg because the default changed in Python 3.3
-        return __builtin__.__import__(name, globals, locals, fromlist)
+        return builtins.__import__(name, globals, locals, fromlist)

transform: node:
    Node(import_name, [
        Leaf(1, u'import'),
        Node(dotted_as_name, [
            Leaf(1, u'ConfigParser'),
            Leaf(1, u'as'),
            Leaf(1, u'CP')
        ])
    )]

transform: results: {
    'module_name': Leaf(1, u'ConfigParser'),
    'node': Node(import_name, [
        Leaf(1, u'import'),
        Node(dotted_as_name, [
            Leaf(1, u'ConfigParser'),
            Leaf(1, u'as'),
            Leaf(1, u'CP')
        ])
    ])
}

RefactoringTool: Refactored docutils\frontend.py
--- docutils\frontend.py        (original)
+++ docutils\frontend.py        (refactored)
@@ -35,7 +35,7 @@
 import warnings
 ### 2to3.
 if sys.version_info < (3,0):
-    import ConfigParser as CP
+    import configparser as CP
 else:
     import configparser as CP
 import codecs

transform: node:
    Node(import_from, [
        Leaf(1, u'from'),
        Leaf(1, u'StringIO'),
        Leaf(1, u'import'),
        Leaf(1, u'StringIO')
    ])

transform: results: {
    'module_name': Leaf(1, u'StringIO'),
    'node': Node(import_from, [
        Leaf(1, u'from'),
        Leaf(1, u'StringIO'),
        Leaf(1, u'import'),
        Leaf(1, u'StringIO')
    ])
}

RefactoringTool: Refactored docutils\writers\docutils_xml.py
--- docutils\writers\docutils_xml.py    (original)
+++ docutils\writers\docutils_xml.py    (refactored)
@@ -25,7 +25,7 @@
     xml.__path__.reverse() # If both are available, prefer stdlib over PyXML

 import xml.sax.saxutils
-from StringIO import StringIO
+from io import StringIO

 import docutils
 from docutils import frontend, writers, nodes

transform: node:
    Node(import_name, [
        Leaf(1, u'import'),
        Leaf(1, u'StringIO')
    ])

transform: results: {
    'module_name': Leaf(1, u'StringIO'),
    'name_import': Node(import_name, [
        Leaf(1, u'import'),
        Leaf(1, u'StringIO')
    ]),
    'node': Node(import_name, [
        Leaf(1, u'import'),
        Leaf(1, u'StringIO')
    ])
}

transform: node:
    Node(power, [
        Leaf(1, u'StringIO'),
        Node(trailer, [
            Leaf(23, u'.'),
            Leaf(1, u'StringIO')
        ]), 
        Node(trailer, [
            Leaf(7, u'('),
            Leaf(8, u')')
        ])
    ])

transform: results: {
    'bare_with_attr': [Leaf(1, u'StringIO')],
    'node': Node(power, [
        Leaf(1, u'StringIO'),
        Node(trailer, [
            Leaf(23, u'.'),
            Leaf(1, u'StringIO')
        ]),
        Node(trailer, [
            Leaf(7, u'('),
            Leaf(8, u')')
        ])
    ])
}

transform: node:
    Node(import_from, [
        Leaf(1, u'from'),
        Leaf(1, u'ConfigParser'),
        Leaf(1, u'import'),
        Leaf(1, u'ConfigParser')
    ])

transform: results: {
    'module_name': Leaf(1, u'ConfigParser'),
    'node': Node(import_from, [
        Leaf(1, u'from'),
        Leaf(1, u'ConfigParser'),
        Leaf(1, u'import'),
        Leaf(1, u'ConfigParser')
    ])
}

RefactoringTool: Refactored docutils\writers\odf_odt\__init__.py
--- docutils\writers\odf_odt\__init__.py        (original)
+++ docutils\writers\odf_odt\__init__.py        (refactored)
@@ -22,7 +22,7 @@
 from xml.dom import minidom
 import time
 import re
-import StringIO
+import io
 import copy
 import urllib2
 import docutils
@@ -306,7 +306,7 @@
     return tag

 def ToString(et):
-    outstream = StringIO.StringIO()
+    outstream = io.StringIO()
     if sys.version_info >= (3, 2):
         et.write(outstream, encoding="unicode")
     else:
@@ -795,7 +795,7 @@
         self.language = languages.get_language(lcode, document.reporter)
         self.format_map = { }
         if self.settings.odf_config_file:
-            from ConfigParser import ConfigParser
+            from configparser import ConfigParser

             parser = ConfigParser()
             parser.read(self.settings.odf_config_file)
#@+node:ekr.20130807203905.16745: *3* Scripts
#@+node:ekr.20130807203905.16746: *4* Script: write constants to log pane
# -*- coding: utf8 -*-

# Define the constants for the define_xxx functions in the new punctuations_chars.py.
import unicodedata
s =  ur"\.\,\;\!\?"
assert not g.isPython3
d = {}
for uc in s:
    assert isinstance(uc,(str,unicode)),type(uc)
    comment = unicodedata.name(uc,'Unknown') if isinstance(uc,unicode) else 'ascii'
    d[ord(uc)] = comment
for i in sorted(d.keys()):
    g.es('%5s, # %s' % (i,d.get(i)))
#@+node:ekr.20130807203905.16747: *4* Script: check syntax of all docutils files
# The following files fail on Python 3 because of Python 2.x syntax for unicode characters:
# (now passes) utils/punctuation_chars.py, 
# utils/math/latex2mathml.py,
# writers/manpage.py,
# writers/latex2e/__init__.py

g.cls()
import os
path = g.os_path_finalize_join(g.app.loadDir,'..','extensions','docutils')
if g.isPython3:
    exclude = ('punctuation2.py',)
else:
    exclude = ('punctuation3.py',)
for root, dirs, files in os.walk(path):
    for fn in files:
        if fn.endswith('.py'):
            fn = g.os_path_join(root,fn)
            if not g.shortFileName(fn) in exclude:
                s,e = g.readFileIntoString(fn)
                c.testManager.checkFileSyntax(fn,s,reraise=False,suppress=False)
print('all files in leo/extensions/docutils pass')
#@+node:ekr.20130807203905.16748: *4* Script: restore newlines
# From Python/tools/scripts/crlf.py
"Replace CRLF with LF in docutils files."

g.cls()
write = True
import os
def fix(filename):
    if os.path.isdir(filename):
        # print filename, "Directory!"
        return
    data = open(filename,"rb").read()
    if '\0' in data:
        print('binary: %s' % filename)
        return
    newdata = data.replace("\r\n","\n")
    if newdata != data:
        print('changed: %s' % g.shortFileName(filename,2))
        if write:
            f = open(filename,"wb")
            f.write(newdata)
            f.close()

path = g.os_path_finalize_join(g.app.loadDir,'..','extensions','docutils')
for root, dirs, files in os.walk(path):
    for fn in files:
        if fn.endswith('.py'):
            fn = g.os_path_join(root,fn)
            fix(fn)
print('done')
#@+node:ekr.20130807203905.16749: *4* Script: create ords arrays
# -*- coding: utf8 -*-
import sys
import unicodedata

@others

openers_original = ur"""\"\'\(\<\[\{à¼ºà¼¼áš›â…â½â‚âŒ©â¨âªâ¬â®â°â²â´âŸ…âŸ¦âŸ¨âŸªâŸ¬âŸ®â¦ƒâ¦…â¦‡â¦‰â¦‹â¦â¦â¦‘â¦“â¦•â¦—â§˜â§šâ§¼â¸¢â¸¤â¸¦â¸¨ã€ˆã€Šã€Œã€ã€ã€”ã€–ã€˜ã€šã€ã€ï´¾ï¸—ï¸µï¸·ï¸¹ï¸»ï¸½ï¸¿ï¹ï¹ƒï¹‡ï¹™ï¹›ï¹ï¼ˆï¼»ï½›ï½Ÿï½¢Â«â€˜â€œâ€¹â¸‚â¸„â¸‰â¸Œâ¸œâ¸ â€šâ€Â»â€™â€â€ºâ¸ƒâ¸…â¸Šâ¸â¸â¸¡â€›â€Ÿ"""
openers_ords = [ord(ch) for ch in openers_original if unicodedata.name(ch,'Unknown') != 'Unknown']
openers = ''.join([unichr(n) for n in openers_ords])
assert openers_original == openers

closers_original = ur"""\"\'\)\>\]\}à¼»à¼½ášœâ†â¾â‚âŒªâ©â«â­â¯â±â³âµâŸ†âŸ§âŸ©âŸ«âŸ­âŸ¯â¦„â¦†â¦ˆâ¦Šâ¦Œâ¦â¦â¦’â¦”â¦–â¦˜â§™â§›â§½â¸£â¸¥â¸§â¸©ã€‰ã€‹ã€ã€ã€‘ã€•ã€—ã€™ã€›ã€ã€Ÿï´¿ï¸˜ï¸¶ï¸¸ï¸ºï¸¼ï¸¾ï¹€ï¹‚ï¹„ï¹ˆï¹šï¹œï¹ï¼‰ï¼½ï½ï½ ï½£Â»â€™â€â€ºâ¸ƒâ¸…â¸Šâ¸â¸â¸¡â€›â€ŸÂ«â€˜â€œâ€¹â¸‚â¸„â¸‰â¸Œâ¸œâ¸ â€šâ€"""
closers_ords = [ord(ch) for ch in closers_original if unicodedata.name(ch,'Unknown') != 'Unknown']
closers = ''.join([unichr(n) for n in closers_ords])
assert closers_original == closers

delimiters_original = u"\\-\\/\\:ÖŠÖ¾á€á †â€â€‘â€’â€“â€”â€•â¸—â¸šã€œã€°ã‚ ï¸±ï¸²ï¹˜ï¹£ï¼Â¡Â·Â¿Í¾Î‡ÕšÕ›ÕœÕÕÕŸÖ‰×€×ƒ×†×³×´Ø‰ØŠØŒØØ›ØØŸÙªÙ«Ù¬Ù­Û”Ü€ÜÜ‚ÜƒÜ„Ü…Ü†Ü‡ÜˆÜ‰ÜŠÜ‹ÜŒÜß·ß¸ß¹à °à ±à ²à ³à ´à µà ¶à ·à ¸à ¹à ºà »à ¼à ½à ¾à¥¤à¥¥à¥°à·´à¹à¹šà¹›à¼„à¼…à¼†à¼‡à¼ˆà¼‰à¼Šà¼‹à¼Œà¼à¼à¼à¼à¼‘à¼’à¾…à¿à¿‘à¿’à¿“à¿”áŠá‹áŒááááƒ»á¡á¢á£á¤á¥á¦á§á¨á™­á™®á›«á›¬á›­áœµáœ¶áŸ”áŸ•áŸ–áŸ˜áŸ™áŸšá €á á ‚á ƒá „á …á ‡á ˆá ‰á Šá¥„á¥…á§á§Ÿá¨á¨Ÿáª áª¡áª¢áª£áª¤áª¥áª¦áª¨áª©áªªáª«áª¬áª­á­šá­›á­œá­á­á­Ÿá­ á°»á°¼á°½á°¾á°¿á±¾á±¿á³“â€–â€—â€ â€¡â€¢â€£â€¤â€¥â€¦â€§â€°â€±â€²â€³â€´â€µâ€¶â€·â€¸â€»â€¼â€½â€¾ââ‚âƒâ‡âˆâ‰âŠâ‹âŒâââââ‘â“â•â–â—â˜â™âšâ›âœâââ³¹â³ºâ³»â³¼â³¾â³¿â¸€â¸â¸†â¸‡â¸ˆâ¸‹â¸â¸â¸â¸‘â¸’â¸“â¸”â¸•â¸–â¸˜â¸™â¸›â¸â¸Ÿâ¸ªâ¸«â¸¬â¸­â¸®â¸°â¸±ã€ã€‚ã€ƒã€½ãƒ»ê“¾ê“¿ê˜ê˜ê˜ê™³ê™¾ê›²ê›³ê›´ê›µê›¶ê›·ê¡´ê¡µê¡¶ê¡·ê£ê£ê£¸ê£¹ê£ºê¤®ê¤¯ê¥Ÿê§ê§‚ê§ƒê§„ê§…ê§†ê§‡ê§ˆê§‰ê§Šê§‹ê§Œê§ê§ê§Ÿê©œê©ê©ê©Ÿê«ê«Ÿê¯«ï¸ï¸‘ï¸’ï¸“ï¸”ï¸•ï¸–ï¸™ï¸°ï¹…ï¹†ï¹‰ï¹Šï¹‹ï¹Œï¹ï¹‘ï¹’ï¹”ï¹•ï¹–ï¹—ï¹Ÿï¹ ï¹¡ï¹¨ï¹ªï¹«ï¼ï¼‚ï¼ƒï¼…ï¼†ï¼‡ï¼Šï¼Œï¼ï¼ï¼šï¼›ï¼Ÿï¼ ï¼¼ï½¡ï½¤ï½¥"
delimiter_ords = [ord(ch) for ch in delimiters_original if unicodedata.name(ch,'Unknown') != 'Unknown']
delimiters = ''.join([unichr(n) for n in delimiter_ords])

quote_pairs_original = {
    u'\xbb':   u'\xbb',         # Swedish
    u'\u2018': u'\u201a',       # Greek
    u'\u2019': u'\u2019',       # Swedish
    u'\u201a': u'\u2018\u2019', # German, Polish
    u'\u201c': u'\u201e',       # German
    u'\u201e': u'\u201c\u201d',
    u'\u201d': u'\u201d',       # Swedish
    u'\u203a': u'\u203a',       # Swedish
}

# Compute the quote pairs array.
d = quote_pairs_original
d2 = {}
for ch in d.keys():
    val = d.get(ch)
    n = ord(ch)
    d2[n] = [ord(z) for z in val]
for n in sorted(d2.keys()):
    g.es('0x%x: [%s],' % (n,','.join(['0x%x' % (z) for z in d2.get(n)])))


# No need to compute 

assert compare(openers_original,openers)
assert compare(closers_original,closers)
assert compare(delimiters_original,delimiters)

if 0: # Create the ords array.
    for n in closers_ords:
        ch = unichr(n)
        g.es('%s, # %s' % (n,unicodedata.name(ch,'Unknown')))
    
print('done')
#@+node:ekr.20130807203905.16750: *5* compare and helper
def unknown(ch):
    return unicodedata.name(ch,'Unknown') == 'Unknown'

def compare(s1,s2):
    i1,i2,n1,n2 = 0,0,len(s1),len(s2)
    while True:
        while i1 < n1 and unknown(s1[i1]):
            i1 += 1
        # while i2 < n2 and unknown(s2[i2]):
            # i2 += 1
        if i1 < n1 and i2 < n2 and s1[i1] == s2[i2]:
            i1 += 1 ; i2 += 1
        else:
            return i1 == n1 and i2 == n2
#@+node:ekr.20130807203905.16751: *4* Script: test quote_pairs
quote_pairs_original = {
    u'\xbb':   u'\xbb', # Swedish
    u'\u2018': u'\u201a', # Greek
    u'\u2019': u'\u2019', # Swedish
    u'\u201a': u'\u2018\u2019', # German, Polish
    u'\u201c': u'\u201e', # German
    u'\u201e': u'\u201c\u201d',
    u'\u201d': u'\u201d', # Swedish
    u'\u203a': u'\u203a', # Swedish
}
          
quote_pairs_ord_d = {
    0xbb:   [0xbb],
    0x2018: [0x201a],
    0x2019: [0x2019],
    0x201a: [0x2018,0x2019],
    0x201c: [0x201e],
    0x201d: [0x201d],
    0x201e: [0x201c,0x201d],
    0x203a: [0x203a],
}

quote_pairs = {}
d = quote_pairs_ord_d
for n in d.keys():
    ch = unichr(n)
    quote_pairs [ch] = ''.join([unichr(n2) for n2 in d.get(n)])
d = quote_pairs
for ch in sorted(d.keys()):
    g.es('0x%x: %s' % (ord(ch),['0x%s' % (ord(z)) for z in d.get(ch)]))
    
assert quote_pairs == quote_pairs_original
g.es('pass!')
#@+node:ekr.20130807203905.16752: *3* Tests
#@+node:ekr.20130807203905.16753: *4* @@test special chars script & helpers
# -*- coding: utf8 -*-

from __future__ import print_function

g.cls()

import re
import sys
import unicodedata

openers = ur"""\"\'\(\<\[\{à¼ºà¼¼áš›â…â½â‚âŒ©â¨âªâ¬â®â°â²â´âŸ…âŸ¦âŸ¨âŸªâŸ¬âŸ®â¦ƒâ¦…â¦‡â¦‰â¦‹â¦â¦â¦‘â¦“â¦•â¦—â§˜â§šâ§¼â¸¢â¸¤â¸¦â¸¨ã€ˆã€Šã€Œã€ã€ã€”ã€–ã€˜ã€šã€ã€ï´¾ï¸—ï¸µï¸·ï¸¹ï¸»ï¸½ï¸¿ï¹ï¹ƒï¹‡ï¹™ï¹›ï¹ï¼ˆï¼»ï½›ï½Ÿï½¢Â«â€˜â€œâ€¹â¸‚â¸„â¸‰â¸Œâ¸œâ¸ â€šâ€Â»â€™â€â€ºâ¸ƒâ¸…â¸Šâ¸â¸â¸¡â€›â€Ÿ"""
closers = ur"""\"\'\)\>\]\}à¼»à¼½ášœâ†â¾â‚âŒªâ©â«â­â¯â±â³âµâŸ†âŸ§âŸ©âŸ«âŸ­âŸ¯â¦„â¦†â¦ˆâ¦Šâ¦Œâ¦â¦â¦’â¦”â¦–â¦˜â§™â§›â§½â¸£â¸¥â¸§â¸©ã€‰ã€‹ã€ã€ã€‘ã€•ã€—ã€™ã€›ã€ã€Ÿï´¿ï¸˜ï¸¶ï¸¸ï¸ºï¸¼ï¸¾ï¹€ï¹‚ï¹„ï¹ˆï¹šï¹œï¹ï¼‰ï¼½ï½ï½ ï½£Â»â€™â€â€ºâ¸ƒâ¸…â¸Šâ¸â¸â¸¡â€›â€ŸÂ«â€˜â€œâ€¹â¸‚â¸„â¸‰â¸Œâ¸œâ¸ â€šâ€"""
delimiters = ur"\-\/\:ÖŠÖ¾á€á †â€â€‘â€’â€“â€”â€•â¸—â¸šã€œã€°ã‚ ï¸±ï¸²ï¹˜ï¹£ï¼Â¡Â·Â¿Í¾Î‡ÕšÕ›ÕœÕÕÕŸÖ‰×€×ƒ×†×³×´Ø‰ØŠØŒØØ›ØØŸÙªÙ«Ù¬Ù­Û”Ü€ÜÜ‚ÜƒÜ„Ü…Ü†Ü‡ÜˆÜ‰ÜŠÜ‹ÜŒÜß·ß¸ß¹à °à ±à ²à ³à ´à µà ¶à ·à ¸à ¹à ºà »à ¼à ½à ¾à¥¤à¥¥à¥°à·´à¹à¹šà¹›à¼„à¼…à¼†à¼‡à¼ˆà¼‰à¼Šà¼‹à¼Œà¼à¼à¼à¼à¼‘à¼’à¾…à¿à¿‘à¿’à¿“à¿”áŠá‹áŒááááƒ»á¡á¢á£á¤á¥á¦á§á¨á™­á™®á›«á›¬á›­áœµáœ¶áŸ”áŸ•áŸ–áŸ˜áŸ™áŸšá €á á ‚á ƒá „á …á ‡á ˆá ‰á Šá¥„á¥…á§á§Ÿá¨á¨Ÿáª áª¡áª¢áª£áª¤áª¥áª¦áª¨áª©áªªáª«áª¬áª­á­šá­›á­œá­á­á­Ÿá­ á°»á°¼á°½á°¾á°¿á±¾á±¿á³“â€–â€—â€ â€¡â€¢â€£â€¤â€¥â€¦â€§â€°â€±â€²â€³â€´â€µâ€¶â€·â€¸â€»â€¼â€½â€¾ââ‚âƒâ‡âˆâ‰âŠâ‹âŒâââââ‘â“â•â–â—â˜â™âšâ›âœâââ³¹â³ºâ³»â³¼â³¾â³¿â¸€â¸â¸†â¸‡â¸ˆâ¸‹â¸â¸â¸â¸‘â¸’â¸“â¸”â¸•â¸–â¸˜â¸™â¸›â¸â¸Ÿâ¸ªâ¸«â¸¬â¸­â¸®â¸°â¸±ã€ã€‚ã€ƒã€½ãƒ»ê“¾ê“¿ê˜ê˜ê˜ê™³ê™¾ê›²ê›³ê›´ê›µê›¶ê›·ê¡´ê¡µê¡¶ê¡·ê£ê£ê£¸ê£¹ê£ºê¤®ê¤¯ê¥Ÿê§ê§‚ê§ƒê§„ê§…ê§†ê§‡ê§ˆê§‰ê§Šê§‹ê§Œê§ê§ê§Ÿê©œê©ê©ê©Ÿê«ê«Ÿê¯«ï¸ï¸‘ï¸’ï¸“ï¸”ï¸•ï¸–ï¸™ï¸°ï¹…ï¹†ï¹‰ï¹Šï¹‹ï¹Œï¹ï¹‘ï¹’ï¹”ï¹•ï¹–ï¹—ï¹Ÿï¹ ï¹¡ï¹¨ï¹ªï¹«ï¼ï¼‚ï¼ƒï¼…ï¼†ï¼‡ï¼Šï¼Œï¼ï¼ï¼šï¼›ï¼Ÿï¼ ï¼¼ï½¡ï½¤ï½¥ğ„€ğ„ğŸğğ¡—ğ¤Ÿğ¤¿ğ©ğ©‘ğ©’ğ©“ğ©”ğ©•ğ©–ğ©—ğ©˜ğ©¿ğ¬¹ğ¬ºğ¬»ğ¬¼ğ¬½ğ¬¾ğ¬¿ğ‘‚»ğ‘‚¼ğ‘‚¾ğ‘‚¿ğ‘ƒ€ğ‘ƒğ’‘°ğ’‘±ğ’‘²ğ’‘³"
closing_delimiters = ur"\.\,\;\!\?"

unicode_punctuation_categories = {
    # 'Pc': 'Connector', # not used in Docutils inline markup recognition
    'Pd': 'Dash',
    'Ps': 'Open',
    'Pe': 'Close',
    'Pi': 'Initial quote', # may behave like Ps or Pe depending on usage
    'Pf': 'Final quote', # may behave like Ps or Pe depending on usage
    'Po': 'Other'
    }
"""Unicode character categories for punctuation"""

@others

test()
#@+node:ekr.20130807203905.16754: *5* punctuation_samples
def punctuation_samples():

    """Docutils punctuation category sample strings.

    Return list of sample strings for the categories "Open", "Close",
    "Delimiters" and "Closing-Delimiters" used in the `inline markup
    recognition rules`_.
    """

    # Lists with characters in Unicode punctuation character categories
    cp_min = 160 # ASCII chars have special rules for backwards compatibility
    ucharlists = unicode_charlists(unicode_punctuation_categories, cp_min)

    # match opening/closing characters
    # --------------------------------
    # Rearange the lists to ensure matching characters at the same
    # index position.

    # low quotation marks are also used as closers (e.g. in Greek)
    # move them to category Pi:
    ucharlists['Ps'].remove(u'â€š') # 201A  SINGLE LOW-9 QUOTATION MARK
    ucharlists['Ps'].remove(u'â€') # 201E  DOUBLE LOW-9 QUOTATION MARK
    ucharlists['Pi'] += [u'â€š', u'â€']

    ucharlists['Pi'].remove(u'â€›') # 201B  SINGLE HIGH-REVERSED-9 QUOTATION MARK
    ucharlists['Pi'].remove(u'â€Ÿ') # 201F  DOUBLE HIGH-REVERSED-9 QUOTATION MARK
    ucharlists['Pf'] += [u'â€›', u'â€Ÿ']

    # 301F  LOW DOUBLE PRIME QUOTATION MARK misses the opening pendant:
    ucharlists['Ps'].insert(ucharlists['Pe'].index(u'\u301f'), u'\u301d')

    # print u''.join(ucharlists['Ps']).encode('utf8')
    # print u''.join(ucharlists['Pe']).encode('utf8')
    # print u''.join(ucharlists['Pi']).encode('utf8')
    # print u''.join(ucharlists['Pf']).encode('utf8')

    # The Docutils character categories
    # ---------------------------------
    #
    # The categorization of ASCII chars is non-standard to reduce both
    # false positives and need for escaping. (see `inline markup recognition
    # rules`_)

    # matching, allowed before markup
    openers = [re.escape('"\'(<[{')]
    for cat in ('Ps', 'Pi', 'Pf'):
        openers.extend(ucharlists[cat])

    # matching, allowed after markup
    closers = [re.escape('"\')>]}')]
    for cat in ('Pe', 'Pf', 'Pi'):
        closers.extend(ucharlists[cat])

    # non-matching, allowed on both sides
    delimiters = [re.escape('-/:')]
    for cat in ('Pd', 'Po'):
        delimiters.extend(ucharlists[cat])

    # non-matching, after markup
    closing_delimiters = [re.escape('.,;!?')]

    # # Test open/close matching:
    # for i in range(min(len(openers),len(closers))):
    #     print '%4d    %s    %s' % (i, openers[i].encode('utf8'),
    #                                closers[i].encode('utf8'))
    # dump(delimiters)
    
    return [u''.join(chars)
            for chars in (openers, closers, delimiters, closing_delimiters)]
#@+node:ekr.20130807203905.16755: *5* unicode_charlists
def unicode_charlists(categories, cp_min=0, cp_max=None):
    """Return dictionary of Unicode character lists.

    For each of the `catagories`, an item contains a list with all Unicode
    characters with `cp_min` <= code-point <= `cp_max` that belong to the
    category. (The default values check every code-point supported by Python.)
    """
    # Determine highest code point with one of the given categories
    # (may shorten the search time considerably if there are many
    # categories with not too high characters):
    if cp_max is None:
        cp_max = max(x for x in xrange(sys.maxunicode + 1)
                     if unicodedata.category(unichr(x)) in categories)
        # print cp_max # => 74867 for unicode_punctuation_categories
    charlists = {}
    for cat in categories:
        charlists[cat] = [unichr(x) for x in xrange(cp_min, cp_max+1)
                          if unicodedata.category(unichr(x)) == cat]
    return charlists
#@+node:ekr.20130807203905.16756: *5* compare
def compare(s1,s2):
    
    print(len(s1),len(s2))
    d1,d2 = {},{}
    for uc in s1:
        assert isinstance(uc,(str,unicode)),type(uc)
        n = ord(uc)
        d1[n] = uc
    for uc in s2:
        assert isinstance(uc,(str,unicode)),type(uc)
        n = ord(uc)
        d2[n] = uc
    nset = set()
    for n in d1.keys():
        nset.add(n)
    for n in d2.keys():
        nset.add(n)
    matches = 0
    for n in sorted(nset):
        uc1 = d1.get(n)
        uc2 = d2.get(n)
        if uc1 is None and uc2 is None:
            print('%5s hu??' % (n))
        elif uc1 is None:
            print('%5s' % (n),'missing1',uc2,unicodedata.name(uc2,'Unknown'))
        elif uc2 is None:
            pass # print('%5s' % (n),'missing2',uc1,unicodedata.name(uc1,'Unknown'))
        elif uc1 == uc2:
            # print('%5s' % (n),'match',uc1,unicodedata.name(uc1,'Unknown'))
            # print('%s, # %s' % (n,unicodedata.name(uc1,'Unknown').lower()))
            matches += 1
        else:
            print('%5s' % (n),uc1,unicodedata.name(uc1,'Unknown'),uc2,unicodedata.name(uc2,'Unknown'))
    print('matches: %s' % matches)
#@+node:ekr.20130807203905.16757: *5* dump
def dump(s):
    for uc in s:
        assert isinstance(uc,(str,unicode)),type(uc)
        if isinstance(uc,unicode):
            print('%5s' % (ord(uc)),uc,unicodedata.name(uc,'Unknown'))
#@+node:ekr.20130807203905.16758: *5* test
# The if __name__ == '__main__' part of puntuation_chars.py

def test():
    
    # (re) create and compare the samples:
    (o, c, d, cd) = punctuation_samples()
    if o != openers:
        print('- openers = ur"""%s"""' % openers.encode('utf8'))
        print('+ openers = ur"""%s"""' % o.encode('utf8'))
    if c != closers:
        print('- closers = ur"""%s"""' % closers.encode('utf8'))
        print('+ closers = ur"""%s"""' % c.encode('utf8'))
    if d != delimiters:
        print('- delimiters = ur"%s"' % delimiters.encode('utf8'))
        # dump(delimiters)
        print('+ delimiters = ur"%s"' % d.encode('utf8'))
        # dump(d)
        compare(delimiters,d)
    if cd != closing_delimiters:
        print('- closing_delimiters = ur"%s"' % closing_delimiters.encode('utf8'))
        print('+ closing_delimiters = ur"%s"' % cd.encode('utf8'))
#@+node:ekr.20130807203905.16759: *4* consistency check (was in punctuation chars
import sys, re
import unicodedata

# Unicode punctuation character categories
# ----------------------------------------

unicode_punctuation_categories = {
    # 'Pc': 'Connector', # not used in Docutils inline markup recognition
    'Pd': 'Dash',
    'Ps': 'Open',
    'Pe': 'Close',
    'Pi': 'Initial quote', # may behave like Ps or Pe depending on usage
    'Pf': 'Final quote', # may behave like Ps or Pe depending on usage
    'Po': 'Other'
    }
"""Unicode character categories for punctuation"""


# generate character pattern strings
# ==================================

def unicode_charlists(categories, cp_min=0, cp_max=None):
    """Return dictionary of Unicode character lists.

    For each of the `catagories`, an item contains a list with all Unicode
    characters with `cp_min` <= code-point <= `cp_max` that belong to the
    category. (The default values check every code-point supported by Python.)
    """
    # Determine highest code point with one of the given categories
    # (may shorten the search time considerably if there are many
    # categories with not too high characters):
    if cp_max is None:
        cp_max = max(x for x in xrange(sys.maxunicode + 1)
                     if unicodedata.category(unichr(x)) in categories)
        # print cp_max # => 74867 for unicode_punctuation_categories
    charlists = {}
    for cat in categories:
        charlists[cat] = [unichr(x) for x in xrange(cp_min, cp_max+1)
                          if unicodedata.category(unichr(x)) == cat]
    return charlists


# Character categories in Docutils
# --------------------------------

def punctuation_samples():

    """Docutils punctuation category sample strings.

    Return list of sample strings for the categories "Open", "Close",
    "Delimiters" and "Closing-Delimiters" used in the `inline markup
    recognition rules`_.
    """

    # Lists with characters in Unicode punctuation character categories
    cp_min = 160 # ASCII chars have special rules for backwards compatibility
    ucharlists = unicode_charlists(unicode_punctuation_categories, cp_min)

    # match opening/closing characters
    # --------------------------------
    # Rearange the lists to ensure matching characters at the same
    # index position.

    # low quotation marks are also used as closers (e.g. in Greek)
    # move them to category Pi:
    ucharlists['Ps'].remove(u'â€š') # 201A  SINGLE LOW-9 QUOTATION MARK
    ucharlists['Ps'].remove(u'â€') # 201E  DOUBLE LOW-9 QUOTATION MARK
    ucharlists['Pi'] += [u'â€š', u'â€']

    ucharlists['Pi'].remove(u'â€›') # 201B  SINGLE HIGH-REVERSED-9 QUOTATION MARK
    ucharlists['Pi'].remove(u'â€Ÿ') # 201F  DOUBLE HIGH-REVERSED-9 QUOTATION MARK
    ucharlists['Pf'] += [u'â€›', u'â€Ÿ']

    # 301F  LOW DOUBLE PRIME QUOTATION MARK misses the opening pendant:
    ucharlists['Ps'].insert(ucharlists['Pe'].index(u'\u301f'), u'\u301d')

    # print u''.join(ucharlists['Ps']).encode('utf8')
    # print u''.join(ucharlists['Pe']).encode('utf8')
    # print u''.join(ucharlists['Pi']).encode('utf8')
    # print u''.join(ucharlists['Pf']).encode('utf8')

    # The Docutils character categories
    # ---------------------------------
    #
    # The categorization of ASCII chars is non-standard to reduce both
    # false positives and need for escaping. (see `inline markup recognition
    # rules`_)

    # matching, allowed before markup
    openers = [re.escape('"\'(<[{')]
    for cat in ('Ps', 'Pi', 'Pf'):
        openers.extend(ucharlists[cat])

    # matching, allowed after markup
    closers = [re.escape('"\')>]}')]
    for cat in ('Pe', 'Pf', 'Pi'):
        closers.extend(ucharlists[cat])

    # non-matching, allowed on both sides
    delimiters = [re.escape('-/:')]
    for cat in ('Pd', 'Po'):
        delimiters.extend(ucharlists[cat])

    # non-matching, after markup
    closing_delimiters = [re.escape('.,;!?')]

    # # Test open/close matching:
    # for i in range(min(len(openers),len(closers))):
    #     print '%4d    %s    %s' % (i, openers[i].encode('utf8'),
    #                                closers[i].encode('utf8'))

    return [u''.join(chars)
            for chars in (openers, closers, delimiters, closing_delimiters)]


# Matching open/close quotes
# --------------------------

# Rule (5) requires determination of matching open/close pairs. However,
# the pairing of open/close quotes is ambigue due to  different typographic
# conventions in different languages.

quote_pairs = {u'\xbb': u'\xbb', # Swedish
               u'\u2018': u'\u201a', # Greek
               u'\u2019': u'\u2019', # Swedish
               u'\u201a': u'\u2018\u2019', # German, Polish
               u'\u201c': u'\u201e', # German
               u'\u201e': u'\u201c\u201d',
               u'\u201d': u'\u201d', # Swedish
               u'\u203a': u'\u203a', # Swedish
              }

def match_chars(c1, c2):
    try:
        i = openers.index(c1)
    except ValueError:  # c1 not in openers
        return False
    return c2 == closers[i] or c2 in quote_pairs.get(c1, '')




# print results
# =============

if __name__ == '__main__':

    # (re) create and compare the samples:
    (o, c, d, cd) = punctuation_samples()
    if o != openers:
        print '- openers = ur"""%s"""' % openers.encode('utf8')
        print '+ openers = ur"""%s"""' % o.encode('utf8')
    if c != closers:
        print '- closers = ur"""%s"""' % closers.encode('utf8')
        print '+ closers = ur"""%s"""' % c.encode('utf8')
    if d != delimiters:
        print '- delimiters = ur"%s"' % delimiters.encode('utf8')
        print '+ delimiters = ur"%s"' % d.encode('utf8')
    if cd != closing_delimiters:
        print '- closing_delimiters = ur"%s"' % closing_delimiters.encode('utf8')
        print '+ closing_delimiters = ur"%s"' % cd.encode('utf8')

    # # test prints
    # print 'openers = ', repr(openers)
    # print 'closers = ', repr(closers)
    # print 'delimiters = ', repr(delimiters)
    # print 'closing_delimiters = ', repr(closing_delimiters)

    # ucharlists = unicode_charlists(unicode_punctuation_categories)
    # for cat, chars in ucharlists.items():
    #     # print cat, chars
    #     # compact output (visible with a comprehensive font):
    #     print (u":%s: %s" % (cat, u''.join(chars))).encode('utf8')
#@+node:ekr.20130807203905.16760: *4* docutils test imports
docutils = g.importExtension('docutils',pluginName='leoRst.py',verbose=True)
print(docutils)
from docutils import parsers
print(parsers)
from docutils.parsers import rst
print(rst)
import docutils.parsers.rst
print(docutils.parsers.rst)
from docutils.parsers.rst import directives
#@+node:ekr.20130807203905.16761: *4* six.u tests
# -*- coding: utf8 -*-
g.cls()
import leo.extensions.six as six
# import imp
# imp.reload(six)
# u = six.u
<< tex2unichar dicts >>
result = []
i = 0
for d in (
    mathaccent,
    mathalpha,
    mathbin,
    mathclose,
    mathfence,
    mathop,
    mathopen,
    mathord,
    mathover,
    mathradical,
    mathrel,
    mathunder,
    space,
):
    for key in d:
        ch = d.get(key)
        result.append(ch)
        six.u(ch)
    i += 1
g.es('\n'.join(result))
print('done')
#@+node:ekr.20130807203905.16762: *5* << tex2unichar dicts >>
# -*- coding: utf8 -*-

# LaTeX math to Unicode symbols translation dictionaries.
# Generated with ``write_tex2unichar.py`` from the data in
# http://milde.users.sourceforge.net/LUCR/Math/

# Includes commands from: wasysym, stmaryrd, mathdots, mathabx, esint, bbold, amsxtra, amsmath, amssymb, standard LaTeX

mathaccent = {
    'acute': u('\u0301'), # xÃŒÂ COMBINING ACUTE ACCENT
    'bar': u('\u0304'), # xÃŒâ€ COMBINING MACRON
    'breve': u('\u0306'), # xÃŒâ€  COMBINING BREVE
    'check': u('\u030c'), # xÃŒÅ’ COMBINING CARON
    'ddddot': u('\u20dc'), # xÃ¢Æ’Å“ COMBINING FOUR DOTS ABOVE
    'dddot': u('\u20db'), # xÃ¢Æ’â€º COMBINING THREE DOTS ABOVE
    'ddot': u('\u0308'), # xÃŒË† COMBINING DIAERESIS
    'dot': u('\u0307'), # xÃŒâ€¡ COMBINING DOT ABOVE
    'grave': u('\u0300'), # xÃŒâ‚¬ COMBINING GRAVE ACCENT
    'hat': u('\u0302'), # xÃŒâ€š COMBINING CIRCUMFLEX ACCENT
    'mathring': u('\u030a'), # xÃŒÅ  COMBINING RING ABOVE
    'not': u('\u0338'), # xÃŒÂ¸ COMBINING LONG SOLIDUS OVERLAY
    'overleftarrow': u('\u20d6'), # xÃ¢Æ’â€“ COMBINING LEFT ARROW ABOVE
    'overleftrightarrow': u('\u20e1'), # xÃ¢Æ’Â¡ COMBINING LEFT RIGHT ARROW ABOVE
    'overline': u('\u0305'), # xÃŒâ€¦ COMBINING OVERLINE
    'overrightarrow': u('\u20d7'), # xÃ¢Æ’â€” COMBINING RIGHT ARROW ABOVE
    'tilde': u('\u0303'), # xÃŒÆ’ COMBINING TILDE
    'underbar': u('\u0331'), # xÃŒÂ± COMBINING MACRON BELOW
    'underleftarrow': u('\u20ee'), # xÃ¢Æ’Â® COMBINING LEFT ARROW BELOW
    'underline': u('\u0332'), # xÃŒÂ² COMBINING LOW LINE
    'underrightarrow': u('\u20ef'), # xÃ¢Æ’Â¯ COMBINING RIGHT ARROW BELOW
    'vec': u('\u20d7'), # xÃ¢Æ’â€” COMBINING RIGHT ARROW ABOVE
    'widehat': u('\u0302'), # xÃŒâ€š COMBINING CIRCUMFLEX ACCENT
    'widetilde': u('\u0303'), # xÃŒÆ’ COMBINING TILDE
    }
mathalpha = {
    'Bbbk': u('\U0001d55c'), # Ã°Ââ€¢Å“ MATHEMATICAL DOUBLE-STRUCK SMALL K
    'Delta': u('\u0394'), # Ãâ€ GREEK CAPITAL LETTER DELTA
    'Gamma': u('\u0393'), # Ãâ€œ GREEK CAPITAL LETTER GAMMA
    'Im': u('\u2111'), # Ã¢â€â€˜ BLACK-LETTER CAPITAL I
    'Lambda': u('\u039b'), # Ãâ€º GREEK CAPITAL LETTER LAMDA
    'Omega': u('\u03a9'), # ÃÂ© GREEK CAPITAL LETTER OMEGA
    'Phi': u('\u03a6'), # ÃÂ¦ GREEK CAPITAL LETTER PHI
    'Pi': u('\u03a0'), # Ã  GREEK CAPITAL LETTER PI
    'Psi': u('\u03a8'), # ÃÂ¨ GREEK CAPITAL LETTER PSI
    'Re': u('\u211c'), # Ã¢â€Å“ BLACK-LETTER CAPITAL R
    'Sigma': u('\u03a3'), # ÃÂ£ GREEK CAPITAL LETTER SIGMA
    'Theta': u('\u0398'), # ÃËœ GREEK CAPITAL LETTER THETA
    'Upsilon': u('\u03a5'), # ÃÂ¥ GREEK CAPITAL LETTER UPSILON
    'Xi': u('\u039e'), # ÃÅ¾ GREEK CAPITAL LETTER XI
    'aleph': u('\u2135'), # Ã¢â€Âµ ALEF SYMBOL
    'alpha': u('\u03b1'), # ÃÂ± GREEK SMALL LETTER ALPHA
    'beta': u('\u03b2'), # ÃÂ² GREEK SMALL LETTER BETA
    'beth': u('\u2136'), # Ã¢â€Â¶ BET SYMBOL
    'chi': u('\u03c7'), # Ãâ€¡ GREEK SMALL LETTER CHI
    'daleth': u('\u2138'), # Ã¢â€Â¸ DALET SYMBOL
    'delta': u('\u03b4'), # ÃÂ´ GREEK SMALL LETTER DELTA
    'digamma': u('\u03dc'), # ÃÅ“ GREEK LETTER DIGAMMA
    'ell': u('\u2113'), # Ã¢â€â€œ SCRIPT SMALL L
    'epsilon': u('\u03f5'), # ÃÂµ GREEK LUNATE EPSILON SYMBOL
    'eta': u('\u03b7'), # ÃÂ· GREEK SMALL LETTER ETA
    'eth': u('\xf0'), # ÃƒÂ° LATIN SMALL LETTER ETH
    'gamma': u('\u03b3'), # ÃÂ³ GREEK SMALL LETTER GAMMA
    'gimel': u('\u2137'), # Ã¢â€Â· GIMEL SYMBOL
    'hbar': u('\u210f'), # Ã¢â€Â PLANCK CONSTANT OVER TWO PI
    'hslash': u('\u210f'), # Ã¢â€Â PLANCK CONSTANT OVER TWO PI
    'imath': u('\u0131'), # Ã„Â± LATIN SMALL LETTER DOTLESS I
    'iota': u('\u03b9'), # ÃÂ¹ GREEK SMALL LETTER IOTA
    'jmath': u('\u0237'), # ÃˆÂ· LATIN SMALL LETTER DOTLESS J
    'kappa': u('\u03ba'), # ÃÂº GREEK SMALL LETTER KAPPA
    'lambda': u('\u03bb'), # ÃÂ» GREEK SMALL LETTER LAMDA
    'mu': u('\u03bc'), # ÃÂ¼ GREEK SMALL LETTER MU
    'nu': u('\u03bd'), # ÃÂ½ GREEK SMALL LETTER NU
    'omega': u('\u03c9'), # Ãâ€° GREEK SMALL LETTER OMEGA
    'phi': u('\u03d5'), # Ãâ€¢ GREEK PHI SYMBOL
    'pi': u('\u03c0'), # Ãâ‚¬ GREEK SMALL LETTER PI
    'psi': u('\u03c8'), # ÃË† GREEK SMALL LETTER PSI
    'rho': u('\u03c1'), # ÃÂ GREEK SMALL LETTER RHO
    'sigma': u('\u03c3'), # ÃÆ’ GREEK SMALL LETTER SIGMA
    'tau': u('\u03c4'), # Ãâ€ GREEK SMALL LETTER TAU
    'theta': u('\u03b8'), # ÃÂ¸ GREEK SMALL LETTER THETA
    'upsilon': u('\u03c5'), # Ãâ€¦ GREEK SMALL LETTER UPSILON
    'varDelta': u('\U0001d6e5'), # Ã°Ââ€ºÂ¥ MATHEMATICAL ITALIC CAPITAL DELTA
    'varGamma': u('\U0001d6e4'), # Ã°Ââ€ºÂ¤ MATHEMATICAL ITALIC CAPITAL GAMMA
    'varLambda': u('\U0001d6ec'), # Ã°Ââ€ºÂ¬ MATHEMATICAL ITALIC CAPITAL LAMDA
    'varOmega': u('\U0001d6fa'), # Ã°Ââ€ºÂº MATHEMATICAL ITALIC CAPITAL OMEGA
    'varPhi': u('\U0001d6f7'), # Ã°Ââ€ºÂ· MATHEMATICAL ITALIC CAPITAL PHI
    'varPi': u('\U0001d6f1'), # Ã°Ââ€ºÂ± MATHEMATICAL ITALIC CAPITAL PI
    'varPsi': u('\U0001d6f9'), # Ã°Ââ€ºÂ¹ MATHEMATICAL ITALIC CAPITAL PSI
    'varSigma': u('\U0001d6f4'), # Ã°Ââ€ºÂ´ MATHEMATICAL ITALIC CAPITAL SIGMA
    'varTheta': u('\U0001d6e9'), # Ã°Ââ€ºÂ© MATHEMATICAL ITALIC CAPITAL THETA
    'varUpsilon': u('\U0001d6f6'), # Ã°Ââ€ºÂ¶ MATHEMATICAL ITALIC CAPITAL UPSILON
    'varXi': u('\U0001d6ef'), # Ã°Ââ€ºÂ¯ MATHEMATICAL ITALIC CAPITAL XI
    'varepsilon': u('\u03b5'), # ÃÂµ GREEK SMALL LETTER EPSILON
    'varkappa': u('\U0001d718'), # Ã°ÂÅ“Ëœ MATHEMATICAL ITALIC KAPPA SYMBOL
    'varphi': u('\u03c6'), # Ãâ€  GREEK SMALL LETTER PHI
    'varpi': u('\u03d6'), # Ãâ€“ GREEK PI SYMBOL
    'varrho': u('\u03f1'), # ÃÂ± GREEK RHO SYMBOL
    'varsigma': u('\u03c2'), # Ãâ€š GREEK SMALL LETTER FINAL SIGMA
    'vartheta': u('\u03d1'), # Ãâ€˜ GREEK THETA SYMBOL
    'wp': u('\u2118'), # Ã¢â€Ëœ SCRIPT CAPITAL P
    'xi': u('\u03be'), # ÃÂ¾ GREEK SMALL LETTER XI
    'zeta': u('\u03b6'), # ÃÂ¶ GREEK SMALL LETTER ZETA
    }
mathbin = {
    'Cap': u('\u22d2'), # Ã¢â€¹â€™ DOUBLE INTERSECTION
    'Circle': u('\u25cb'), # Ã¢â€”â€¹ WHITE CIRCLE
    'Cup': u('\u22d3'), # Ã¢â€¹â€œ DOUBLE UNION
    'LHD': u('\u25c0'), # Ã¢â€”â‚¬ BLACK LEFT-POINTING TRIANGLE
    'RHD': u('\u25b6'), # Ã¢â€“Â¶ BLACK RIGHT-POINTING TRIANGLE
    'amalg': u('\u2a3f'), # Ã¢Â¨Â¿ AMALGAMATION OR COPRODUCT
    'ast': u('\u2217'), # Ã¢Ë†â€” ASTERISK OPERATOR
    'barwedge': u('\u22bc'), # Ã¢Å Â¼ NAND
    'bigtriangledown': u('\u25bd'), # Ã¢â€“Â½ WHITE DOWN-POINTING TRIANGLE
    'bigtriangleup': u('\u25b3'), # Ã¢â€“Â³ WHITE UP-POINTING TRIANGLE
    'bindnasrepma': u('\u214b'), # Ã¢â€¦â€¹ TURNED AMPERSAND
    'blacklozenge': u('\u29eb'), # Ã¢Â§Â« BLACK LOZENGE
    'blacktriangledown': u('\u25be'), # Ã¢â€“Â¾ BLACK DOWN-POINTING SMALL TRIANGLE
    'blacktriangleleft': u('\u25c2'), # Ã¢â€”â€š BLACK LEFT-POINTING SMALL TRIANGLE
    'blacktriangleright': u('\u25b8'), # Ã¢â€“Â¸ BLACK RIGHT-POINTING SMALL TRIANGLE
    'blacktriangleup': u('\u25b4'), # Ã¢â€“Â´ BLACK UP-POINTING SMALL TRIANGLE
    'boxast': u('\u29c6'), # Ã¢Â§â€  SQUARED ASTERISK
    'boxbar': u('\u25eb'), # Ã¢â€”Â« WHITE SQUARE WITH VERTICAL BISECTING LINE
    'boxbox': u('\u29c8'), # Ã¢Â§Ë† SQUARED SQUARE
    'boxbslash': u('\u29c5'), # Ã¢Â§â€¦ SQUARED FALLING DIAGONAL SLASH
    'boxcircle': u('\u29c7'), # Ã¢Â§â€¡ SQUARED SMALL CIRCLE
    'boxdot': u('\u22a1'), # Ã¢Å Â¡ SQUARED DOT OPERATOR
    'boxminus': u('\u229f'), # Ã¢Å Å¸ SQUARED MINUS
    'boxplus': u('\u229e'), # Ã¢Å Å¾ SQUARED PLUS
    'boxslash': u('\u29c4'), # Ã¢Â§â€ SQUARED RISING DIAGONAL SLASH
    'boxtimes': u('\u22a0'), # Ã¢Å   SQUARED TIMES
    'bullet': u('\u2219'), # Ã¢Ë†â„¢ BULLET OPERATOR
    'cap': u('\u2229'), # Ã¢Ë†Â© INTERSECTION
    'cdot': u('\u22c5'), # Ã¢â€¹â€¦ DOT OPERATOR
    'circ': u('\u2218'), # Ã¢Ë†Ëœ RING OPERATOR
    'circledast': u('\u229b'), # Ã¢Å â€º CIRCLED ASTERISK OPERATOR
    'circledcirc': u('\u229a'), # Ã¢Å Å¡ CIRCLED RING OPERATOR
    'circleddash': u('\u229d'), # Ã¢Å Â CIRCLED DASH
    'cup': u('\u222a'), # Ã¢Ë†Âª UNION
    'curlyvee': u('\u22ce'), # Ã¢â€¹Å½ CURLY LOGICAL OR
    'curlywedge': u('\u22cf'), # Ã¢â€¹Â CURLY LOGICAL AND
    'dagger': u('\u2020'), # Ã¢â‚¬  DAGGER
    'ddagger': u('\u2021'), # Ã¢â‚¬Â¡ DOUBLE DAGGER
    'diamond': u('\u22c4'), # Ã¢â€¹â€ DIAMOND OPERATOR
    'div': u('\xf7'), # ÃƒÂ· DIVISION SIGN
    'divideontimes': u('\u22c7'), # Ã¢â€¹â€¡ DIVISION TIMES
    'dotplus': u('\u2214'), # Ã¢Ë†â€ DOT PLUS
    'doublebarwedge': u('\u2a5e'), # Ã¢Â©Å¾ LOGICAL AND WITH DOUBLE OVERBAR
    'intercal': u('\u22ba'), # Ã¢Å Âº INTERCALATE
    'interleave': u('\u2af4'), # Ã¢Â«Â´ TRIPLE VERTICAL BAR BINARY RELATION
    'land': u('\u2227'), # Ã¢Ë†Â§ LOGICAL AND
    'leftthreetimes': u('\u22cb'), # Ã¢â€¹â€¹ LEFT SEMIDIRECT PRODUCT
    'lhd': u('\u25c1'), # Ã¢â€”Â WHITE LEFT-POINTING TRIANGLE
    'lor': u('\u2228'), # Ã¢Ë†Â¨ LOGICAL OR
    'ltimes': u('\u22c9'), # Ã¢â€¹â€° LEFT NORMAL FACTOR SEMIDIRECT PRODUCT
    'mp': u('\u2213'), # Ã¢Ë†â€œ MINUS-OR-PLUS SIGN
    'odot': u('\u2299'), # Ã¢Å â„¢ CIRCLED DOT OPERATOR
    'ominus': u('\u2296'), # Ã¢Å â€“ CIRCLED MINUS
    'oplus': u('\u2295'), # Ã¢Å â€¢ CIRCLED PLUS
    'oslash': u('\u2298'), # Ã¢Å Ëœ CIRCLED DIVISION SLASH
    'otimes': u('\u2297'), # Ã¢Å â€” CIRCLED TIMES
    'pm': u('\xb1'), # Ã‚Â± PLUS-MINUS SIGN
    'rhd': u('\u25b7'), # Ã¢â€“Â· WHITE RIGHT-POINTING TRIANGLE
    'rightthreetimes': u('\u22cc'), # Ã¢â€¹Å’ RIGHT SEMIDIRECT PRODUCT
    'rtimes': u('\u22ca'), # Ã¢â€¹Å  RIGHT NORMAL FACTOR SEMIDIRECT PRODUCT
    'setminus': u('\u29f5'), # Ã¢Â§Âµ REVERSE SOLIDUS OPERATOR
    'slash': u('\u2215'), # Ã¢Ë†â€¢ DIVISION SLASH
    'smallsetminus': u('\u2216'), # Ã¢Ë†â€“ SET MINUS
    'smalltriangledown': u('\u25bf'), # Ã¢â€“Â¿ WHITE DOWN-POINTING SMALL TRIANGLE
    'smalltriangleleft': u('\u25c3'), # Ã¢â€”Æ’ WHITE LEFT-POINTING SMALL TRIANGLE
    'smalltriangleright': u('\u25b9'), # Ã¢â€“Â¹ WHITE RIGHT-POINTING SMALL TRIANGLE
    'smalltriangleup': u('\u25b5'), # Ã¢â€“Âµ WHITE UP-POINTING SMALL TRIANGLE
    'sqcap': u('\u2293'), # Ã¢Å â€œ SQUARE CAP
    'sqcup': u('\u2294'), # Ã¢Å â€ SQUARE CUP
    'sslash': u('\u2afd'), # Ã¢Â«Â½ DOUBLE SOLIDUS OPERATOR
    'star': u('\u22c6'), # Ã¢â€¹â€  STAR OPERATOR
    'talloblong': u('\u2afe'), # Ã¢Â«Â¾ WHITE VERTICAL BAR
    'times': u('\xd7'), # Ãƒâ€” MULTIPLICATION SIGN
    'triangle': u('\u25b3'), # Ã¢â€“Â³ WHITE UP-POINTING TRIANGLE
    'triangledown': u('\u25bf'), # Ã¢â€“Â¿ WHITE DOWN-POINTING SMALL TRIANGLE
    'triangleleft': u('\u25c3'), # Ã¢â€”Æ’ WHITE LEFT-POINTING SMALL TRIANGLE
    'triangleright': u('\u25b9'), # Ã¢â€“Â¹ WHITE RIGHT-POINTING SMALL TRIANGLE
    'uplus': u('\u228e'), # Ã¢Å Å½ MULTISET UNION
    'vartriangle': u('\u25b3'), # Ã¢â€“Â³ WHITE UP-POINTING TRIANGLE
    'vee': u('\u2228'), # Ã¢Ë†Â¨ LOGICAL OR
    'veebar': u('\u22bb'), # Ã¢Å Â» XOR
    'wedge': u('\u2227'), # Ã¢Ë†Â§ LOGICAL AND
    'wr': u('\u2240'), # Ã¢â€°â‚¬ WREATH PRODUCT
    }
mathclose = {
    'Rbag': u('\u27c6'), # Ã¢Å¸â€  RIGHT S-SHAPED BAG DELIMITER
    'lrcorner': u('\u231f'), # Ã¢Å’Å¸ BOTTOM RIGHT CORNER
    'rangle': u('\u27e9'), # Ã¢Å¸Â© MATHEMATICAL RIGHT ANGLE BRACKET
    'rbag': u('\u27c6'), # Ã¢Å¸â€  RIGHT S-SHAPED BAG DELIMITER
    'rbrace': u('}'), # } RIGHT CURLY BRACKET
    'rbrack': u(']'), # ] RIGHT SQUARE BRACKET
    'rceil': u('\u2309'), # Ã¢Å’â€° RIGHT CEILING
    'rfloor': u('\u230b'), # Ã¢Å’â€¹ RIGHT FLOOR
    'rgroup': u('\u27ef'), # Ã¢Å¸Â¯ MATHEMATICAL RIGHT FLATTENED PARENTHESIS
    'rrbracket': u('\u27e7'), # Ã¢Å¸Â§ MATHEMATICAL RIGHT WHITE SQUARE BRACKET
    'rrparenthesis': u('\u2988'), # Ã¢Â¦Ë† Z NOTATION RIGHT IMAGE BRACKET
    'urcorner': u('\u231d'), # Ã¢Å’Â TOP RIGHT CORNER
    '}': u('}'), # } RIGHT CURLY BRACKET
    }
mathfence = {
    'Vert': u('\u2016'), # Ã¢â‚¬â€“ DOUBLE VERTICAL LINE
    'vert': u('|'), # | VERTICAL LINE
    '|': u('\u2016'), # Ã¢â‚¬â€“ DOUBLE VERTICAL LINE
    }
mathop = {
    'Join': u('\u2a1d'), # Ã¢Â¨Â JOIN
    'bigcap': u('\u22c2'), # Ã¢â€¹â€š N-ARY INTERSECTION
    'bigcup': u('\u22c3'), # Ã¢â€¹Æ’ N-ARY UNION
    'biginterleave': u('\u2afc'), # Ã¢Â«Â¼ LARGE TRIPLE VERTICAL BAR OPERATOR
    'bigodot': u('\u2a00'), # Ã¢Â¨â‚¬ N-ARY CIRCLED DOT OPERATOR
    'bigoplus': u('\u2a01'), # Ã¢Â¨Â N-ARY CIRCLED PLUS OPERATOR
    'bigotimes': u('\u2a02'), # Ã¢Â¨â€š N-ARY CIRCLED TIMES OPERATOR
    'bigsqcup': u('\u2a06'), # Ã¢Â¨â€  N-ARY SQUARE UNION OPERATOR
    'biguplus': u('\u2a04'), # Ã¢Â¨â€ N-ARY UNION OPERATOR WITH PLUS
    'bigvee': u('\u22c1'), # Ã¢â€¹Â N-ARY LOGICAL OR
    'bigwedge': u('\u22c0'), # Ã¢â€¹â‚¬ N-ARY LOGICAL AND
    'coprod': u('\u2210'), # Ã¢Ë†Â N-ARY COPRODUCT
    'fatsemi': u('\u2a1f'), # Ã¢Â¨Å¸ Z NOTATION SCHEMA COMPOSITION
    'fint': u('\u2a0f'), # Ã¢Â¨Â INTEGRAL AVERAGE WITH SLASH
    'iiiint': u('\u2a0c'), # Ã¢Â¨Å’ QUADRUPLE INTEGRAL OPERATOR
    'iiint': u('\u222d'), # Ã¢Ë†Â­ TRIPLE INTEGRAL
    'iint': u('\u222c'), # Ã¢Ë†Â¬ DOUBLE INTEGRAL
    'int': u('\u222b'), # Ã¢Ë†Â« INTEGRAL
    'oiint': u('\u222f'), # Ã¢Ë†Â¯ SURFACE INTEGRAL
    'oint': u('\u222e'), # Ã¢Ë†Â® CONTOUR INTEGRAL
    'ointctrclockwise': u('\u2233'), # Ã¢Ë†Â³ ANTICLOCKWISE CONTOUR INTEGRAL
    'prod': u('\u220f'), # Ã¢Ë†Â N-ARY PRODUCT
    'sqint': u('\u2a16'), # Ã¢Â¨â€“ QUATERNION INTEGRAL OPERATOR
    'sum': u('\u2211'), # Ã¢Ë†â€˜ N-ARY SUMMATION
    'varointclockwise': u('\u2232'), # Ã¢Ë†Â² CLOCKWISE CONTOUR INTEGRAL
    }
mathopen = {
    'Lbag': u('\u27c5'), # Ã¢Å¸â€¦ LEFT S-SHAPED BAG DELIMITER
    'langle': u('\u27e8'), # Ã¢Å¸Â¨ MATHEMATICAL LEFT ANGLE BRACKET
    'lbag': u('\u27c5'), # Ã¢Å¸â€¦ LEFT S-SHAPED BAG DELIMITER
    'lbrace': u('{'), # { LEFT CURLY BRACKET
    'lbrack': u('['), # [ LEFT SQUARE BRACKET
    'lceil': u('\u2308'), # Ã¢Å’Ë† LEFT CEILING
    'lfloor': u('\u230a'), # Ã¢Å’Å  LEFT FLOOR
    'lgroup': u('\u27ee'), # Ã¢Å¸Â® MATHEMATICAL LEFT FLATTENED PARENTHESIS
    'llbracket': u('\u27e6'), # Ã¢Å¸Â¦ MATHEMATICAL LEFT WHITE SQUARE BRACKET
    'llcorner': u('\u231e'), # Ã¢Å’Å¾ BOTTOM LEFT CORNER
    'llparenthesis': u('\u2987'), # Ã¢Â¦â€¡ Z NOTATION LEFT IMAGE BRACKET
    'ulcorner': u('\u231c'), # Ã¢Å’Å“ TOP LEFT CORNER
    '{': u('{'), # { LEFT CURLY BRACKET
    }
mathord = {
    '#': u('#'), # # NUMBER SIGN
    '$': u('$'), # $ DOLLAR SIGN
    '%': u('%'), # % PERCENT SIGN
    '&': u('&'), # & AMPERSAND
    'AC': u('\u223f'), # Ã¢Ë†Â¿ SINE WAVE
    'APLcomment': u('\u235d'), # Ã¢ÂÂ APL FUNCTIONAL SYMBOL UP SHOE JOT
    'APLdownarrowbox': u('\u2357'), # Ã¢Ââ€” APL FUNCTIONAL SYMBOL QUAD DOWNWARDS ARROW
    'APLinput': u('\u235e'), # Ã¢ÂÅ¾ APL FUNCTIONAL SYMBOL QUOTE QUAD
    'APLinv': u('\u2339'), # Ã¢Å’Â¹ APL FUNCTIONAL SYMBOL QUAD DIVIDE
    'APLleftarrowbox': u('\u2347'), # Ã¢Ââ€¡ APL FUNCTIONAL SYMBOL QUAD LEFTWARDS ARROW
    'APLlog': u('\u235f'), # Ã¢ÂÅ¸ APL FUNCTIONAL SYMBOL CIRCLE STAR
    'APLrightarrowbox': u('\u2348'), # Ã¢ÂË† APL FUNCTIONAL SYMBOL QUAD RIGHTWARDS ARROW
    'APLuparrowbox': u('\u2350'), # Ã¢ÂÂ APL FUNCTIONAL SYMBOL QUAD UPWARDS ARROW
    'Aries': u('\u2648'), # Ã¢â„¢Ë† ARIES
    'CIRCLE': u('\u25cf'), # Ã¢â€”Â BLACK CIRCLE
    'CheckedBox': u('\u2611'), # Ã¢Ëœâ€˜ BALLOT BOX WITH CHECK
    'Diamond': u('\u25c7'), # Ã¢â€”â€¡ WHITE DIAMOND
    'Finv': u('\u2132'), # Ã¢â€Â² TURNED CAPITAL F
    'Game': u('\u2141'), # Ã¢â€¦Â TURNED SANS-SERIF CAPITAL G
    'Gemini': u('\u264a'), # Ã¢â„¢Å  GEMINI
    'Jupiter': u('\u2643'), # Ã¢â„¢Æ’ JUPITER
    'LEFTCIRCLE': u('\u25d6'), # Ã¢â€”â€“ LEFT HALF BLACK CIRCLE
    'LEFTcircle': u('\u25d0'), # Ã¢â€”Â CIRCLE WITH LEFT HALF BLACK
    'Leo': u('\u264c'), # Ã¢â„¢Å’ LEO
    'Libra': u('\u264e'), # Ã¢â„¢Å½ LIBRA
    'Mars': u('\u2642'), # Ã¢â„¢â€š MALE SIGN
    'Mercury': u('\u263f'), # Ã¢ËœÂ¿ MERCURY
    'Neptune': u('\u2646'), # Ã¢â„¢â€  NEPTUNE
    'Pluto': u('\u2647'), # Ã¢â„¢â€¡ PLUTO
    'RIGHTCIRCLE': u('\u25d7'), # Ã¢â€”â€” RIGHT HALF BLACK CIRCLE
    'RIGHTcircle': u('\u25d1'), # Ã¢â€”â€˜ CIRCLE WITH RIGHT HALF BLACK
    'Saturn': u('\u2644'), # Ã¢â„¢â€ SATURN
    'Scorpio': u('\u264f'), # Ã¢â„¢Â SCORPIUS
    'Square': u('\u2610'), # Ã¢ËœÂ BALLOT BOX
    'Sun': u('\u2609'), # Ã¢Ëœâ€° SUN
    'Taurus': u('\u2649'), # Ã¢â„¢â€° TAURUS
    'Uranus': u('\u2645'), # Ã¢â„¢â€¦ URANUS
    'Venus': u('\u2640'), # Ã¢â„¢â‚¬ FEMALE SIGN
    'XBox': u('\u2612'), # Ã¢Ëœâ€™ BALLOT BOX WITH X
    'Yup': u('\u2144'), # Ã¢â€¦â€ TURNED SANS-SERIF CAPITAL Y
    '_': u('_'), # _ LOW LINE
    'angle': u('\u2220'), # Ã¢Ë†  ANGLE
    'aquarius': u('\u2652'), # Ã¢â„¢â€™ AQUARIUS
    'aries': u('\u2648'), # Ã¢â„¢Ë† ARIES
    'ast': u('*'), # * ASTERISK
    'backepsilon': u('\u03f6'), # ÃÂ¶ GREEK REVERSED LUNATE EPSILON SYMBOL
    'backprime': u('\u2035'), # Ã¢â‚¬Âµ REVERSED PRIME
    'backslash': unicode('\\'), # \ REVERSE SOLIDUS  #### Changed. was u'\'
    'because': u('\u2235'), # Ã¢Ë†Âµ BECAUSE
    'bigstar': u('\u2605'), # Ã¢Ëœâ€¦ BLACK STAR
    'binampersand': u('&'), # & AMPERSAND
    'blacklozenge': u('\u2b27'), # Ã¢Â¬Â§ BLACK MEDIUM LOZENGE
    'blacksmiley': u('\u263b'), # Ã¢ËœÂ» BLACK SMILING FACE
    'blacksquare': u('\u25fc'), # Ã¢â€”Â¼ BLACK MEDIUM SQUARE
    'bot': u('\u22a5'), # Ã¢Å Â¥ UP TACK
    'boy': u('\u2642'), # Ã¢â„¢â€š MALE SIGN
    'cancer': u('\u264b'), # Ã¢â„¢â€¹ CANCER
    'capricornus': u('\u2651'), # Ã¢â„¢â€˜ CAPRICORN
    'cdots': u('\u22ef'), # Ã¢â€¹Â¯ MIDLINE HORIZONTAL ELLIPSIS
    'cent': u('\xa2'), # Ã‚Â¢ CENT SIGN
    'centerdot': u('\u2b1d'), # Ã¢Â¬Â BLACK VERY SMALL SQUARE
    'checkmark': u('\u2713'), # Ã¢Å“â€œ CHECK MARK
    'circlearrowleft': u('\u21ba'), # Ã¢â€ Âº ANTICLOCKWISE OPEN CIRCLE ARROW
    'circlearrowright': u('\u21bb'), # Ã¢â€ Â» CLOCKWISE OPEN CIRCLE ARROW
    'circledR': u('\xae'), # Ã‚Â® REGISTERED SIGN
    'circledcirc': u('\u25ce'), # Ã¢â€”Å½ BULLSEYE
    'clubsuit': u('\u2663'), # Ã¢â„¢Â£ BLACK CLUB SUIT
    'complement': u('\u2201'), # Ã¢Ë†Â COMPLEMENT
    'dasharrow': u('\u21e2'), # Ã¢â€¡Â¢ RIGHTWARDS DASHED ARROW
    'dashleftarrow': u('\u21e0'), # Ã¢â€¡  LEFTWARDS DASHED ARROW
    'dashrightarrow': u('\u21e2'), # Ã¢â€¡Â¢ RIGHTWARDS DASHED ARROW
    'diameter': u('\u2300'), # Ã¢Å’â‚¬ DIAMETER SIGN
    'diamondsuit': u('\u2662'), # Ã¢â„¢Â¢ WHITE DIAMOND SUIT
    'earth': u('\u2641'), # Ã¢â„¢Â EARTH
    'exists': u('\u2203'), # Ã¢Ë†Æ’ THERE EXISTS
    'female': u('\u2640'), # Ã¢â„¢â‚¬ FEMALE SIGN
    'flat': u('\u266d'), # Ã¢â„¢Â­ MUSIC FLAT SIGN
    'forall': u('\u2200'), # Ã¢Ë†â‚¬ FOR ALL
    'fourth': u('\u2057'), # Ã¢Ââ€” QUADRUPLE PRIME
    'frownie': u('\u2639'), # Ã¢ËœÂ¹ WHITE FROWNING FACE
    'gemini': u('\u264a'), # Ã¢â„¢Å  GEMINI
    'girl': u('\u2640'), # Ã¢â„¢â‚¬ FEMALE SIGN
    'heartsuit': u('\u2661'), # Ã¢â„¢Â¡ WHITE HEART SUIT
    'infty': u('\u221e'), # Ã¢Ë†Å¾ INFINITY
    'invneg': u('\u2310'), # Ã¢Å’Â REVERSED NOT SIGN
    'jupiter': u('\u2643'), # Ã¢â„¢Æ’ JUPITER
    'ldots': u('\u2026'), # Ã¢â‚¬Â¦ HORIZONTAL ELLIPSIS
    'leftmoon': u('\u263e'), # Ã¢ËœÂ¾ LAST QUARTER MOON
    'leftturn': u('\u21ba'), # Ã¢â€ Âº ANTICLOCKWISE OPEN CIRCLE ARROW
    'leo': u('\u264c'), # Ã¢â„¢Å’ LEO
    'libra': u('\u264e'), # Ã¢â„¢Å½ LIBRA
    'lnot': u('\xac'), # Ã‚Â¬ NOT SIGN
    'lozenge': u('\u25ca'), # Ã¢â€”Å  LOZENGE
    'male': u('\u2642'), # Ã¢â„¢â€š MALE SIGN
    'maltese': u('\u2720'), # Ã¢Å“  MALTESE CROSS
    'mathdollar': u('$'), # $ DOLLAR SIGN
    'measuredangle': u('\u2221'), # Ã¢Ë†Â¡ MEASURED ANGLE
    'mercury': u('\u263f'), # Ã¢ËœÂ¿ MERCURY
    'mho': u('\u2127'), # Ã¢â€Â§ INVERTED OHM SIGN
    'nabla': u('\u2207'), # Ã¢Ë†â€¡ NABLA
    'natural': u('\u266e'), # Ã¢â„¢Â® MUSIC NATURAL SIGN
    'neg': u('\xac'), # Ã‚Â¬ NOT SIGN
    'neptune': u('\u2646'), # Ã¢â„¢â€  NEPTUNE
    'nexists': u('\u2204'), # Ã¢Ë†â€ THERE DOES NOT EXIST
    'notbackslash': u('\u2340'), # Ã¢Ââ‚¬ APL FUNCTIONAL SYMBOL BACKSLASH BAR
    'partial': u('\u2202'), # Ã¢Ë†â€š PARTIAL DIFFERENTIAL
    'pisces': u('\u2653'), # Ã¢â„¢â€œ PISCES
    'pluto': u('\u2647'), # Ã¢â„¢â€¡ PLUTO
    'pounds': u('\xa3'), # Ã‚Â£ POUND SIGN
    'prime': u('\u2032'), # Ã¢â‚¬Â² PRIME
    'quarternote': u('\u2669'), # Ã¢â„¢Â© QUARTER NOTE
    'rightmoon': u('\u263d'), # Ã¢ËœÂ½ FIRST QUARTER MOON
    'rightturn': u('\u21bb'), # Ã¢â€ Â» CLOCKWISE OPEN CIRCLE ARROW
    'sagittarius': u('\u2650'), # Ã¢â„¢Â SAGITTARIUS
    'saturn': u('\u2644'), # Ã¢â„¢â€ SATURN
    'scorpio': u('\u264f'), # Ã¢â„¢Â SCORPIUS
    'second': u('\u2033'), # Ã¢â‚¬Â³ DOUBLE PRIME
    'sharp': u('\u266f'), # Ã¢â„¢Â¯ MUSIC SHARP SIGN
    'sim': u('~'), # ~ TILDE
    'slash': u('/'), # / SOLIDUS
    'smiley': u('\u263a'), # Ã¢ËœÂº WHITE SMILING FACE
    'spadesuit': u('\u2660'), # Ã¢â„¢  BLACK SPADE SUIT
    'spddot': u('\xa8'), # Ã‚Â¨ DIAERESIS
    'sphat': u('^'), # ^ CIRCUMFLEX ACCENT
    'sphericalangle': u('\u2222'), # Ã¢Ë†Â¢ SPHERICAL ANGLE
    'sptilde': u('~'), # ~ TILDE
    'square': u('\u25fb'), # Ã¢â€”Â» WHITE MEDIUM SQUARE
    'sun': u('\u263c'), # Ã¢ËœÂ¼ WHITE SUN WITH RAYS
    'taurus': u('\u2649'), # Ã¢â„¢â€° TAURUS
    'therefore': u('\u2234'), # Ã¢Ë†Â´ THEREFORE
    'third': u('\u2034'), # Ã¢â‚¬Â´ TRIPLE PRIME
    'top': u('\u22a4'), # Ã¢Å Â¤ DOWN TACK
    'triangleleft': u('\u25c5'), # Ã¢â€”â€¦ WHITE LEFT-POINTING POINTER
    'triangleright': u('\u25bb'), # Ã¢â€“Â» WHITE RIGHT-POINTING POINTER
    'twonotes': u('\u266b'), # Ã¢â„¢Â« BEAMED EIGHTH NOTES
    'uranus': u('\u2645'), # Ã¢â„¢â€¦ URANUS
    'varEarth': u('\u2641'), # Ã¢â„¢Â EARTH
    'varnothing': u('\u2205'), # Ã¢Ë†â€¦ EMPTY SET
    'virgo': u('\u264d'), # Ã¢â„¢Â VIRGO
    'wasylozenge': u('\u2311'), # Ã¢Å’â€˜ SQUARE LOZENGE
    'wasytherefore': u('\u2234'), # Ã¢Ë†Â´ THEREFORE
    'yen': u('\xa5'), # Ã‚Â¥ YEN SIGN
    }
mathover = {
    'overbrace': u('\u23de'), # Ã¢ÂÅ¾ TOP CURLY BRACKET
    'wideparen': u('\u23dc'), # Ã¢ÂÅ“ TOP PARENTHESIS
    }
mathradical = {
    'sqrt': u('\u221a'), # Ã¢Ë†Å¡ SQUARE ROOT
    'sqrt[3]': u('\u221b'), # Ã¢Ë†â€º CUBE ROOT
    'sqrt[4]': u('\u221c'), # Ã¢Ë†Å“ FOURTH ROOT
    }
mathrel = {
    'Bumpeq': u('\u224e'), # Ã¢â€°Å½ GEOMETRICALLY EQUIVALENT TO
    'Doteq': u('\u2251'), # Ã¢â€°â€˜ GEOMETRICALLY EQUAL TO
    'Downarrow': u('\u21d3'), # Ã¢â€¡â€œ DOWNWARDS DOUBLE ARROW
    'Leftarrow': u('\u21d0'), # Ã¢â€¡Â LEFTWARDS DOUBLE ARROW
    'Leftrightarrow': u('\u21d4'), # Ã¢â€¡â€ LEFT RIGHT DOUBLE ARROW
    'Lleftarrow': u('\u21da'), # Ã¢â€¡Å¡ LEFTWARDS TRIPLE ARROW
    'Longleftarrow': u('\u27f8'), # Ã¢Å¸Â¸ LONG LEFTWARDS DOUBLE ARROW
    'Longleftrightarrow': u('\u27fa'), # Ã¢Å¸Âº LONG LEFT RIGHT DOUBLE ARROW
    'Longmapsfrom': u('\u27fd'), # Ã¢Å¸Â½ LONG LEFTWARDS DOUBLE ARROW FROM BAR
    'Longmapsto': u('\u27fe'), # Ã¢Å¸Â¾ LONG RIGHTWARDS DOUBLE ARROW FROM BAR
    'Longrightarrow': u('\u27f9'), # Ã¢Å¸Â¹ LONG RIGHTWARDS DOUBLE ARROW
    'Lsh': u('\u21b0'), # Ã¢â€ Â° UPWARDS ARROW WITH TIP LEFTWARDS
    'Mapsfrom': u('\u2906'), # Ã¢Â¤â€  LEFTWARDS DOUBLE ARROW FROM BAR
    'Mapsto': u('\u2907'), # Ã¢Â¤â€¡ RIGHTWARDS DOUBLE ARROW FROM BAR
    'Rightarrow': u('\u21d2'), # Ã¢â€¡â€™ RIGHTWARDS DOUBLE ARROW
    'Rrightarrow': u('\u21db'), # Ã¢â€¡â€º RIGHTWARDS TRIPLE ARROW
    'Rsh': u('\u21b1'), # Ã¢â€ Â± UPWARDS ARROW WITH TIP RIGHTWARDS
    'Subset': u('\u22d0'), # Ã¢â€¹Â DOUBLE SUBSET
    'Supset': u('\u22d1'), # Ã¢â€¹â€˜ DOUBLE SUPERSET
    'Uparrow': u('\u21d1'), # Ã¢â€¡â€˜ UPWARDS DOUBLE ARROW
    'Updownarrow': u('\u21d5'), # Ã¢â€¡â€¢ UP DOWN DOUBLE ARROW
    'VDash': u('\u22ab'), # Ã¢Å Â« DOUBLE VERTICAL BAR DOUBLE RIGHT TURNSTILE
    'Vdash': u('\u22a9'), # Ã¢Å Â© FORCES
    'Vvdash': u('\u22aa'), # Ã¢Å Âª TRIPLE VERTICAL BAR RIGHT TURNSTILE
    'apprge': u('\u2273'), # Ã¢â€°Â³ GREATER-THAN OR EQUIVALENT TO
    'apprle': u('\u2272'), # Ã¢â€°Â² LESS-THAN OR EQUIVALENT TO
    'approx': u('\u2248'), # Ã¢â€°Ë† ALMOST EQUAL TO
    'approxeq': u('\u224a'), # Ã¢â€°Å  ALMOST EQUAL OR EQUAL TO
    'asymp': u('\u224d'), # Ã¢â€°Â EQUIVALENT TO
    'backsim': u('\u223d'), # Ã¢Ë†Â½ REVERSED TILDE
    'backsimeq': u('\u22cd'), # Ã¢â€¹Â REVERSED TILDE EQUALS
    'barin': u('\u22f6'), # Ã¢â€¹Â¶ ELEMENT OF WITH OVERBAR
    'barleftharpoon': u('\u296b'), # Ã¢Â¥Â« LEFTWARDS HARPOON WITH BARB DOWN BELOW LONG DASH
    'barrightharpoon': u('\u296d'), # Ã¢Â¥Â­ RIGHTWARDS HARPOON WITH BARB DOWN BELOW LONG DASH
    'between': u('\u226c'), # Ã¢â€°Â¬ BETWEEN
    'bowtie': u('\u22c8'), # Ã¢â€¹Ë† BOWTIE
    'bumpeq': u('\u224f'), # Ã¢â€°Â DIFFERENCE BETWEEN
    'circeq': u('\u2257'), # Ã¢â€°â€” RING EQUAL TO
    'coloneq': u('\u2254'), # Ã¢â€°â€ COLON EQUALS
    'cong': u('\u2245'), # Ã¢â€°â€¦ APPROXIMATELY EQUAL TO
    'corresponds': u('\u2259'), # Ã¢â€°â„¢ ESTIMATES
    'curlyeqprec': u('\u22de'), # Ã¢â€¹Å¾ EQUAL TO OR PRECEDES
    'curlyeqsucc': u('\u22df'), # Ã¢â€¹Å¸ EQUAL TO OR SUCCEEDS
    'curvearrowleft': u('\u21b6'), # Ã¢â€ Â¶ ANTICLOCKWISE TOP SEMICIRCLE ARROW
    'curvearrowright': u('\u21b7'), # Ã¢â€ Â· CLOCKWISE TOP SEMICIRCLE ARROW
    'dashv': u('\u22a3'), # Ã¢Å Â£ LEFT TACK
    'ddots': u('\u22f1'), # Ã¢â€¹Â± DOWN RIGHT DIAGONAL ELLIPSIS
    'dlsh': u('\u21b2'), # Ã¢â€ Â² DOWNWARDS ARROW WITH TIP LEFTWARDS
    'doteq': u('\u2250'), # Ã¢â€°Â APPROACHES THE LIMIT
    'doteqdot': u('\u2251'), # Ã¢â€°â€˜ GEOMETRICALLY EQUAL TO
    'downarrow': u('\u2193'), # Ã¢â€ â€œ DOWNWARDS ARROW
    'downdownarrows': u('\u21ca'), # Ã¢â€¡Å  DOWNWARDS PAIRED ARROWS
    'downdownharpoons': u('\u2965'), # Ã¢Â¥Â¥ DOWNWARDS HARPOON WITH BARB LEFT BESIDE DOWNWARDS HARPOON WITH BARB RIGHT
    'downharpoonleft': u('\u21c3'), # Ã¢â€¡Æ’ DOWNWARDS HARPOON WITH BARB LEFTWARDS
    'downharpoonright': u('\u21c2'), # Ã¢â€¡â€š DOWNWARDS HARPOON WITH BARB RIGHTWARDS
    'downuparrows': u('\u21f5'), # Ã¢â€¡Âµ DOWNWARDS ARROW LEFTWARDS OF UPWARDS ARROW
    'downupharpoons': u('\u296f'), # Ã¢Â¥Â¯ DOWNWARDS HARPOON WITH BARB LEFT BESIDE UPWARDS HARPOON WITH BARB RIGHT
    'drsh': u('\u21b3'), # Ã¢â€ Â³ DOWNWARDS ARROW WITH TIP RIGHTWARDS
    'eqcirc': u('\u2256'), # Ã¢â€°â€“ RING IN EQUAL TO
    'eqcolon': u('\u2255'), # Ã¢â€°â€¢ EQUALS COLON
    'eqsim': u('\u2242'), # Ã¢â€°â€š MINUS TILDE
    'eqslantgtr': u('\u2a96'), # Ã¢Âªâ€“ SLANTED EQUAL TO OR GREATER-THAN
    'eqslantless': u('\u2a95'), # Ã¢Âªâ€¢ SLANTED EQUAL TO OR LESS-THAN
    'equiv': u('\u2261'), # Ã¢â€°Â¡ IDENTICAL TO
    'fallingdotseq': u('\u2252'), # Ã¢â€°â€™ APPROXIMATELY EQUAL TO OR THE IMAGE OF
    'frown': u('\u2322'), # Ã¢Å’Â¢ FROWN
    'ge': u('\u2265'), # Ã¢â€°Â¥ GREATER-THAN OR EQUAL TO
    'geq': u('\u2265'), # Ã¢â€°Â¥ GREATER-THAN OR EQUAL TO
    'geqq': u('\u2267'), # Ã¢â€°Â§ GREATER-THAN OVER EQUAL TO
    'geqslant': u('\u2a7e'), # Ã¢Â©Â¾ GREATER-THAN OR SLANTED EQUAL TO
    'gets': u('\u2190'), # Ã¢â€ Â LEFTWARDS ARROW
    'gg': u('\u226b'), # Ã¢â€°Â« MUCH GREATER-THAN
    'ggcurly': u('\u2abc'), # Ã¢ÂªÂ¼ DOUBLE SUCCEEDS
    'ggg': u('\u22d9'), # Ã¢â€¹â„¢ VERY MUCH GREATER-THAN
    'gnapprox': u('\u2a8a'), # Ã¢ÂªÅ  GREATER-THAN AND NOT APPROXIMATE
    'gneq': u('\u2a88'), # Ã¢ÂªË† GREATER-THAN AND SINGLE-LINE NOT EQUAL TO
    'gneqq': u('\u2269'), # Ã¢â€°Â© GREATER-THAN BUT NOT EQUAL TO
    'gnsim': u('\u22e7'), # Ã¢â€¹Â§ GREATER-THAN BUT NOT EQUIVALENT TO
    'gtrapprox': u('\u2a86'), # Ã¢Âªâ€  GREATER-THAN OR APPROXIMATE
    'gtrdot': u('\u22d7'), # Ã¢â€¹â€” GREATER-THAN WITH DOT
    'gtreqless': u('\u22db'), # Ã¢â€¹â€º GREATER-THAN EQUAL TO OR LESS-THAN
    'gtreqqless': u('\u2a8c'), # Ã¢ÂªÅ’ GREATER-THAN ABOVE DOUBLE-LINE EQUAL ABOVE LESS-THAN
    'gtrless': u('\u2277'), # Ã¢â€°Â· GREATER-THAN OR LESS-THAN
    'gtrsim': u('\u2273'), # Ã¢â€°Â³ GREATER-THAN OR EQUIVALENT TO
    'hash': u('\u22d5'), # Ã¢â€¹â€¢ EQUAL AND PARALLEL TO
    'hookleftarrow': u('\u21a9'), # Ã¢â€ Â© LEFTWARDS ARROW WITH HOOK
    'hookrightarrow': u('\u21aa'), # Ã¢â€ Âª RIGHTWARDS ARROW WITH HOOK
    'iddots': u('\u22f0'), # Ã¢â€¹Â° UP RIGHT DIAGONAL ELLIPSIS
    'impliedby': u('\u27f8'), # Ã¢Å¸Â¸ LONG LEFTWARDS DOUBLE ARROW
    'implies': u('\u27f9'), # Ã¢Å¸Â¹ LONG RIGHTWARDS DOUBLE ARROW
    'in': u('\u2208'), # Ã¢Ë†Ë† ELEMENT OF
    'le': u('\u2264'), # Ã¢â€°Â¤ LESS-THAN OR EQUAL TO
    'leftarrow': u('\u2190'), # Ã¢â€ Â LEFTWARDS ARROW
    'leftarrowtail': u('\u21a2'), # Ã¢â€ Â¢ LEFTWARDS ARROW WITH TAIL
    'leftarrowtriangle': u('\u21fd'), # Ã¢â€¡Â½ LEFTWARDS OPEN-HEADED ARROW
    'leftbarharpoon': u('\u296a'), # Ã¢Â¥Âª LEFTWARDS HARPOON WITH BARB UP ABOVE LONG DASH
    'leftharpoondown': u('\u21bd'), # Ã¢â€ Â½ LEFTWARDS HARPOON WITH BARB DOWNWARDS
    'leftharpoonup': u('\u21bc'), # Ã¢â€ Â¼ LEFTWARDS HARPOON WITH BARB UPWARDS
    'leftleftarrows': u('\u21c7'), # Ã¢â€¡â€¡ LEFTWARDS PAIRED ARROWS
    'leftleftharpoons': u('\u2962'), # Ã¢Â¥Â¢ LEFTWARDS HARPOON WITH BARB UP ABOVE LEFTWARDS HARPOON WITH BARB DOWN
    'leftrightarrow': u('\u2194'), # Ã¢â€ â€ LEFT RIGHT ARROW
    'leftrightarrows': u('\u21c6'), # Ã¢â€¡â€  LEFTWARDS ARROW OVER RIGHTWARDS ARROW
    'leftrightarrowtriangle': u('\u21ff'), # Ã¢â€¡Â¿ LEFT RIGHT OPEN-HEADED ARROW
    'leftrightharpoon': u('\u294a'), # Ã¢Â¥Å  LEFT BARB UP RIGHT BARB DOWN HARPOON
    'leftrightharpoons': u('\u21cb'), # Ã¢â€¡â€¹ LEFTWARDS HARPOON OVER RIGHTWARDS HARPOON
    'leftrightsquigarrow': u('\u21ad'), # Ã¢â€ Â­ LEFT RIGHT WAVE ARROW
    'leftslice': u('\u2aa6'), # Ã¢ÂªÂ¦ LESS-THAN CLOSED BY CURVE
    'leftsquigarrow': u('\u21dc'), # Ã¢â€¡Å“ LEFTWARDS SQUIGGLE ARROW
    'leq': u('\u2264'), # Ã¢â€°Â¤ LESS-THAN OR EQUAL TO
    'leqq': u('\u2266'), # Ã¢â€°Â¦ LESS-THAN OVER EQUAL TO
    'leqslant': u('\u2a7d'), # Ã¢Â©Â½ LESS-THAN OR SLANTED EQUAL TO
    'lessapprox': u('\u2a85'), # Ã¢Âªâ€¦ LESS-THAN OR APPROXIMATE
    'lessdot': u('\u22d6'), # Ã¢â€¹â€“ LESS-THAN WITH DOT
    'lesseqgtr': u('\u22da'), # Ã¢â€¹Å¡ LESS-THAN EQUAL TO OR GREATER-THAN
    'lesseqqgtr': u('\u2a8b'), # Ã¢Âªâ€¹ LESS-THAN ABOVE DOUBLE-LINE EQUAL ABOVE GREATER-THAN
    'lessgtr': u('\u2276'), # Ã¢â€°Â¶ LESS-THAN OR GREATER-THAN
    'lesssim': u('\u2272'), # Ã¢â€°Â² LESS-THAN OR EQUIVALENT TO
    'lightning': u('\u21af'), # Ã¢â€ Â¯ DOWNWARDS ZIGZAG ARROW
    'll': u('\u226a'), # Ã¢â€°Âª MUCH LESS-THAN
    'llcurly': u('\u2abb'), # Ã¢ÂªÂ» DOUBLE PRECEDES
    'lll': u('\u22d8'), # Ã¢â€¹Ëœ VERY MUCH LESS-THAN
    'lnapprox': u('\u2a89'), # Ã¢Âªâ€° LESS-THAN AND NOT APPROXIMATE
    'lneq': u('\u2a87'), # Ã¢Âªâ€¡ LESS-THAN AND SINGLE-LINE NOT EQUAL TO
    'lneqq': u('\u2268'), # Ã¢â€°Â¨ LESS-THAN BUT NOT EQUAL TO
    'lnsim': u('\u22e6'), # Ã¢â€¹Â¦ LESS-THAN BUT NOT EQUIVALENT TO
    'longleftarrow': u('\u27f5'), # Ã¢Å¸Âµ LONG LEFTWARDS ARROW
    'longleftrightarrow': u('\u27f7'), # Ã¢Å¸Â· LONG LEFT RIGHT ARROW
    'longmapsfrom': u('\u27fb'), # Ã¢Å¸Â» LONG LEFTWARDS ARROW FROM BAR
    'longmapsto': u('\u27fc'), # Ã¢Å¸Â¼ LONG RIGHTWARDS ARROW FROM BAR
    'longrightarrow': u('\u27f6'), # Ã¢Å¸Â¶ LONG RIGHTWARDS ARROW
    'looparrowleft': u('\u21ab'), # Ã¢â€ Â« LEFTWARDS ARROW WITH LOOP
    'looparrowright': u('\u21ac'), # Ã¢â€ Â¬ RIGHTWARDS ARROW WITH LOOP
    'mapsfrom': u('\u21a4'), # Ã¢â€ Â¤ LEFTWARDS ARROW FROM BAR
    'mapsto': u('\u21a6'), # Ã¢â€ Â¦ RIGHTWARDS ARROW FROM BAR
    'mid': u('\u2223'), # Ã¢Ë†Â£ DIVIDES
    'models': u('\u22a7'), # Ã¢Å Â§ MODELS
    'multimap': u('\u22b8'), # Ã¢Å Â¸ MULTIMAP
    'nLeftarrow': u('\u21cd'), # Ã¢â€¡Â LEFTWARDS DOUBLE ARROW WITH STROKE
    'nLeftrightarrow': u('\u21ce'), # Ã¢â€¡Å½ LEFT RIGHT DOUBLE ARROW WITH STROKE
    'nRightarrow': u('\u21cf'), # Ã¢â€¡Â RIGHTWARDS DOUBLE ARROW WITH STROKE
    'nVDash': u('\u22af'), # Ã¢Å Â¯ NEGATED DOUBLE VERTICAL BAR DOUBLE RIGHT TURNSTILE
    'nVdash': u('\u22ae'), # Ã¢Å Â® DOES NOT FORCE
    'ncong': u('\u2247'), # Ã¢â€°â€¡ NEITHER APPROXIMATELY NOR ACTUALLY EQUAL TO
    'ne': u('\u2260'), # Ã¢â€°  NOT EQUAL TO
    'nearrow': u('\u2197'), # Ã¢â€ â€” NORTH EAST ARROW
    'neq': u('\u2260'), # Ã¢â€°  NOT EQUAL TO
    'ngeq': u('\u2271'), # Ã¢â€°Â± NEITHER GREATER-THAN NOR EQUAL TO
    'ngtr': u('\u226f'), # Ã¢â€°Â¯ NOT GREATER-THAN
    'ni': u('\u220b'), # Ã¢Ë†â€¹ CONTAINS AS MEMBER
    'nleftarrow': u('\u219a'), # Ã¢â€ Å¡ LEFTWARDS ARROW WITH STROKE
    'nleftrightarrow': u('\u21ae'), # Ã¢â€ Â® LEFT RIGHT ARROW WITH STROKE
    'nleq': u('\u2270'), # Ã¢â€°Â° NEITHER LESS-THAN NOR EQUAL TO
    'nless': u('\u226e'), # Ã¢â€°Â® NOT LESS-THAN
    'nmid': u('\u2224'), # Ã¢Ë†Â¤ DOES NOT DIVIDE
    'notasymp': u('\u226d'), # Ã¢â€°Â­ NOT EQUIVALENT TO
    'notin': u('\u2209'), # Ã¢Ë†â€° NOT AN ELEMENT OF
    'notowner': u('\u220c'), # Ã¢Ë†Å’ DOES NOT CONTAIN AS MEMBER
    'notslash': u('\u233f'), # Ã¢Å’Â¿ APL FUNCTIONAL SYMBOL SLASH BAR
    'nparallel': u('\u2226'), # Ã¢Ë†Â¦ NOT PARALLEL TO
    'nprec': u('\u2280'), # Ã¢Å â‚¬ DOES NOT PRECEDE
    'npreceq': u('\u22e0'), # Ã¢â€¹  DOES NOT PRECEDE OR EQUAL
    'nrightarrow': u('\u219b'), # Ã¢â€ â€º RIGHTWARDS ARROW WITH STROKE
    'nsim': u('\u2241'), # Ã¢â€°Â NOT TILDE
    'nsubseteq': u('\u2288'), # Ã¢Å Ë† NEITHER A SUBSET OF NOR EQUAL TO
    'nsucc': u('\u2281'), # Ã¢Å Â DOES NOT SUCCEED
    'nsucceq': u('\u22e1'), # Ã¢â€¹Â¡ DOES NOT SUCCEED OR EQUAL
    'nsupseteq': u('\u2289'), # Ã¢Å â€° NEITHER A SUPERSET OF NOR EQUAL TO
    'ntriangleleft': u('\u22ea'), # Ã¢â€¹Âª NOT NORMAL SUBGROUP OF
    'ntrianglelefteq': u('\u22ec'), # Ã¢â€¹Â¬ NOT NORMAL SUBGROUP OF OR EQUAL TO
    'ntriangleright': u('\u22eb'), # Ã¢â€¹Â« DOES NOT CONTAIN AS NORMAL SUBGROUP
    'ntrianglerighteq': u('\u22ed'), # Ã¢â€¹Â­ DOES NOT CONTAIN AS NORMAL SUBGROUP OR EQUAL
    'nvDash': u('\u22ad'), # Ã¢Å Â­ NOT TRUE
    'nvdash': u('\u22ac'), # Ã¢Å Â¬ DOES NOT PROVE
    'nwarrow': u('\u2196'), # Ã¢â€ â€“ NORTH WEST ARROW
    'owns': u('\u220b'), # Ã¢Ë†â€¹ CONTAINS AS MEMBER
    'parallel': u('\u2225'), # Ã¢Ë†Â¥ PARALLEL TO
    'perp': u('\u27c2'), # Ã¢Å¸â€š PERPENDICULAR
    'pitchfork': u('\u22d4'), # Ã¢â€¹â€ PITCHFORK
    'prec': u('\u227a'), # Ã¢â€°Âº PRECEDES
    'precapprox': u('\u2ab7'), # Ã¢ÂªÂ· PRECEDES ABOVE ALMOST EQUAL TO
    'preccurlyeq': u('\u227c'), # Ã¢â€°Â¼ PRECEDES OR EQUAL TO
    'preceq': u('\u2aaf'), # Ã¢ÂªÂ¯ PRECEDES ABOVE SINGLE-LINE EQUALS SIGN
    'precnapprox': u('\u2ab9'), # Ã¢ÂªÂ¹ PRECEDES ABOVE NOT ALMOST EQUAL TO
    'precnsim': u('\u22e8'), # Ã¢â€¹Â¨ PRECEDES BUT NOT EQUIVALENT TO
    'precsim': u('\u227e'), # Ã¢â€°Â¾ PRECEDES OR EQUIVALENT TO
    'propto': u('\u221d'), # Ã¢Ë†Â PROPORTIONAL TO
    'restriction': u('\u21be'), # Ã¢â€ Â¾ UPWARDS HARPOON WITH BARB RIGHTWARDS
    'rightarrow': u('\u2192'), # Ã¢â€ â€™ RIGHTWARDS ARROW
    'rightarrowtail': u('\u21a3'), # Ã¢â€ Â£ RIGHTWARDS ARROW WITH TAIL
    'rightarrowtriangle': u('\u21fe'), # Ã¢â€¡Â¾ RIGHTWARDS OPEN-HEADED ARROW
    'rightbarharpoon': u('\u296c'), # Ã¢Â¥Â¬ RIGHTWARDS HARPOON WITH BARB UP ABOVE LONG DASH
    'rightharpoondown': u('\u21c1'), # Ã¢â€¡Â RIGHTWARDS HARPOON WITH BARB DOWNWARDS
    'rightharpoonup': u('\u21c0'), # Ã¢â€¡â‚¬ RIGHTWARDS HARPOON WITH BARB UPWARDS
    'rightleftarrows': u('\u21c4'), # Ã¢â€¡â€ RIGHTWARDS ARROW OVER LEFTWARDS ARROW
    'rightleftharpoon': u('\u294b'), # Ã¢Â¥â€¹ LEFT BARB DOWN RIGHT BARB UP HARPOON
    'rightleftharpoons': u('\u21cc'), # Ã¢â€¡Å’ RIGHTWARDS HARPOON OVER LEFTWARDS HARPOON
    'rightrightarrows': u('\u21c9'), # Ã¢â€¡â€° RIGHTWARDS PAIRED ARROWS
    'rightrightharpoons': u('\u2964'), # Ã¢Â¥Â¤ RIGHTWARDS HARPOON WITH BARB UP ABOVE RIGHTWARDS HARPOON WITH BARB DOWN
    'rightslice': u('\u2aa7'), # Ã¢ÂªÂ§ GREATER-THAN CLOSED BY CURVE
    'rightsquigarrow': u('\u21dd'), # Ã¢â€¡Â RIGHTWARDS SQUIGGLE ARROW
    'risingdotseq': u('\u2253'), # Ã¢â€°â€œ IMAGE OF OR APPROXIMATELY EQUAL TO
    'searrow': u('\u2198'), # Ã¢â€ Ëœ SOUTH EAST ARROW
    'sim': u('\u223c'), # Ã¢Ë†Â¼ TILDE OPERATOR
    'simeq': u('\u2243'), # Ã¢â€°Æ’ ASYMPTOTICALLY EQUAL TO
    'smallfrown': u('\u2322'), # Ã¢Å’Â¢ FROWN
    'smallsmile': u('\u2323'), # Ã¢Å’Â£ SMILE
    'smile': u('\u2323'), # Ã¢Å’Â£ SMILE
    'sqsubset': u('\u228f'), # Ã¢Å Â SQUARE IMAGE OF
    'sqsubseteq': u('\u2291'), # Ã¢Å â€˜ SQUARE IMAGE OF OR EQUAL TO
    'sqsupset': u('\u2290'), # Ã¢Å Â SQUARE ORIGINAL OF
    'sqsupseteq': u('\u2292'), # Ã¢Å â€™ SQUARE ORIGINAL OF OR EQUAL TO
    'subset': u('\u2282'), # Ã¢Å â€š SUBSET OF
    'subseteq': u('\u2286'), # Ã¢Å â€  SUBSET OF OR EQUAL TO
    'subseteqq': u('\u2ac5'), # Ã¢Â«â€¦ SUBSET OF ABOVE EQUALS SIGN
    'subsetneq': u('\u228a'), # Ã¢Å Å  SUBSET OF WITH NOT EQUAL TO
    'subsetneqq': u('\u2acb'), # Ã¢Â«â€¹ SUBSET OF ABOVE NOT EQUAL TO
    'succ': u('\u227b'), # Ã¢â€°Â» SUCCEEDS
    'succapprox': u('\u2ab8'), # Ã¢ÂªÂ¸ SUCCEEDS ABOVE ALMOST EQUAL TO
    'succcurlyeq': u('\u227d'), # Ã¢â€°Â½ SUCCEEDS OR EQUAL TO
    'succeq': u('\u2ab0'), # Ã¢ÂªÂ° SUCCEEDS ABOVE SINGLE-LINE EQUALS SIGN
    'succnapprox': u('\u2aba'), # Ã¢ÂªÂº SUCCEEDS ABOVE NOT ALMOST EQUAL TO
    'succnsim': u('\u22e9'), # Ã¢â€¹Â© SUCCEEDS BUT NOT EQUIVALENT TO
    'succsim': u('\u227f'), # Ã¢â€°Â¿ SUCCEEDS OR EQUIVALENT TO
    'supset': u('\u2283'), # Ã¢Å Æ’ SUPERSET OF
    'supseteq': u('\u2287'), # Ã¢Å â€¡ SUPERSET OF OR EQUAL TO
    'supseteqq': u('\u2ac6'), # Ã¢Â«â€  SUPERSET OF ABOVE EQUALS SIGN
    'supsetneq': u('\u228b'), # Ã¢Å â€¹ SUPERSET OF WITH NOT EQUAL TO
    'supsetneqq': u('\u2acc'), # Ã¢Â«Å’ SUPERSET OF ABOVE NOT EQUAL TO
    'swarrow': u('\u2199'), # Ã¢â€ â„¢ SOUTH WEST ARROW
    'to': u('\u2192'), # Ã¢â€ â€™ RIGHTWARDS ARROW
    'trianglelefteq': u('\u22b4'), # Ã¢Å Â´ NORMAL SUBGROUP OF OR EQUAL TO
    'triangleq': u('\u225c'), # Ã¢â€°Å“ DELTA EQUAL TO
    'trianglerighteq': u('\u22b5'), # Ã¢Å Âµ CONTAINS AS NORMAL SUBGROUP OR EQUAL TO
    'twoheadleftarrow': u('\u219e'), # Ã¢â€ Å¾ LEFTWARDS TWO HEADED ARROW
    'twoheadrightarrow': u('\u21a0'), # Ã¢â€   RIGHTWARDS TWO HEADED ARROW
    'uparrow': u('\u2191'), # Ã¢â€ â€˜ UPWARDS ARROW
    'updownarrow': u('\u2195'), # Ã¢â€ â€¢ UP DOWN ARROW
    'updownarrows': u('\u21c5'), # Ã¢â€¡â€¦ UPWARDS ARROW LEFTWARDS OF DOWNWARDS ARROW
    'updownharpoons': u('\u296e'), # Ã¢Â¥Â® UPWARDS HARPOON WITH BARB LEFT BESIDE DOWNWARDS HARPOON WITH BARB RIGHT
    'upharpoonleft': u('\u21bf'), # Ã¢â€ Â¿ UPWARDS HARPOON WITH BARB LEFTWARDS
    'upharpoonright': u('\u21be'), # Ã¢â€ Â¾ UPWARDS HARPOON WITH BARB RIGHTWARDS
    'upuparrows': u('\u21c8'), # Ã¢â€¡Ë† UPWARDS PAIRED ARROWS
    'upupharpoons': u('\u2963'), # Ã¢Â¥Â£ UPWARDS HARPOON WITH BARB LEFT BESIDE UPWARDS HARPOON WITH BARB RIGHT
    'vDash': u('\u22a8'), # Ã¢Å Â¨ TRUE
    'varpropto': u('\u221d'), # Ã¢Ë†Â PROPORTIONAL TO
    'vartriangleleft': u('\u22b2'), # Ã¢Å Â² NORMAL SUBGROUP OF
    'vartriangleright': u('\u22b3'), # Ã¢Å Â³ CONTAINS AS NORMAL SUBGROUP
    'vdash': u('\u22a2'), # Ã¢Å Â¢ RIGHT TACK
    'vdots': u('\u22ee'), # Ã¢â€¹Â® VERTICAL ELLIPSIS
    }
mathunder = {
    'underbrace': u('\u23df'), # Ã¢ÂÅ¸ BOTTOM CURLY BRACKET
    }
space = {
    ':': u('\u205f'), # Ã¢ÂÅ¸ MEDIUM MATHEMATICAL SPACE
    'medspace': u('\u205f'), # Ã¢ÂÅ¸ MEDIUM MATHEMATICAL SPACE
    'quad': u('\u2001'), # Ã¢â‚¬Â EM QUAD
    }
#@+node:ekr.20130807203905.16763: *4* u test
@first # -*- coding: utf8 -*-

import sys

g.cls()

def u(s):
    try:
        val = None
        if sys.version_info < (3,):
            val = s if isinstance(s,unicode) else unicode(s,"unicode_escape")
        else:
            val = s if isinstance(s,str) else str(s,"unicode_escape")
    except UnicodeDecodeError:
        ### There seems to be a bug: '\\uxxx' is not handled properly.
        if 1:
            g.trace('UnicodeDecodeError',repr(s),'isunicode',isinstance(s,unicode))
        else:
            try:
                val = unicode(s,'ascii')
            except UnicodeDecodeError:
                g.trace('UnicodeDecodeError',repr(s))
    return val
        
@others

for ch in aList:
    # print(ch)
    assert not isinstance(ch,unicode),repr(ch)
    ch2 = u(ch)
    # print(repr(ch))
    # assert unicode(ch,"unicode_escape") == ch2,repr(ch)
print('pass')
#@+node:ekr.20130807203905.16764: *5* from latex2e/__init__py
if 0:
    aList_with_u = (
    u('"'),
    u(r'\dq{}'),
    u(r'{\char`\"}'),
    u(r'\#'),
    u(r'\$'),
    u(r'\%'),
    u(r'\&'),
    u(r'\textasciitilde{}'),
    u(r'\_'),
    u(r'\textasciicircum{}'),
    u(r'\textbackslash{}'),
    u(r'\{'),
    u(r'\}'),
    u(r'{[}'),
    u(r'{]}'),
    u(r'\-'),                           # SOFT HYPHEN
    u(r'~'),                            # NO-BREAK SPACE
    u(r'\leavevmode\nobreak\vadjust{}~'),
    u(r'\,'),                           # PUNCTUATION SPACEÃ¢â‚¬Ë†Ã¢â‚¬Ë†Ã¢â‚¬Ë†
    u(r'\hbox{-}'),                     # NON-BREAKING HYPHEN
    u(r'\,'),                           # NARROW NO-BREAK SPACE
    u(r'$\Leftrightarrow$'),
    u(r'$\spadesuit$'),
    u(r'$\clubsuit$'),
    u(r'\guillemotleft'),   # LEFT-POINTING DOUBLE ANGLE QUOTATION MARK
    u(r'\guillemotright'),  # RIGHT-POINTING DOUBLE ANGLE QUOTATION MARK
    u(r'\textcompwordmark'), # ZERO WIDTH NON-JOINER
    u(r'\textendash{}'),
    u(r'\textemdash{}'),
    u(r'\textquoteleft{}'),
    u(r'\textquoteright{}'),
    u(r'\quotesinglbase{}'),    # SINGLE LOW-9 QUOTATION MARK
    u(r'\textquotedblleft{}'),
    u(r'\textquotedblright{}'),
    u(r'\quotedblbase{}'),      # DOUBLE LOW-9 QUOTATION MARK
    u(r'\textperthousand{}'),   # PER MILLE SIGN
    u(r'\textpertenthousand{}'), # PER TEN THOUSAND SIGN
    u(r'\guilsinglleft{}'),
    u(r'\guilsinglright{}'),
    u(r'\textvisiblespace{}'),  # OPEN BOX
    u(r'\dag{}'),
    u(r'\ddag{}'),
    u(r'\dots{}'),
    u(r'\texttrademark{}'),
    u(r'\textcent{}'),          # Ã‚Â¢ CENT SIGN
    u(r'\textcurrency{}'),      # Ã‚Â¤ CURRENCY SYMBOL
    u(r'\textyen{}'),           # Ã‚Â¥ YEN SIGN
    u(r'\textbrokenbar{}'),     # Ã‚Â¦ BROKEN BAR
    u(r'\textsection{}'),       # Ã‚Â§ SECTION SIGN
    u(r'\textasciidieresis{}'), # Ã‚Â¨ DIAERESIS
    u(r'\textcopyright{}'),     # Ã‚Â© COPYRIGHT SIGN
    u(r'\textordfeminine{}'),   # Ã‚Âª FEMININE ORDINAL INDICATOR
    u(r'\textlnot{}'),          # Ã‚Â¬ NOT SIGN
    u(r'\textregistered{}'),    # Ã‚Â® REGISTERED SIGN
    u(r'\textasciimacron{}'),   # Ã‚Â¯ MACRON
    u(r'\textdegree{}'),        # Ã‚Â° DEGREE SIGN
    u(r'\textpm{}'),            # Ã‚Â± PLUS-MINUS SIGN
    u(r'\texttwosuperior{}'),   # Ã‚Â² SUPERSCRIPT TWO
    u(r'\textthreesuperior{}'), # Ã‚Â³ SUPERSCRIPT THREE
    u(r'\textasciiacute{}'),    # Ã‚Â´ ACUTE ACCENT
    u(r'\textmu{}'),            # Ã‚Âµ MICRO SIGN
    u(r'\textparagraph{}'),     # Ã‚Â¶ PILCROW SIGN # not equal to \textpilcrow
    u(r'\textonesuperior{}'),   # Ã‚Â¹ SUPERSCRIPT ONE
    u(r'\textordmasculine{}'),  # Ã‚Âº MASCULINE ORDINAL INDICATOR
    u(r'\textonequarter{}'),    # 1/4 FRACTION
    u(r'\textonehalf{}'),       # 1/2 FRACTION
    u(r'\textthreequarters{}'), # 3/4 FRACTION
    u(r'\texttimes{}'),         # Ãƒâ€” MULTIPLICATION SIGN
    u(r'\textdiv{}'),           # ÃƒÂ· DIVISION SIGN
    u(r'\textflorin{}'),        # LATIN SMALL LETTER F WITH HOOK
    u(r'\textasciiacute{}'),    # MODIFIER LETTER PRIME
    u(r'\textacutedbl{}'),      # MODIFIER LETTER DOUBLE PRIME
    u(r'\textbardbl{}'),        # DOUBLE VERTICAL LINE
    u(r'\textbullet{}'),        # BULLET
    u(r'\textasciiacute{}'),    # PRIME
    u(r'\textacutedbl{}'),      # DOUBLE PRIME
    u(r'\textasciigrave{}'),    # REVERSED PRIME
    u(r'\textgravedbl{}'),      # REVERSED DOUBLE PRIME
    u(r'\textreferencemark{}'), # REFERENCE MARK
    u(r'\textinterrobang{}'),   # INTERROBANG
    u(r'\textfractionsolidus{}'), # FRACTION SLASH
    u(r'\textlquill{}'),        # LEFT SQUARE BRACKET WITH QUILL
    u(r'\textrquill{}'),        # RIGHT SQUARE BRACKET WITH QUILL
    u(r'\textdiscount{}'),      # COMMERCIAL MINUS SIGN
    u(r'\textcolonmonetary{}'), # COLON SIGN
    u(r'\textfrenchfranc{}'),   # FRENCH FRANC SIGN
    u(r'\textlira{}'),          # LIRA SIGN
    u(r'\textnaira{}'),         # NAIRA SIGN
    u(r'\textwon{}'),           # WON SIGN
    u(r'\textdong{}'),          # DONG SIGN
    u(r'\texteuro{}'),          # EURO SIGN
    u(r'\textpeso{}'),          # PESO SIGN
    u(r'\textguarani{}'),       # GUARANI SIGN
    u(r'\textcelsius{}'),       # DEGREE CELSIUS
    u(r'\textnumero{}'),        # NUMERO SIGN
    u(r'\textcircledP{}'),      # SOUND RECORDING COYRIGHT
    u(r'\textrecipe{}'),        # PRESCRIPTION TAKE
    u(r'\textservicemark{}'),   # SERVICE MARK
    u(r'\texttrademark{}'),     # TRADE MARK SIGN
    u(r'\textohm{}'),           # OHM SIGN
    u(r'\textmho{}'),           # INVERTED OHM SIGN
    u(r'\textestimated{}'),     # ESTIMATED SYMBOL
    u(r'\textleftarrow{}'),     # LEFTWARDS ARROW
    u(r'\textuparrow{}'),       # UPWARDS ARROW
    u(r'\textrightarrow{}'),    # RIGHTWARDS ARROW
    u(r'\textdownarrow{}'),     # DOWNWARDS ARROW
    u(r'\textminus{}'),         # MINUS SIGN
    u(r'\textasteriskcentered{}'), # ASTERISK OPERATOR
    u(r'\textsurd{}'),          # SQUARE ROOT
    u(r'\textblank{}'),         # BLANK SYMBOL
    u(r'\textopenbullet{}'),    # WHITE BULLET
    u(r'\textbigcircle{}'),     # LARGE CIRCLE
    u(r'\textmusicalnote{}'),   # EIGHTH NOTE
    u(r'\textmarried{}'),       # MARRIAGE SYMBOL
    u(r'\textdivorced{}'),      # DIVORCE SYMBOL
    u(r'\textlangle{}'),        # MATHEMATICAL LEFT ANGLE BRACKET
    u(r'\textrangle{}'),        # MATHEMATICAL RIGHT ANGLE BRACKET
    u(r'\ding{170}'),     # black heartsuit
    u(r'\ding{169}'),     # black diamondsuit
    u(r'\ding{51}'),      # check mark
    u(r'\ding{55}'),      # check mark
    u("Cannot embed stylesheet '%s':\n  %s."),
    # Causes problems.     
    u('\\underline{~}'), 
    u(r'\reflectbox{/}'),
    u(r'\textbar{}'),
    u(r'\textless{}'),
    u(r'\textgreater{}'),
    u(r'~'),
    u('$%s$'),                        
    u(r'\#'),
    u(r'\%'),
    u(r'\\'),       
    u('Ã¢â‚¬â€'),
)

# wrapper = u('\n').join(['%%',
     # r'\begin{%s}' % math_env,
     # '%s',
     # r'\end{%s}' % math_env])

unicode_aList = (
    u'"',
    ur'\dq{}',
    ur'{\char`\"}',
    ur'\#',
    ur'\$',
    ur'\%',
    ur'\&',
    ur'\textasciitilde{}',
    ur'\_',
    ur'\textasciicircum{}',
    ur'\textbackslash{}',
    ur'\{',
    ur'\}',
    ur'{[}',
    ur'{]}',
    ur'\-',
    ur'~',
    ur'\leavevmode\nobreak\vadjust{}~',
    ur'\,',
    ur'\hbox{-}',
    ur'\,',
    ur'$\Leftrightarrow$',
    ur'$\spadesuit$',
    ur'$\clubsuit$',
    ur'\guillemotleft',
    ur'\guillemotright',
    ur'\textcompwordmark',
    ur'\textendash{}',
    ur'\textemdash{}',
    ur'\textquoteleft{}',
    ur'\textquoteright{}',
    ur'\quotesinglbase{}',
    ur'\textquotedblleft{}',
    ur'\textquotedblright{}',
    ur'\quotedblbase{}',
    ur'\textperthousand{}',
    ur'\textpertenthousand{}',
    ur'\guilsinglleft{}',
    ur'\guilsinglright{}',
    ur'\textvisiblespace{}',
    ur'\dag{}',
    ur'\ddag{}',
    ur'\dots{}',
    ur'\texttrademark{}',
    ur'\textcent{}',
    ur'\textcurrency{}',
    ur'\textyen{}',
    ur'\textbrokenbar{}',
    ur'\textsection{}',
    ur'\textasciidieresis{}',
    ur'\textcopyright{}',
    ur'\textordfeminine{}',
    ur'\textlnot{}',
    ur'\textregistered{}',
    ur'\textasciimacron{}',
    ur'\textdegree{}',
    ur'\textpm{}',
    ur'\texttwosuperior{}',
    ur'\textthreesuperior{}',
    ur'\textasciiacute{}',
    ur'\textmu{}',
    ur'\textparagraph{}',
    ur'\textonesuperior{}',
    ur'\textordmasculine{}',
    ur'\textonequarter{}',
    ur'\textonehalf{}',
    ur'\textthreequarters{}',
    ur'\texttimes{}',
    ur'\textdiv{}',
    ur'\textflorin{}',
    ur'\textasciiacute{}',
    ur'\textacutedbl{}',
    ur'\textbardbl{}',
    ur'\textbullet{}',
    ur'\textasciiacute{}',
    ur'\textacutedbl{}',
    ur'\textasciigrave{}',
    ur'\textgravedbl{}',
    ur'\textreferencemark{}',
    ur'\textinterrobang{}',
    ur'\textfractionsolidus{}',
    ur'\textlquill{}',
    ur'\textrquill{}',
    ur'\textdiscount{}',
    ur'\textcolonmonetary{}',
    ur'\textfrenchfranc{}',
    ur'\textlira{}',
    ur'\textnaira{}',
    ur'\textwon{}',
    ur'\textdong{}',
    ur'\texteuro{}',
    ur'\textpeso{}',
    ur'\textguarani{}',
    ur'\textcelsius{}',
    ur'\textnumero{}',
    ur'\textcircledP{}',
    ur'\textrecipe{}',
    ur'\textservicemark{}',
    ur'\texttrademark{}',
    ur'\textohm{}',
    ur'\textmho{}',
    ur'\textestimated{}',
    ur'\textleftarrow{}',
    ur'\textuparrow{}',
    ur'\textrightarrow{}',
    ur'\textdownarrow{}',
    ur'\textminus{}',
    ur'\textasteriskcentered{}',
    ur'\textsurd{}',
    ur'\textblank{}',
    ur'\textopenbullet{}',
    ur'\textbigcircle{}',
    ur'\textmusicalnote{}',
    ur'\textmarried{}',
    ur'\textdivorced{}',
    ur'\textlangle{}',
    ur'\textrangle{}',
    ur'\ding{170}',
    ur'\ding{169}',
    ur'\ding{51}',
    ur'\ding{55}',
    u"Cannot embed stylesheet '%s':\n  %s.",
    u'\\underline{~}', # Can not use ur('\uxxxx) because that is a unicode escapse!!
    ur'\reflectbox{/}',
    ur'\textbar{}',
    ur'\textless{}',
    ur'\textgreater{}',
    ur'~',
    u'$%s$',
    # ur'\'
    ur'\%',
    ur'\\',
    u'Ã¢â‚¬â€',
)

aList = (
    '"',
    r'\dq{}',
    r'{\char`\"}',
    r'\#',
    r'\$',
    r'\%',
    r'\&',
    r'\textasciitilde{}',
    r'\_',
    r'\textasciicircum{}',
    r'\textbackslash{}',
    r'\{',
    r'\}',
    r'{[}',
    r'{]}',
    r'\-',
    r'~',
    r'\leavevmode\nobreak\vadjust{}~',
    r'\,',
    r'\hbox{-}',
    r'\,',
    r'$\Leftrightarrow$',
    r'$\spadesuit$',
    r'$\clubsuit$',
    r'\guillemotleft',
    r'\guillemotright',
    r'\textcompwordmark',
    r'\textendash{}',
    r'\textemdash{}',
    r'\textquoteleft{}',
    r'\textquoteright{}',
    r'\quotesinglbase{}',
    r'\textquotedblleft{}',
    r'\textquotedblright{}',
    r'\quotedblbase{}',
    r'\textperthousand{}',
    r'\textpertenthousand{}',
    r'\guilsinglleft{}',
    r'\guilsinglright{}',
    r'\textvisiblespace{}',
    r'\dag{}',
    r'\ddag{}',
    r'\dots{}',
    r'\texttrademark{}',
    r'\textcent{}',
    r'\textcurrency{}',
    r'\textyen{}',
    r'\textbrokenbar{}',
    r'\textsection{}',
    r'\textasciidieresis{}',
    r'\textcopyright{}',
    r'\textordfeminine{}',
    r'\textlnot{}',
    r'\textregistered{}',
    r'\textasciimacron{}',
    r'\textdegree{}',
    r'\textpm{}',
    r'\texttwosuperior{}',
    r'\textthreesuperior{}',
    r'\textasciiacute{}',
    r'\textmu{}',
    r'\textparagraph{}',
    r'\textonesuperior{}',
    r'\textordmasculine{}',
    r'\textonequarter{}',
    r'\textonehalf{}',
    r'\textthreequarters{}',
    r'\texttimes{}',
    r'\textdiv{}',
    r'\textflorin{}',
    r'\textasciiacute{}',
    r'\textacutedbl{}',
    r'\textbardbl{}',
    r'\textbullet{}',
    r'\textasciiacute{}',
    r'\textacutedbl{}',
    r'\textasciigrave{}',
    r'\textgravedbl{}',
    r'\textreferencemark{}',
    r'\textinterrobang{}',
    r'\textfractionsolidus{}',
    r'\textlquill{}',
    r'\textrquill{}',
    r'\textdiscount{}',
    r'\textcolonmonetary{}',
    r'\textfrenchfranc{}',
    r'\textlira{}',
    r'\textnaira{}',
    r'\textwon{}',
    r'\textdong{}',
    r'\texteuro{}',
    r'\textpeso{}',
    r'\textguarani{}',
    r'\textcelsius{}',
    r'\textnumero{}',
    r'\textcircledP{}',
    r'\textrecipe{}',
    r'\textservicemark{}',
    r'\texttrademark{}',
    r'\textohm{}',
    r'\textmho{}',
    r'\textestimated{}',
    r'\textleftarrow{}',
    r'\textuparrow{}',
    r'\textrightarrow{}',
    r'\textdownarrow{}',
    r'\textminus{}',
    r'\textasteriskcentered{}',
    r'\textsurd{}',
    r'\textblank{}',
    r'\textopenbullet{}',
    r'\textbigcircle{}',
    r'\textmusicalnote{}',
    r'\textmarried{}',
    r'\textdivorced{}',
    r'\textlangle{}',
    r'\textrangle{}',
    r'\ding{170}',
    r'\ding{169}',
    r'\ding{51}',
    r'\ding{55}',
    "Cannot embed stylesheet '%s':\n  %s.",
    '\\' + 'underline{~}', # Can not use ur('\uxxxx) because that is a unicode escapse!!
    r'\reflectbox{/}',
    r'\textbar{}',
    r'\textless{}',
    r'\textgreater{}',
    r'~',
    '$%s$',
    # r'\'
    r'\%',
    r'\\',
    # u'Ã¢â‚¬â€',
)

# wrapper = u('\n').join(['%%',
     # r'\begin{%s}' % math_env,
     # '%s',
     # r'\end{%s}' % math_env])

#@+node:ekr.20130807203905.16765: *3* Files with u and ur constants
ur constants:
    
writers\manpage.py
writers\latex2e\__init__.py
utils\math\latex2matchml.py

u constants:

core.py
frontend.py
io.py
nodes.py
statemachine.py
__init__.py
languages\ca.py
languages\cs.py
languages\eo.py
languages\es.py
languages\fi.py
languages\fr.py
languages\gl.py
languages\he.py
languages\ja.py
languages\lt.py
languages\pl.py
languages\pt_br.py
languages\ru.py
languages\sk.py
languages\sv.py
languages\zh_cn.py
languages\zh_tw.py
parsers\rst\states.py
parsers\rst\directives\body.py
parsers\rst\directives\misc.py
parsers\rst\directives\tables.py
parsers\rst\directives\__init__.py
parsers\rst\languages\af.py
parsers\rst\languages\ca.py
parsers\rst\languages\cs.py
parsers\rst\languages\de.py
parsers\rst\languages\eo.py
parsers\rst\languages\es.py
parsers\rst\languages\fi.py
parsers\rst\languages\fr.py
parsers\rst\languages\gl.py
parsers\rst\languages\he.py
parsers\rst\languages\it.py
parsers\rst\languages\ja.py
parsers\rst\languages\lt.py
parsers\rst\languages\nl.py
parsers\rst\languages\pl.py
parsers\rst\languages\pt_br.py
parsers\rst\languages\ru.py
parsers\rst\languages\sk.py
parsers\rst\languages\sv.py
parsers\rst\languages\zh_cn.py
parsers\rst\languages\zh_tw.py
transforms\parts.py
transforms\references.py
utils\error_reporting.py
utils\punctuation_chars.py
utils\smartquotes.py
utils\__init__.py
utils\math\latex2mathml.py
utils\math\math2html.py
utils\math\tex2unichar.py
utils\math\unichar2tex.py
writers\manpage.py
writers\html4css1\__init__.py
writers\latex2e\__init__.py
writers\odf_odt\__init__.py
writers\xetex\__init__.py
#@+node:ekr.20130807203905.16589: ** 4.11 a1 part 2
#@-all

# Put this @language after the @all as a kind of permanent unit test.

#@@language python # Override the default .txt coloring.

#@@pagewidth 60
#@-leo
