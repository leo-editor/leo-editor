<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<!-- Mirrored from webpages.charter.net/edreamleo/ListManagerDocs.html by HTTrack Website Copier/3.x [XR&CO'2010], Fri, 22 Feb 2013 17:55:52 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.3.1: http://docutils.sourceforge.net/" />
<title>ListManager Documentation</title>
<meta name="author" content="Steven Zatz" />
<meta name="date" content="2003/12/24 " />
<meta name="copyright" content="Application and documentation use the Python license which is compatible with the GPL." />
<link rel="stylesheet" href="default.css" type="text/css" />
</head>
<body>
<div class="document" id="listmanager-documentation">
<h1 class="title">ListManager Documentation</h1>
<table class="docinfo" frame="void" rules="none">
<col class="docinfo-name" />
<col class="docinfo-content" />
<tbody valign="top">
<tr><th class="docinfo-name">Author:</th>
<td>Steven Zatz</td></tr>
<tr><th class="docinfo-name">Contact:</th>
<td><a class="first last reference" href="mailto:slzatz&#64;hotmail.com">slzatz&#64;hotmail.com</a></td></tr>
<tr><th class="docinfo-name">Date:</th>
<td>2003/12/24 </td></tr>
<tr><th class="docinfo-name">Status:</th>
<td>This is a &quot;work in progress&quot;</td></tr>
<tr><th class="docinfo-name">Revision:</th>
<td>1.02</td></tr>
<tr><th class="docinfo-name">Copyright:</th>
<td>Application and documentation use the Python license which is compatible with the GPL.</td></tr>
</tbody>
</table>
<!-- filename: ListManagerDocs.html -->
<p>This is experimental documentation of a program called ListManager, written in Python and wxPython using Leo to create both 
the application code and the associated reST documentation.</p>
<p>ListManager is an application that allows a group of people working on a joint project to maintain a common list of todos and related 
items that have owners, due dates and associated notes.  The application uses mysql as its database for group use and also uses 
sqlite for locally resident databases for personal lists.  It works in conjunction with Outlook to allow email messages to be sent 
to ListManager for inclusion in lists and uses Outlook to mail messages to users.</p>
<div class="contents topic" id="table-of-contents">
<p class="topic-title"><a name="table-of-contents">Table of Contents</a></p>
<ul class="simple">
<li><a class="reference" href="#wxlistmanager-py" id="id15" name="id15">wxListManager.py</a><ul>
<li><a class="reference" href="#initial-stuff" id="id16" name="id16">Initial stuff</a><ul>
<li><a class="reference" href="#module-imports" id="id17" name="id17">Module Imports</a></li>
<li><a class="reference" href="#constants" id="id18" name="id18">Constants</a></li>
<li><a class="reference" href="#menu-ids" id="id19" name="id19">Menu IDs</a></li>
<li><a class="reference" href="#read-config-file" id="id20" name="id20">Read Config File</a></li>
</ul>
</li>
<li><a class="reference" href="#class-listmanager" id="id21" name="id21">class ListManager</a><ul>
<li><a class="reference" href="#instantiation" id="id22" name="id22">Instantiation</a><ul>
<li><a class="reference" href="#def-init" id="id23" name="id23">def __init__</a><ul>
<li><a class="reference" href="#list-manager-attributes" id="id24" name="id24">&lt;&lt; List Manager Attributes &gt;&gt;</a></li>
<li><a class="reference" href="#menu-setup" id="id25" name="id25">&lt;&lt; Menu Setup &gt;&gt;</a></li>
<li><a class="reference" href="#toolbar-setup" id="id26" name="id26">&lt;&lt; Toolbar Setup &gt;&gt;</a></li>
<li><a class="reference" href="#menu-toolbar-events" id="id27" name="id27">&lt;&lt; Menu/Toolbar Events &gt;&gt;</a></li>
<li><a class="reference" href="#create-controls" id="id28" name="id28">&lt;&lt; Create Controls&gt;&gt;</a></li>
<li><a class="reference" href="#other-events" id="id29" name="id29">&lt;&lt; Other Events &gt;&gt;</a></li>
<li><a class="reference" href="#layout-stuff" id="id30" name="id30">&lt;&lt; Layout Stuff &gt;&gt;</a></li>
<li><a class="reference" href="#gui-instance-objects" id="id31" name="id31">&lt;&lt; GUI Instance Objects &gt;&gt;</a></li>
<li><a class="reference" href="#create-socket" id="id32" name="id32">&lt;&lt; Create Socket &gt;&gt;</a></li>
<li><a class="reference" href="#load-recent-files" id="id33" name="id33">&lt;&lt; Load Recent Files &gt;&gt;</a></li>
<li><a class="reference" href="#idle-timer" id="id34" name="id34">&lt;&lt; Idle Timer &gt;&gt;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#ownerlist-creation-methods-used-by-thread" id="id35" name="id35">Ownerlist creation methods (used by thread)</a><ul>
<li><a class="reference" href="#def-createownerlist" id="id36" name="id36">def createownerlist</a></li>
<li><a class="reference" href="#def-createownerdialog" id="id37" name="id37">def createownerdialog</a></li>
</ul>
</li>
<li><a class="reference" href="#notebook-methods" id="id38" name="id38">Notebook methods</a><ul>
<li><a class="reference" href="#def-createnewnotebookpage" id="id39" name="id39">def CreateNewNotebookPage</a><ul>
<li><a class="reference" href="#fill-ownerlistbox" id="id40" name="id40">&lt;&lt; Fill OwnerListBox &gt;&gt;</a></li>
<li><a class="reference" href="#listcontrol-events" id="id41" name="id41">&lt;&lt; ListControl Events &gt;&gt;</a></li>
</ul>
</li>
<li><a class="reference" href="#def-onpagechange" id="id42" name="id42">def OnPageChange</a><ul>
<li><a class="reference" href="#find-highlighted-row" id="id43" name="id43">&lt;&lt; Find Highlighted Row &gt;&gt;</a></li>
<li><a class="reference" href="#update-title" id="id44" name="id44">&lt;&lt; Update Title &gt;&gt;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#tickler-methods" id="id45" name="id45">Tickler methods</a><ul>
<li><a class="reference" href="#def-onshowtickler" id="id46" name="id46">def OnShowTickler</a></li>
<li><a class="reference" href="#def-onactivatetickler" id="id47" name="id47">def OnActivateTickler</a></li>
</ul>
</li>
<li><a class="reference" href="#email-methods" id="id48" name="id48">Email methods</a><ul>
<li><a class="reference" href="#onmailitem" id="id49" name="id49">OnMailItem</a></li>
<li><a class="reference" href="#onmailview" id="id50" name="id50">OnMailView</a></li>
</ul>
</li>
<li><a class="reference" href="#cut-copy-paste-methods" id="id51" name="id51">Cut/Copy/Paste methods</a><ul>
<li><a class="reference" href="#oncopyitems" id="id52" name="id52">OnCopyItems</a><ul>
<li><a class="reference" href="#find-highlighted-items" id="id53" name="id53">&lt;&lt; Find Highlighted Items &gt;&gt;</a></li>
</ul>
</li>
<li><a class="reference" href="#onpasteitems" id="id54" name="id54">OnPasteItems</a></li>
<li><a class="reference" href="#ondeleteitems" id="id55" name="id55">OnDeleteItems</a></li>
</ul>
</li>
<li><a class="reference" href="#mousedown-methods" id="id56" name="id56">MouseDown methods</a><ul>
<li><a class="reference" href="#onleftdown-action-depends-on-x-coordinate" id="id57" name="id57">OnLeftDown (Action depends on x coordinate)</a></li>
<li><a class="reference" href="#onrightdown-display-popup-sendto-menu" id="id58" name="id58">OnRightDown (Display popup sendto menu)</a></li>
</ul>
</li>
<li><a class="reference" href="#move-combine-items-methods" id="id59" name="id59">Move/Combine items methods</a><ul>
<li><a class="reference" href="#oncombineitems" id="id60" name="id60">OnCombineItems</a></li>
<li><a class="reference" href="#onmovetolist" id="id61" name="id61">OnMoveToList</a></li>
<li><a class="reference" href="#onmovetospecificlist" id="id62" name="id62">OnMoveToSpecificList</a></li>
</ul>
</li>
<li><a class="reference" href="#change-update-items-methods" id="id63" name="id63">Change/update items methods</a><ul>
<li><a class="reference" href="#ontogglefinished" id="id64" name="id64">OnToggleFinished</a><ul>
<li><a class="reference" href="#draw-item" id="id65" name="id65">&lt;&lt; draw item &gt;&gt;</a></li>
</ul>
</li>
<li><a class="reference" href="#onpriority" id="id66" name="id66">OnPriority</a><ul>
<li><a class="reference" href="#id1" id="id67" name="id67">&lt;&lt; draw item &gt;&gt;</a></li>
</ul>
</li>
<li><a class="reference" href="#inplace-edit-methods" id="id68" name="id68">Inplace Edit Methods</a><ul>
<li><a class="reference" href="#ondisplayinplaceeditor" id="id69" name="id69">OnDisplayInPlaceEditor</a></li>
<li><a class="reference" href="#oncloseinplaceeditor" id="id70" name="id70">OnCloseInPlaceEditor</a></li>
</ul>
</li>
<li><a class="reference" href="#onduedate" id="id71" name="id71">OnDueDate</a></li>
<li><a class="reference" href="#oneditowner" id="id72" name="id72">OnEditOwner</a><ul>
<li><a class="reference" href="#common-owner-code" id="id73" name="id73">&lt;&lt; Common Owner Code &gt;&gt;</a></li>
</ul>
</li>
<li><a class="reference" href="#onupdate" id="id74" name="id74">OnUpdate</a><ul>
<li><a class="reference" href="#id2" id="id75" name="id75">&lt;&lt; Common Owner Code &gt;&gt;</a></li>
</ul>
</li>
<li><a class="reference" href="#onnewitem" id="id76" name="id76">OnNewItem</a><ul>
<li><a class="reference" href="#clear-data-fields" id="id77" name="id77">&lt;&lt; Clear data fields &gt;&gt;</a></li>
</ul>
</li>
<li><a class="reference" href="#conflict-not-in-use" id="id78" name="id78">Conflict (not in use)</a></li>
<li><a class="reference" href="#oneditnote" id="id79" name="id79">OnEditNote</a></li>
</ul>
</li>
<li><a class="reference" href="#file-menu-methods" id="id80" name="id80">File menu methods</a><ul>
<li><a class="reference" href="#onnewlist" id="id81" name="id81">OnNewList</a></li>
<li><a class="reference" href="#onfilelist" id="id82" name="id82">OnFileList</a></li>
<li><a class="reference" href="#onopenlist" id="id83" name="id83">OnOpenList</a></li>
<li><a class="reference" href="#ondeletelist" id="id84" name="id84">OnDeleteList</a></li>
<li><a class="reference" href="#oncloselist" id="id85" name="id85">OnCloseList</a></li>
<li><a class="reference" href="#oncloseall" id="id86" name="id86">OnCloseAll</a></li>
<li><a class="reference" href="#onsaveastext" id="id87" name="id87">OnSaveAsText</a></li>
<li><a class="reference" href="#onarchive" id="id88" name="id88">OnArchive</a></li>
<li><a class="reference" href="#onworkoffline" id="id89" name="id89">OnWorkOffline</a></li>
</ul>
</li>
<li><a class="reference" href="#display-methods" id="id90" name="id90">Display methods</a><ul>
<li><a class="reference" href="#onitemselected" id="id91" name="id91">OnItemSelected</a></li>
<li><a class="reference" href="#onitemactivated" id="id92" name="id92">OnItemActivated</a></li>
<li><a class="reference" href="#onshowall" id="id93" name="id93">OnShowAll</a></li>
<li><a class="reference" href="#onrefresh" id="id94" name="id94">OnRefresh</a></li>
<li><a class="reference" href="#onfilterowners" id="id95" name="id95">OnFilterOwners</a></li>
<li><a class="reference" href="#oncolumnclick-to-sort-columns" id="id96" name="id96">OnColumnClick (to sort columns)</a></li>
<li><a class="reference" href="#onshowfinished" id="id97" name="id97">OnShowFinished</a></li>
<li><a class="reference" href="#oncolumnrightclick-popup-to-change-date-displayed" id="id98" name="id98">OnColumnRightClick (popup to change date displayed)</a></li>
<li><a class="reference" href="#ondisplaydatecategory" id="id99" name="id99">OnDisplayDateCategory</a></li>
<li><a class="reference" href="#changedatedisplayed" id="id100" name="id100">ChangeDateDisplayed</a></li>
<li><a class="reference" href="#displaylist" id="id101" name="id101">DisplayList</a><ul>
<li><a class="reference" href="#id3" id="id102" name="id102">&lt;&lt; draw item &gt;&gt;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#printing-methods" id="id103" name="id103">Printing methods</a><ul>
<li><a class="reference" href="#onpagesetup" id="id104" name="id104">OnPageSetup</a></li>
<li><a class="reference" href="#onprint" id="id105" name="id105">OnPrint</a></li>
</ul>
</li>
<li><a class="reference" href="#exiting-methods" id="id106" name="id106">Exiting methods</a><ul>
<li><a class="reference" href="#onwindowexit" id="id107" name="id107">OnWindowExit</a></li>
<li><a class="reference" href="#onexit" id="id108" name="id108">OnExit</a><ul>
<li><a class="reference" href="#save-configuration-file" id="id109" name="id109">&lt;&lt;save configuration file&gt;&gt;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#find-methods" id="id110" name="id110">Find methods</a><ul>
<li><a class="reference" href="#onfind" id="id111" name="id111">OnFind</a></li>
<li><a class="reference" href="#findstring" id="id112" name="id112">FindString</a></li>
<li><a class="reference" href="#findnode" id="id113" name="id113">FindNode</a></li>
</ul>
</li>
<li><a class="reference" href="#database-related-methods" id="id114" name="id114">Database-related methods</a><ul>
<li><a class="reference" href="#getcursor" id="id115" name="id115">GetCursor</a></li>
<li><a class="reference" href="#getnote" id="id116" name="id116">GetNote</a></li>
<li><a class="reference" href="#createtable" id="id117" name="id117">CreateTable</a></li>
<li><a class="reference" href="#readfromdb-returns-db-results" id="id118" name="id118">ReadFromDB (returns db results)</a></li>
<li><a class="reference" href="#createanddisplaylist-returns-item-list" id="id119" name="id119">CreateAndDisplayList (returns Item List)</a><ul>
<li><a class="reference" href="#assign-item-attributes" id="id120" name="id120">&lt;&lt; assign item attributes &gt;&gt;</a></li>
<li><a class="reference" href="#id4" id="id121" name="id121">&lt;&lt; draw item &gt;&gt;</a></li>
</ul>
</li>
<li><a class="reference" href="#onsync" id="id122" name="id122">OnSync</a></li>
<li><a class="reference" href="#timestamper" id="id123" name="id123">TimeStamper</a></li>
</ul>
</li>
<li><a class="reference" href="#evaluate-methods" id="id124" name="id124">Evaluate methods</a><ul>
<li><a class="reference" href="#onshowevaluate" id="id125" name="id125">OnShowEvaluate</a></li>
<li><a class="reference" href="#onevaluate" id="id126" name="id126">OnEvaluate</a></li>
</ul>
</li>
<li><a class="reference" href="#help-menu-methods" id="id127" name="id127">Help menu methods</a><ul>
<li><a class="reference" href="#onshowabout" id="id128" name="id128">OnShowAbout</a></li>
<li><a class="reference" href="#onshowhelp" id="id129" name="id129">OnShowHelp</a></li>
</ul>
</li>
<li><a class="reference" href="#getuid" id="id130" name="id130">GetUID</a></li>
<li><a class="reference" href="#onidle" id="id131" name="id131">OnIdle</a><ul>
<li><a class="reference" href="#check-for-transfers-from-outlook" id="id132" name="id132">&lt;&lt; Check for Transfers From Outlook &gt;&gt;</a></li>
<li><a class="reference" href="#check-if-edited-file-has-changed" id="id133" name="id133">&lt;&lt; Check if Edited File has Changed &gt;&gt;</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#class-listctrl" id="id134" name="id134">class ListCtrl</a><ul>
<li><a class="reference" href="#init" id="id135" name="id135">__init__</a></li>
<li><a class="reference" href="#setupcolumns" id="id136" name="id136">SetUpColumns</a></li>
<li><a class="reference" href="#oncolbegindrag" id="id137" name="id137">OnColBeginDrag</a></li>
</ul>
</li>
<li><a class="reference" href="#class-myapp" id="id138" name="id138">class MyApp</a><ul>
<li><a class="reference" href="#oninit" id="id139" name="id139">OnInit</a></li>
</ul>
</li>
<li><a class="reference" href="#class-logger" id="id140" name="id140">class Logger</a></li>
<li><a class="reference" href="#run" id="id141" name="id141">run</a></li>
</ul>
</li>
<li><a class="reference" href="#file-lmdialogs-py" id="id142" name="id142">&#64;file LMDialogs.py</a><ul>
<li><a class="reference" href="#class-popdialog" id="id143" name="id143">class PopDialog</a><ul>
<li><a class="reference" href="#id5" id="id144" name="id144">__init__</a></li>
<li><a class="reference" href="#onleftdown" id="id145" name="id145">OnLeftDown</a></li>
<li><a class="reference" href="#onforward" id="id146" name="id146">OnForward</a></li>
<li><a class="reference" href="#onmail" id="id147" name="id147">OnMail</a></li>
</ul>
</li>
<li><a class="reference" href="#class-startupdialog" id="id148" name="id148">class StartupDialog</a><ul>
<li><a class="reference" href="#id6" id="id149" name="id149">__init__</a></li>
<li><a class="reference" href="#onselection" id="id150" name="id150">OnSelection</a></li>
</ul>
</li>
<li><a class="reference" href="#class-modifierdialog" id="id151" name="id151">class ModifierDialog</a><ul>
<li><a class="reference" href="#id7" id="id152" name="id152">__init__</a></li>
<li><a class="reference" href="#getuserinput" id="id153" name="id153">GetUserInput</a></li>
<li><a class="reference" href="#selectcurrent" id="id154" name="id154">SelectCurrent</a></li>
<li><a class="reference" href="#clearselections" id="id155" name="id155">ClearSelections</a></li>
</ul>
</li>
<li><a class="reference" href="#class-maildialog" id="id156" name="id156">class MailDialog</a><ul>
<li><a class="reference" href="#id8" id="id157" name="id157">__init__</a></li>
</ul>
</li>
<li><a class="reference" href="#class-calendardialog" id="id158" name="id158">class CalendarDialog</a><ul>
<li><a class="reference" href="#id9" id="id159" name="id159">__init__</a></li>
<li><a class="reference" href="#oncalselected" id="id160" name="id160">OnCalSelected</a></li>
<li><a class="reference" href="#onchangemonth" id="id161" name="id161">OnChangeMonth</a></li>
<li><a class="reference" href="#onclosewindow" id="id162" name="id162">OnCloseWindow</a></li>
<li><a class="reference" href="#getdate" id="id163" name="id163">GetDate</a></li>
</ul>
</li>
<li><a class="reference" href="#class-finddialog" id="id164" name="id164">class FindDialog</a><ul>
<li><a class="reference" href="#id10" id="id165" name="id165">__init__</a></li>
</ul>
</li>
<li><a class="reference" href="#class-evaldialog" id="id166" name="id166">class EvalDialog</a><ul>
<li><a class="reference" href="#id11" id="id167" name="id167">__init__</a></li>
<li><a class="reference" href="#postokevent" id="id168" name="id168">PostOKEvent</a></li>
</ul>
</li>
<li><a class="reference" href="#class-loggerdialog" id="id169" name="id169">class LoggerDialog</a><ul>
<li><a class="reference" href="#id12" id="id170" name="id170">__init__</a></li>
<li><a class="reference" href="#onsave" id="id171" name="id171">OnSave</a></li>
</ul>
</li>
<li><a class="reference" href="#class-finisheddialog" id="id172" name="id172">class FinishedDialog</a><ul>
<li><a class="reference" href="#id13" id="id173" name="id173">__init__</a></li>
<li><a class="reference" href="#onspin" id="id174" name="id174">OnSpin</a></li>
<li><a class="reference" href="#oncheck" id="id175" name="id175">OnCheck</a></li>
</ul>
</li>
<li><a class="reference" href="#class-treedialog" id="id176" name="id176">class TreeDialog</a><ul>
<li><a class="reference" href="#id14" id="id177" name="id177">__init__</a></li>
<li><a class="reference" href="#onleftdclick" id="id178" name="id178">OnLeftDClick:</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#file-outlookaddin-py" id="id179" name="id179">&#64;file outlookAddin.py</a><ul>
<li><a class="reference" href="#outlookaddin-declarations" id="id180" name="id180">&lt;&lt; outlookAddin declarations &gt;&gt;</a></li>
<li><a class="reference" href="#class-buttonevent" id="id181" name="id181">class ButtonEvent</a><ul>
<li><a class="reference" href="#onclick" id="id182" name="id182">OnClick</a></li>
</ul>
</li>
<li><a class="reference" href="#class-folderevent" id="id183" name="id183">class FolderEvent</a><ul>
<li><a class="reference" href="#onitemadd" id="id184" name="id184">OnItemAdd</a></li>
</ul>
</li>
<li><a class="reference" href="#class-outlookaddin" id="id185" name="id185">class OutlookAddin</a><ul>
<li><a class="reference" href="#class-outlookaddin-declarations" id="id186" name="id186">&lt;&lt; class OutlookAddin declarations &gt;&gt;</a></li>
<li><a class="reference" href="#onconnection" id="id187" name="id187">OnConnection</a></li>
<li><a class="reference" href="#ondisconnection" id="id188" name="id188">OnDisconnection</a></li>
<li><a class="reference" href="#onaddinsupdate" id="id189" name="id189">OnAddInsUpdate</a></li>
<li><a class="reference" href="#onstartupcomplete" id="id190" name="id190">OnStartupComplete</a></li>
<li><a class="reference" href="#onbeginshutdown" id="id191" name="id191">OnBeginShutdown</a></li>
</ul>
</li>
<li><a class="reference" href="#registeraddin" id="id192" name="id192">RegisterAddin</a></li>
<li><a class="reference" href="#unregisteraddin" id="id193" name="id193">UnregisterAddin</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="wxlistmanager-py">
<h1><a class="toc-backref" href="#id15" name="wxlistmanager-py">wxListManager.py</a></h1>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;@</span><span class="p_identifier">language</span><span class="p_default">&nbsp;</span><span class="p_identifier">python</span>
</div>
<div class="section" id="initial-stuff">
<h2><a class="toc-backref" href="#id16" name="initial-stuff">Initial stuff</a></h2>
<p><strong>comments</strong>:</p>
<p>Nothing unusual in what follows:  we start with the module imports, setting some global constants including Menu Ids and read the ListManager.ini file.</p>
<div class="section" id="module-imports">
<h3><a class="toc-backref" href="#id17" name="module-imports">Module Imports</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPython</span><span class="p_operator">.</span><span class="p_identifier">wx</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_operator">*</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPython</span><span class="p_operator">.</span><span class="p_identifier">lib</span><span class="p_operator">.</span><span class="p_identifier">mixins</span><span class="p_operator">.</span><span class="p_identifier">listctrl</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxListCtrlAutoWidthMixin</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">time</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">pickle</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">socket</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">select</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">random</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">ConfigParser</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">threading</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">re</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">sys</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">pywintypes</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">CreateGuid</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32com</span><span class="p_operator">.</span><span class="p_identifier">client</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">Dispatch</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#import&nbsp;win32pdh</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32api</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#from&nbsp;win32com.client&nbsp;import&nbsp;constants&nbsp;#--&gt;&nbsp;just&nbsp;needed&nbsp;two&nbsp;constants...</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">MySQLdb</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">sqlite</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">LMDialogs</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">CalendarDialog</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">TicklerDialog</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">MailDialog</span><span class="p_operator">,</span><span class="p_identifier">LoggerDialog</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">FinishedDialog</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">FindDialog</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">EvalDialog</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">TreeDialog</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">StartupDialog</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#from&nbsp;wxTreeCtrl&nbsp;import&nbsp;TreeDialog</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">printout</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">PrintTable</span>
</div>
<p><strong>comments</strong>:</p>
<dl>
<dt>os</dt>
<dd>uses <tt class="literal"><span class="pre">os.getcwd</span></tt>, <tt class="literal"><span class="pre">os.path.split</span></tt>, <tt class="literal"><span class="pre">os.chdir</span></tt>, <tt class="literal"><span class="pre">os.path.join</span></tt>, <tt class="literal"><span class="pre">os.path.getmtime</span></tt>, <tt class="literal"><span class="pre">os.startfile</span></tt>, <tt class="literal"><span class="pre">os.environ</span></tt></dd>
<dt>time</dt>
<dd>uses <tt class="literal"><span class="pre">time.sleep</span></tt>, <tt class="literal"><span class="pre">time.asctime</span></tt></dd>
<dt>pickle</dt>
<dd>used to serialize data that is moved from Outlook to ListManager via sockets.</dd>
<dt>socket</dt>
<dd>as noted above, a socket is opened between Outlook and ListManager to move messages back and forth</dd>
<dt>select</dt>
<dd>ListManager selects on the socket to see if there is a message that has been queued by Outlook</dd>
<dt>random</dt>
<dd>used by the reminder popup to select messages</dd>
<dt>ConfigParser</dt>
<dd>not surprisingly, using ConfiParser to parse the ListManager.ini file.</dd>
<dt>threading</dt>
<dd>more for fun than absolute necessity, a thread is opened on starting the program that constructs the list of owners for items.  In theory, if the datasize and number of Lists were large enough it could delay the appearance of the GUI and its initial responsiveness if we didn't construct the ownerlist in a thread.  On the other hand, it really let me play with threads and with creating a custom event that signalled the construction of the owner list to the main thread by posting a custom event.</dd>
<dt>re</dt>
<dd>mainly using <tt class="literal"><span class="pre">re.sub('[\\/:*&quot;&lt;&gt;|\?]','-',f)</span></tt> to make sure that files are constructed only with legal characters.  Also searching the body text of nodes using re because it allows case insensitive searches through <tt class="literal"><span class="pre">re.compile(pat,</span> <span class="pre">re.I)</span></tt>.</dd>
<dt>pywintypes.CreateGuid</dt>
<dd>probably should use pure python GUID that is in ASPN cookbook but it was easiest to just use the Windows GUID function.  Thank you Mark Hammond for win32all.</dd>
<dt>win32com.client.Dispatch</dt>
<dd>used when launching Outlook to send email messages</dd>
<dt>win32api</dt>
<dd>using win32api.GetUserName() in case there is no user name in the ini file or no ini file</dd>
<dt>MySQLdb</dt>
<dd>using Andy Dustman's python extension module to connect to mysql back-end.</dd>
<dt>sqlite</dt>
<dd>using  D. Richard Hipp's python extension to connect to local sqlite databases</dd>
<dt>import mx.DateTime</dt>
<dd>using Marc-Andr√© Lemburg's mx.DateTime for dealing with datetime stuff in the databases</dd>
<dt>CalendarDialog, ModifierDialog, TicklerDialog, MailDialog,LoggerDialog, FinishedDialog, FindDialog, EvalDialog, TreeDialog, StartupDialog</dt>
<dd>should just import LMDialogs and then access each dialog class by LM.WhateverDialog</dd>
<dt>printout.PrintTable</dt>
<dd>There was an existing wxPython print module for printing from tables that I have modified to print Lists.</dd>
<dt><em>#from win32com.client import constants</em></dt>
<dd>probably not wise but since the app only needs two constants from this module, just set the directly.  If MSFT decides to change the api, this is not good.</dd>
</dl>
</div>
<div class="section" id="constants">
<h3><a class="toc-backref" href="#id18" name="constants">Constants</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cwd</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">getcwd</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">DIRECTORY</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_identifier">cwd</span><span class="p_operator">)[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">chdir</span><span class="p_operator">(</span><span class="p_identifier">DIRECTORY</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">del</span><span class="p_default">&nbsp;</span><span class="p_identifier">cwd</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Outlook&nbsp;Constants</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">olMailItem</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0x0</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">olFlagMarked</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0x2</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_default">&nbsp;</span><span class="p_commentline">#False-&gt;&nbsp;Online&nbsp;only&nbsp;&nbsp;;&nbsp;True-&gt;&nbsp;Online&nbsp;and&nbsp;Offline&nbsp;possible;&nbsp;REMOTE_HOST&nbsp;=&nbsp;None&nbsp;-&gt;&nbsp;Offline&nbsp;only</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">VERSION</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'1.02'</span>
</div>
<p><strong>comments</strong>:</p>
<p>The following two global constants are needed to create emails through Outlook via COM:</p>
<pre class="literal-block">
olMailItem = 0x0
olFlagMarked = 0x2
</pre>
<p>For some reason, it seemed easier to just include them explicitly rather than worrying about generating all the Outlook constants in order to use early binding.  I supppose if MSFT changes the api, that would be a problem.</p>
</div>
<div class="section" id="menu-ids">
<h3><a class="toc-backref" href="#id19" name="menu-ids">Menu IDs</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#File&nbsp;Menu-----------------#</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idNEWLIST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1000</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idOPENLIST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1010</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idCLOSELIST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1015</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idCLOSEALL</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1017</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idSAVEAS</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1020</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idDELETELIST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1025</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idPAGESETUP</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1030</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idPRINT</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1035</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idPRINTPREV</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1040</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idMAILLIST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1045</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idOFFLINE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1048</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idEXIT</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1050</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Edit&nbsp;Menu-----------------</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idCUT</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1055</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idCOPY</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1060</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idPASTE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1065</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idDELETEITEMS</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1070</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idCOMBINEITEMS</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1075</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idFIND</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1080</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Item&nbsp;Menu-------------------</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idNEWITEM</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1085</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idTOGGLEFINISHED</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1090</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idEDITOWNER</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1095</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idDUEDATE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1100</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idEDITNOTE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1105</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idMAILITEM</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_number">1110</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Diplay&nbsp;Menu---------------------</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idSHOWFINISHED</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1115</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idSHOWALL</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1120</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idREFRESH</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1125</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idDISPLAYDATE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1130</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Tool&nbsp;Menu------------------------</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idTICKLERACTIVE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1135</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idSHOWNEXT</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1140</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idSYNC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1145</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idARCHIVE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1150</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idEVALUATE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1155</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idTOOLPRINT</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1165</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idSENDTO</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1170</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Help&nbsp;Menu-------------------------</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idABOUT</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1175</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idHELP</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1180</span>
</div>
<p><strong>comments</strong>:</p>
<p>Menu Ids -- not much more to say although there should be something to say.</p>
</div>
<div class="section" id="read-config-file">
<h3><a class="toc-backref" href="#id20" name="read-config-file">Read Config File</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">config_file</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">DIRECTORY</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"List&nbsp;Manager.ini"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">defaults</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dict</span><span class="p_operator">(</span><span class="p_identifier">pw</span><span class="p_operator">=</span><span class="p_character">'python'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">db</span><span class="p_operator">=</span><span class="p_character">'listmanager'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">ext</span><span class="p_operator">=</span><span class="p_character">'txt'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">local</span><span class="p_operator">=</span><span class="p_character">'wxLMDB:sqlite'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_operator">=</span><span class="p_character">'700'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">y</span><span class="p_operator">=</span><span class="p_character">'400'</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ConfigParser</span><span class="p_operator">.</span><span class="p_identifier">ConfigParser</span><span class="p_operator">(</span><span class="p_identifier">defaults</span><span class="p_operator">=</span><span class="p_identifier">defaults</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">read</span><span class="p_operator">(</span><span class="p_identifier">config_file</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#ConfigParser&nbsp;closes&nbsp;the&nbsp;file</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">USER</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">has_option</span><span class="p_operator">(</span><span class="p_character">'User'</span><span class="p_operator">,</span><span class="p_character">'user'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'User'</span><span class="p_operator">,</span><span class="p_character">'user'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32api</span><span class="p_operator">.</span><span class="p_identifier">GetUserName</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;the&nbsp;following&nbsp;all&nbsp;have&nbsp;default&nbsp;values&nbsp;provided&nbsp;in&nbsp;the&nbsp;constructor</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">PW</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'User'</span><span class="p_operator">,</span><span class="p_character">'pw'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">DB</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'Database'</span><span class="p_operator">,</span><span class="p_character">'db'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">NOTE_EXT</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'Note'</span><span class="p_operator">,</span><span class="p_character">'ext'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LOCAL_HOST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'Hosts'</span><span class="p_operator">,</span><span class="p_character">'local'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">X</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">getint</span><span class="p_operator">(</span><span class="p_character">'Configuration'</span><span class="p_operator">,</span><span class="p_character">'x'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">Y</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">getint</span><span class="p_operator">(</span><span class="p_character">'Configuration'</span><span class="p_operator">,</span><span class="p_character">'y'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;the&nbsp;folloowing&nbsp;default&nbsp;to&nbsp;None</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">MAIL_LIST_PATH</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">has_option</span><span class="p_operator">(</span><span class="p_character">'Mail'</span><span class="p_operator">,</span><span class="p_character">'path'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'Mail'</span><span class="p_operator">,</span><span class="p_character">'path'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">QUICK_LIST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">has_option</span><span class="p_operator">(</span><span class="p_character">'User'</span><span class="p_operator">,</span><span class="p_character">'quicklist'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'User'</span><span class="p_operator">,</span><span class="p_character">'quicklist'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;the&nbsp;following&nbsp;default&nbsp;to&nbsp;False</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">STARTUP_DIALOG</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">has_option</span><span class="p_operator">(</span><span class="p_character">'User'</span><span class="p_operator">,</span><span class="p_character">'startup_dialog'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">getboolean</span><span class="p_operator">(</span><span class="p_character">'User'</span><span class="p_operator">,</span><span class="p_character">'startup_dialog'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">DELETE_LIST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">has_option</span><span class="p_operator">(</span><span class="p_character">'User'</span><span class="p_operator">,</span><span class="p_character">'delete_list'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">getboolean</span><span class="p_operator">(</span><span class="p_character">'User'</span><span class="p_operator">,</span><span class="p_character">'delete_list'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">OUTLOOK</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">has_option</span><span class="p_operator">(</span><span class="p_character">'Mail'</span><span class="p_operator">,</span><span class="p_character">'outlook'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">getboolean</span><span class="p_operator">(</span><span class="p_character">'Mail'</span><span class="p_operator">,</span><span class="p_character">'outlook'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">has_option</span><span class="p_operator">(</span><span class="p_character">'Hosts'</span><span class="p_operator">,</span><span class="p_character">'remote'</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'Hosts'</span><span class="p_operator">,</span><span class="p_character">'remote'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;reading&nbsp;it&nbsp;again&nbsp;because&nbsp;of&nbsp;the&nbsp;way&nbsp;defaults&nbsp;are&nbsp;handled</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ConfigParser</span><span class="p_operator">.</span><span class="p_identifier">ConfigParser</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">read</span><span class="p_operator">(</span><span class="p_identifier">config_file</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#ConfigParser&nbsp;closes&nbsp;the&nbsp;file</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">has_section</span><span class="p_operator">(</span><span class="p_character">'Synchronization'</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">SYNC_TABLES</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">t</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">t</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">items</span><span class="p_operator">(</span><span class="p_character">'Synchronization'</span><span class="p_operator">)]</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">SYNC_TABLES</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_character">'follow_ups'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<div class="sidebar">
<p class="sidebar-title">A typical <em>List Manager.ini</em> file:</p>
<pre class="literal-block">
[Files]
path0 = wxLMDB:sqlite:mine
path1 = nycpsszatzsql:mysql:follow_ups

[Database]
db = listmanager

[Note]
ext = txt

[Synchronization]
sync2 = follow_ups
sync1 = test

[Hosts]
remote = nycpsszatzsql:mysql
local = wxLMDB:sqlite

[User]
startup_dialog = true
user = szatz
pw = python

[Mail]
outlook = true
path = wxLMDB:sqlite:mail_transfer

[Configuration]
y = 642
x = 975
</pre>
</div>
<p>Application uses the <tt class="literal"><span class="pre">ConfigParser</span></tt> module ito parse the ini file.  Unfortunately, <tt class="literal"><span class="pre">ConfigParser</span></tt> doesn't work exactly like I think it should although it has been improved in 2.3.  My main issue is in the handling of default options.  The default options specified through the constructor show up in every section.  For example, if you use the items(<em>section</em>) method
then in addition to returning a list of tuples with whatever option/value pairs exist in the section, the list will include all the default option/value pairs, which does not make a whole lot of sense to me.  At the least, there should be a 'nodefaults' argument whose default was <em>False</em> but which could be set to <em>True</em>.  The following methods should have this option:</p>
<ul class="simple">
<li>items</li>
<li>options</li>
<li>has_option</li>
</ul>
<p>In any event, because a nodefaults option does not exist, I create the ConfigParser object twice -- once with default options and once without them.</p>
<p>The application will work fine if there is no ini file. In an effort to save some typing but not be too obscure, many of the options are read such that they default to the correct value either through explicit defaults in the constructor or statements that evaluate to <em>None</em> or <em>False</em>.</p>
<blockquote>
<p><tt class="literal"><span class="pre">QUICK_LIST</span> <span class="pre">=</span> <span class="pre">cp.has_option('User','quicklist')</span> <span class="pre">and</span> <span class="pre">cp.get('User','quicklist')</span> <span class="pre">or</span> <span class="pre">None</span></tt></p>
<p><tt class="literal"><span class="pre">OUTLOOK</span> <span class="pre">=</span> <span class="pre">cp.has_option('Mail','outlook')</span> <span class="pre">and</span> <span class="pre">cp.getboolean('Mail,'outlook')</span></tt></p>
</blockquote>
</div>
</div>
<div class="section" id="class-listmanager">
<h2><a class="toc-backref" href="#id21" name="class-listmanager">class ListManager</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">ListManager</span><span class="p_operator">(</span><span class="p_identifier">wxFrame</span><span class="p_operator">):</span>
</div>
<p><strong>comments</strong>:</p>
<p>ListManager is the main class in the application and is a sublass of <tt class="literal"><span class="pre">wxFrame</span></tt>, which is typical for a wxPython application.  From a GUI standpoint, the main child window of the ListManager object is a <tt class="literal"><span class="pre">wxNoteBook</span></tt> object that holds one <tt class="literal"><span class="pre">wxListCtrl</span></tt> per notebook page and one <tt class="literal"><span class="pre">wxListBox</span></tt>.  The <tt class="literal"><span class="pre">wxListCtrl</span></tt>s display item information (e.g., name of the item, owners of the item, etc.) for a particular List and the <tt class="literal"><span class="pre">wxListBox</span></tt>es displays a list of owners that is used to filter the items displayed by the <tt class="literal"><span class="pre">wxListCtrl</span></tt> object.</p>
<p>Each <tt class="literal"><span class="pre">wxListCtrl</span></tt> object has its own set of events that it is hooked to (see CreateNewNotebookPage`&lt;&lt; ListControl Events &gt;&gt;`_.</p>
<div class="section" id="instantiation">
<h3><a class="toc-backref" href="#id22" name="instantiation">Instantiation</a></h3>
<p><strong>comments</strong>:</p>
<div class="section" id="def-init">
<h4><a class="toc-backref" href="#id23" name="def-init">def __init__</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxFrame</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetIcon</span><span class="p_operator">(</span><span class="p_identifier">wxIcon</span><span class="p_operator">(</span><span class="p_character">'bitmaps//wxpdemo.ico'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBITMAP_TYPE_ICO</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateStatusBar</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">ListManager</span><span class="p_default">&nbsp;</span><span class="p_identifier">Attributes</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Menu</span><span class="p_default">&nbsp;</span><span class="p_identifier">Setup</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Toolbar</span><span class="p_default">&nbsp;</span><span class="p_identifier">Setup</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Menu</span><span class="p_operator">/</span><span class="p_identifier">Toolbar</span><span class="p_default">&nbsp;</span><span class="p_identifier">Events</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Create</span><span class="p_default">&nbsp;</span><span class="p_identifier">Controls</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Layout</span><span class="p_default">&nbsp;</span><span class="p_identifier">Stuff</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Other</span><span class="p_default">&nbsp;</span><span class="p_identifier">Events</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">GUI</span><span class="p_default">&nbsp;</span><span class="p_identifier">Instance</span><span class="p_default">&nbsp;</span><span class="p_identifier">Objects</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Create</span><span class="p_default">&nbsp;</span><span class="p_identifier">Socket</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Load</span><span class="p_default">&nbsp;</span><span class="p_identifier">Recent</span><span class="p_default">&nbsp;</span><span class="p_identifier">Files</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Idle</span><span class="p_default">&nbsp;</span><span class="p_identifier">Timer</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ownerthread</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">threading</span><span class="p_operator">.</span><span class="p_identifier">Thread</span><span class="p_operator">(</span><span class="p_identifier">target</span><span class="p_operator">=</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">createownerlist</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ownerthread</span><span class="p_operator">.</span><span class="p_identifier">start</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>The ListManager <tt class="literal"><span class="pre">__init__</span></tt> method is pretty straightforward.  The <tt class="literal"><span class="pre">__init__</span></tt> arguments are the ones that need to be passed to <tt class="literal"><span class="pre">wxFrame</span> <span class="pre">__init__</span></tt> method. The wxFrame class has the following form:</p>
<blockquote>
<tt class="literal"><span class="pre">wxFrame(parent,</span> <span class="pre">id,</span> <span class="pre">title,</span> <span class="pre">pos=wxDefaultPosition,</span> <span class="pre">size=wxDefaultSize,</span> <span class="pre">style=wxDEFAULT_FRAME_STYLE,</span> <span class="pre">name=&quot;frame&quot;)</span></tt></blockquote>
<p>The default style (<tt class="literal"><span class="pre">wxDEFAULT_FRAME_STYLE</span></tt>) includes <tt class="literal"><span class="pre">wxMINIMIZE_BOX</span></tt>, <tt class="literal"><span class="pre">wxMAXIMIZE_BOX</span></tt>, <tt class="literal"><span class="pre">wxRESIZE_BORDER</span></tt>, <tt class="literal"><span class="pre">wxSYSTEM_MENU</span></tt>, <tt class="literal"><span class="pre">wxCAPTION</span></tt> (the latter is the text that appears in the title bar).</p>
<p><tt class="literal"><span class="pre">SetIcon</span></tt> is a method of <tt class="literal"><span class="pre">wxFrame</span></tt> that sets the icon in the upper left of the title bar of the frame.  The wxIcon class has the following form:</p>
<blockquote>
<tt class="literal"><span class="pre">wxIcon(filename,</span> <span class="pre">type,</span> <span class="pre">desiredWidth=-1,</span> <span class="pre">desiredHeight=-1)</span></tt></blockquote>
<p><tt class="literal"><span class="pre">CreateStatusBar</span></tt> is a method of <tt class="literal"><span class="pre">wxFrame</span></tt>. The wxPython form is:</p>
<blockquote>
<tt class="literal"><span class="pre">CreateStatusBar(number=1,</span> <span class="pre">style=0,</span> <span class="pre">id=-1)</span></tt></blockquote>
<dl>
<dt><em>number</em> --&gt;</dt>
<dd>number of fields to create. Specify a value greater than 1 to create a multi-field status bar.</dd>
</dl>
<p><tt class="literal"><span class="pre">CreateStatusBar</span></tt> needs to be called before &lt;&lt; Load Recent Files &gt;&gt;.</p>
<p>The various sections of <tt class="literal"><span class="pre">__init__</span></tt> are explained in their corresponding section:</p>
<pre class="literal-block">
&lt;&lt; ListManager Attributes &gt;&gt;
&lt;&lt; Menu Setup &gt;&gt;
&lt;&lt; Toolbar Setup &gt;&gt;
&lt;&lt; Menu/Toolbar Events &gt;&gt;
&lt;&lt; Create Controls&gt;&gt;
&lt;&lt; Layout Stuff &gt;&gt;
&lt;&lt; Other Events &gt;&gt;
&lt;&lt; GUI Instance Objects &gt;&gt;
&lt;&lt; Create Socket &gt;&gt;
&lt;&lt; Load Recent Files &gt;&gt;
</pre>
<div class="section" id="list-manager-attributes">
<h5><a class="toc-backref" href="#id24" name="list-manager-attributes">&lt;&lt; List Manager Attributes &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">printdata</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPrintData</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">printdata</span><span class="p_operator">.</span><span class="p_identifier">SetPaperId</span><span class="p_operator">(</span><span class="p_identifier">wxPAPER_LETTER</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">printdata</span><span class="p_operator">.</span><span class="p_identifier">SetOrientation</span><span class="p_operator">(</span><span class="p_identifier">wxPORTRAIT</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#self._options&nbsp;=&nbsp;{}&nbsp;#would&nbsp;be&nbsp;used&nbsp;in&nbsp;loadconfig</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">copyitems</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">tickler_active</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#there&nbsp;is&nbsp;a&nbsp;wxPanel&nbsp;in&nbsp;the&nbsp;AddListControl&nbsp;method&nbsp;so&nbsp;each&nbsp;wxListCtrl&nbsp;has&nbsp;a&nbsp;different&nbsp;panel&nbsp;as&nbsp;parent</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#there&nbsp;is&nbsp;a&nbsp;nb_sizer&nbsp;=&nbsp;wxNotebookSizer(nb)&nbsp;class&nbsp;but&nbsp;doesn't&nbsp;seem&nbsp;to&nbsp;make&nbsp;any&nbsp;difference</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">editor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">sqlite_connections</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">popupvisible</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">in_place_editor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">showrecentcompleted</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxFont</span><span class="p_operator">(</span><span class="p_number">9</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSWISS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">date_titles</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{</span><span class="p_character">'createdate'</span><span class="p_operator">:</span><span class="p_string">"Create&nbsp;Date"</span><span class="p_operator">,</span><span class="p_character">'duedate'</span><span class="p_operator">:</span><span class="p_string">"Due&nbsp;Date"</span><span class="p_operator">,</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_string">"Last&nbsp;Modified"</span><span class="p_operator">,</span><span class="p_character">'finisheddate'</span><span class="p_operator">:</span><span class="p_string">"Completion&nbsp;Date"</span><span class="p_operator">}</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{</span><span class="p_character">'priority'</span><span class="p_operator">:</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'name'</span><span class="p_operator">:</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_character">'owners'</span><span class="p_operator">:</span><span class="p_number">2</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'date'</span><span class="p_operator">:</span><span class="p_number">3</span><span class="p_operator">}</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindDialog</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">FindDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Find..."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EvalDialog</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">EvalDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Evaluate..."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_operator">)</span>
</div>
<p><strong>comments</strong>:</p>
<dl>
<dt>self.PropertyDicts</dt>
<dd>list of dictionaries that describe properties of each ListManager List (note that when referring to a collection of ListManager items a capital <em>L</em> List and table are used interchangeably).</dd>
<dt>self.ItemLists</dt>
<dd>list of lists that consist of instance objects of class <tt class="literal"><span class="pre">Item</span></tt>.  Each of the lists contained in self.ItemLists correspond to the items that are being displayed in the ListCtrl.  So <tt class="literal"><span class="pre">self.Itemlist[2]</span></tt> corresponds to the 2nd tab of the notebook and to the items in self.ListCtrls[2].</dd>
</dl>
<p>The class <tt class="literal"><span class="pre">Item</span></tt> is just an empty class being used as a convenience to hold item attributes:</p>
<pre class="literal-block">
class Item:
    pass
</pre>
<p>The purpose of the class is just to create an object that can have various attributes as follows:</p>
<table border class="table">
<colgroup>
<col width="25%" />
<col width="75%" />
</colgroup>
<tbody valign="top">
<tr><td>item.id</td>
<td>GUID</td>
</tr>
<tr><td>item.name</td>
<td>string that describes the item</td>
</tr>
<tr><td>item.priority</td>
<td>integer ranging from 1 (high) to 3 (low)</td>
</tr>
<tr><td>item.owners</td>
<td>list of the form [&quot;Zatz, Steve&quot;, &quot;Hoffman, Steve&quot;]</td>
</tr>
<tr><td>item.note</td>
<td>string that provides additional info on item</td>
</tr>
<tr><td>item.timestamp</td>
<td>timestamp indicating when an item was last modified</td>
</tr>
<tr><td>item.duedate</td>
<td>default is None; mx.DateTime date</td>
</tr>
<tr><td>item.createdate</td>
<td>mx.DateTime.now() mx.DateTime timestamp</td>
</tr>
<tr><td>item.finisheddate</td>
<td>efaut is None; mx.DateTime date</td>
</tr>
</tbody>
</table>
<dl>
<dt>self.ListCtrls</dt>
<dd>list of of instance objects of class ListCtrls, which are a subclass of wxPython class wxListCtrl.</dd>
<dt>self.OwnerLBoxes</dt>
<dd>list of of instance objects of wxPython class wxListBox, which is a simple one column List Control.</dd>
</dl>
<p>The wxPython constructor for a wxListBox is:</p>
<blockquote>
<tt class="literal"><span class="pre">wxListBox(parent,</span> <span class="pre">id,</span> <span class="pre">pos=wxDefaultPosition,</span> <span class="pre">size=wxDefaultSize,</span> <span class="pre">choices=[],</span> <span class="pre">style=0)</span></tt></blockquote>
<dl>
<dt>self.L</dt>
<dd>index of the currently active notebook tab.  If there are any tabs in the notebook then one of them is always selected.  If there are no tabs then this is indicated by setting <tt class="literal"><span class="pre">self.L</span> <span class="pre">=</span> <span class="pre">-1</span></tt>.</dd>
<dt>self.curIdx</dt>
<dd>currently selected row in the active <tt class="literal"><span class="pre">ListCtrl</span></tt>.  There are times like after a row is deleted in which there may be rows visible but no row is selected.</dd>
</dl>
<p>The following lines set the default printer data:</p>
<pre class="literal-block">
self.printdata = wxPrintData()
self.printdata.SetPaperId(wxPAPER_LETTER)
self.printdata.SetOrientation(wxPORTRAIT)
</pre>
<p>The wxPython class <tt class="literal"><span class="pre">wxPrintData</span></tt> holds a variety of information related to printers and printer device contexts. This class is used to create a wxPrinterDC and a wxPostScriptDC. It is also used as a data member of wxPrintDialogData and wxPageSetupDialogData, as part of the mechanism for transferring data between the print dialogs and the application.</p>
<dl>
<dt>self.copyitems</dt>
<dd>list that contains item instance objects that have been copied from one list to be moved to another list.</dd>
<dt>self.modified</dt>
<dd><p class="first">dictionary that contains the information concerning whether any of several elements have been changed.  Chose a dictionary more to test the idea that I could create a simple method that would update the dictionary and here is an example:</p>
<p class="last"><tt class="literal"><span class="pre">EVT_TEXT(self,</span> <span class="pre">self.name.GetId(),</span> <span class="pre">lambda</span> <span class="pre">e:</span> <span class="pre">self.modified.update({'name':1}))</span></tt></p>
</dd>
</dl>
<p>So this lambda function means that if an <tt class="literal"><span class="pre">EVT_TEXT</span></tt> event occurs then update the dictionary by adding the key to the dictionary (the value is not used and arbitrarily set to 1).  The wxPython form for the macro <tt class="literal"><span class="pre">EVT_TEXT</span></tt> is:</p>
<blockquote>
<tt class="literal"><span class="pre">EVT_TEXT(window,</span> <span class="pre">id,</span> <span class="pre">func)</span></tt></blockquote>
<p>A <tt class="literal"><span class="pre">wxEVT_COMMAND_TEXT_UPDATED</span></tt> event is generated when the text in a <tt class="literal"><span class="pre">wxTextCtrl</span></tt> changes and that is what <tt class="literal"><span class="pre">EVT_TEXT</span></tt> catches. Note that this event will always be sent when the text control‚Äôs content changes - whether this is due to user input or comes programmatically (for example, if <tt class="literal"><span class="pre">SetValue()</span></tt> is called)</p>
<dl>
<dt>self.Cursors</dt>
<dd>dictionary that holds the database cursor objects.  For example, it will look like:  <tt class="literal"><span class="pre">{'sqlite':&lt;sqlite</span> <span class="pre">cursor</span> <span class="pre">object&gt;,'nycpsltszatz':&lt;mysql</span> <span class="pre">cursor</span> <span class="pre">object&gt;}</span></tt></dd>
<dt>self.tickler_active</dt>
<dd>booean determines whether the tickler capabililty is active; can be shut off by unchecking Tickler menu item</dd>
<dt>self.editor</dt>
<dd><p class="first">list that holds the dictionaries that describe the notes that are edited by the external text editor:</p>
<pre class="last literal-block">
[
{
'table': 'mine',
'host': 'wxLMDB:sqlite',
'path': 'C:\\DOCUME~1\\STEVEN~1\\LOCALS~1\\Temp\\Journal Scan schedule.txt',
'id': '1AB34FB9-9EE6-4AFC-8AF0-FFCA50103BF3',
'time': 1070850894
}, 
{
'table': 'factoids',
'host': 'wxLMDB:sqlite',
'path': 'C:\\DOCUME~1\\STEVEN~1\\LOCALS~1\\Temp\\How many cme programs are sponsored- - 91%.txt', 
'id': '9CAC4D18-DE1C-4535-B9A5-4CDB1AD3F304', 
'time': 1070850908
}
]
</pre>
</dd>
</dl>
<p>The method that uses self.editor is <a class="reference" href="#check-if-edited-file-has-changed">&lt;&lt; Check if Edited File has Changed &gt;&gt;</a>.</p>
<p>There is a <tt class="literal"><span class="pre">wxPanel</span></tt> in the <tt class="literal"><span class="pre">AddListControl</span></tt> method so each <tt class="literal"><span class="pre">wxListCtrl</span></tt> has a different panel as parent.</p>
<p>There is a nb_sizer = wxNotebookSizer(nb) class but doesn't seem to make any difference.</p>
<dl>
<dt>self.sqlite_connections</dt>
<dd>Here because the sqlite connection has a weakreference that deletes it when you want it around</dd>
<dt>self.popupvisible</dt>
<dd>boolean that is used to ensure that two reminder popups aren't visible at the same time.</dd>
<dt>self.in_place_editor </dt>
<dd>boolean that indicates whether the inplace item name text editor is active or not.</dd>
<dt>self.showrecentcompleted</dt>
<dd>integer that determines the number of days in the past to retain completed items in the display.</dd>
<dt>self.LC_font</dt>
<dd>default font for all of the <tt class="literal"><span class="pre">ListCtrls</span></tt>:  <tt class="literal"><span class="pre">self.LC_font</span> <span class="pre">=</span> <span class="pre">wxFont(9,</span> <span class="pre">wxSWISS,</span> <span class="pre">wxNORMAL,</span> <span class="pre">wxNORMAL)</span></tt></dd>
</dl>
<p>The wxPython <tt class="literal"><span class="pre">wxFont</span></tt> constructor is:</p>
<blockquote>
<tt class="literal"><span class="pre">wxFont(pointSize,</span> <span class="pre">family,</span> <span class="pre">style,</span> <span class="pre">weight,</span> <span class="pre">underline=False,</span> <span class="pre">faceName=&quot;&quot;,</span> <span class="pre">wencoding=wxFONTENCODING_DEFAULT)</span></tt></blockquote>
<dl>
<dt>self.date_titles</dt>
<dd>dictionary that holds the various dates that are associated with each item and which can be displayed in the date column.  The dictionary is not modified.  We use one column of each <tt class="literal"><span class="pre">ListCtrl</span></tt> to display any one of the four dates that that the application tracks. This dictionary associates the item attribute with the text that will be displayed in both the column header for the date and in the dropdown that allows you to change the date:  <tt class="literal"><span class="pre">self.date_titles</span> <span class="pre">=</span> <span class="pre">{'createdate':&quot;Create</span> <span class="pre">Date&quot;,'duedate':&quot;Due</span> <span class="pre">Date&quot;,'timestamp':&quot;Last</span> <span class="pre">Modified&quot;,'finisheddate':&quot;Completion</span> <span class="pre">Date&quot;}</span></tt></dd>
<dt>self.attr2col_num</dt>
<dd>dictionary that associates the item attribute with the column that attribute is displayed in in the <tt class="literal"><span class="pre">ListCtrl</span></tt>:  <tt class="literal"><span class="pre">self.attr2col_num</span> <span class="pre">=</span> <span class="pre">{'priority':0,</span> <span class="pre">'name':1,'owners':2,</span> <span class="pre">'date':3}</span></tt></dd>
</dl>
<p>The following lines construct the Find Dialog and the Dialog that catches errors and shows expressions for debugging:</p>
<pre class="literal-block">
self.FindDialog = FindDialog(self, &quot;Find...&quot;, &quot;&quot;)
self.EvalDialog = EvalDialog(self, &quot;Evaluate...&quot;, &quot;&quot;)
</pre>
</div>
<div class="section" id="menu-setup">
<h5><a class="toc-backref" href="#id25" name="menu-setup">&lt;&lt; Menu Setup &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMenu</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idNEWLIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"New&nbsp;List..."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Create&nbsp;a&nbsp;new&nbsp;List"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idOPENLIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Open&nbsp;List..."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Open&nbsp;a&nbsp;List"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idCLOSELIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Close"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Close&nbsp;the&nbsp;current&nbsp;List"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idCLOSEALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Close&nbsp;All"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Close&nbsp;all&nbsp;open&nbsp;Lists"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idSAVEAS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Save&nbsp;As&nbsp;Text&nbsp;File..."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Save&nbsp;the&nbsp;current&nbsp;List"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idDELETELIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Delete&nbsp;List..."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Select&nbsp;a&nbsp;list&nbsp;to&nbsp;delete"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idPAGESETUP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Page&nbsp;Setup..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idPRINT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Print..."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Print&nbsp;the&nbsp;current&nbsp;view"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idPRINTPREV</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Print&nbsp;Preview"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idMAILLIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Mail..."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Mail&nbsp;the&nbsp;current&nbsp;view"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">AppendCheckItem</span><span class="p_operator">(</span><span class="p_identifier">idOFFLINE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Work&nbsp;Offline"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idEXIT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Exit"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Exit&nbsp;the&nbsp;program"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMenu</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idCUT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Cut\tCtrl+X"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idCOPY</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Copy\tCtrl+C"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idPASTE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Paste\tCtrl+V"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idDELETEITEMS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Delete"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idCOMBINEITEMS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Combine&nbsp;Items..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">editmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idFIND</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Find..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">itemmenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMenu</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">itemmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idNEWITEM</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"New&nbsp;Item"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">itemmenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">itemmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idTOGGLEFINISHED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Toggle&nbsp;Finished"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">itemmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idEDITOWNER</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Owner..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">itemmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idDUEDATE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Due&nbsp;Date..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">itemmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idEDITNOTE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Note..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">itemmenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">itemmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idMAILITEM</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Mail..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">displaymenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMenu</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">displaymenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idSHOWFINISHED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Show/Hide&nbsp;Finished..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">displaymenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">displaymenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idSHOWALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Show&nbsp;All"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Show&nbsp;all&nbsp;items&nbsp;in&nbsp;the&nbsp;current&nbsp;list"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">displaymenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">displaymenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idREFRESH</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Refresh&nbsp;Display"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Refresh&nbsp;the&nbsp;Display"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">displaymenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idDISPLAYDATE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Select&nbsp;Date&nbsp;to&nbsp;Display"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">toolmenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMenu</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">toolmenu</span><span class="p_operator">.</span><span class="p_identifier">AppendCheckItem</span><span class="p_operator">(</span><span class="p_identifier">idTICKLERACTIVE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Tickler&nbsp;Active"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">toolmenu</span><span class="p_operator">.</span><span class="p_identifier">Check</span><span class="p_operator">(</span><span class="p_identifier">idTICKLERACTIVE</span><span class="p_operator">,</span><span class="p_identifier">False</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">toolmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idSHOWNEXT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Show&nbsp;Next&nbsp;Reminder"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">toolmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idSYNC</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Synchronize&nbsp;local&nbsp;and&nbsp;remote&nbsp;DBs"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">toolmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idARCHIVE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Archive&nbsp;completed&nbsp;items&nbsp;in&nbsp;list..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">toolmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idEVALUATE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Evaluate&nbsp;an&nbsp;expression..."</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">helpmenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMenu</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">helpmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idABOUT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"About&nbsp;ListManager"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">helpmenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">idHELP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Help"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">menubar</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMenuBar</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">62</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">menubar</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">filemenu</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'&amp;File'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">63</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">menubar</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">editmenu</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Edit'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">64</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">menubar</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">itemmenu</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Item'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">65</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">menubar</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">displaymenu</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Display'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">66</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">menubar</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">toolmenu</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Tools'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">67</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">menubar</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">helpmenu</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Help'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">68</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetMenuBar</span><span class="p_operator">(</span><span class="p_identifier">menubar</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">69</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">toolmenu</span><span class="p_operator">.</span><span class="p_identifier">Enable</span><span class="p_operator">(</span><span class="p_identifier">idSHOWNEXT</span><span class="p_operator">,</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">tickler_active</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">70</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Enable</span><span class="p_operator">(</span><span class="p_identifier">idDELETELIST</span><span class="p_operator">,</span><span class="p_identifier">DELETE_LIST</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">71</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Check</span><span class="p_operator">(</span><span class="p_identifier">idOFFLINE</span><span class="p_operator">,</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">72</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">73</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#file&nbsp;history</span><span class="p_default"><br/>
</span><span class="p_number">74</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">filehistory</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxFileHistory</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">75</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">filehistory</span><span class="p_operator">.</span><span class="p_identifier">UseMenu</span><span class="p_operator">(</span><span class="p_identifier">filemenu</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">76</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<table border class="table">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<tbody valign="top">
<tr><td><strong>File Menu</strong></td>
<td>&nbsp;</td>
</tr>
<tr><td>&quot;New List... &quot;</td>
<td><img alt="nl" src="images/newlist.html" /> <tt class="literal"><span class="pre">self.OnNewList</span></tt></td>
</tr>
<tr><td>&quot;Open List...&quot;</td>
<td><img alt="ol" src="images/openlist.html" /> <tt class="literal"><span class="pre">self.OnOpenList</span></tt></td>
</tr>
<tr><td>&quot;Close&quot;</td>
<td><tt class="literal"><span class="pre">self.OnCloseList</span></tt></td>
</tr>
<tr><td>&quot;Close All&quot;</td>
<td><tt class="literal"><span class="pre">self.OnCloseAll</span></tt></td>
</tr>
<tr><td>&quot;Save As Text File...&quot;</td>
<td><tt class="literal"><span class="pre">self.OnSaveAsText</span></tt></td>
</tr>
<tr><td>&quot;Delete List...&quot;</td>
<td><img alt="de" src="images/delete.html" /> <tt class="literal"><span class="pre">self.OnDeleteList</span></tt></td>
</tr>
<tr><td>&quot;Page Setup...&quot;</td>
<td><img alt="ps" src="images/page_setup.html" /> <tt class="literal"><span class="pre">self.OnPageSetup</span></tt></td>
</tr>
<tr><td>&quot;Print...&quot;</td>
<td><img alt="pt" src="images/print.html" /> <tt class="literal"><span class="pre">self.OnPrint</span></tt></td>
</tr>
<tr><td>&quot;Print Preview&quot;</td>
<td><img alt="pp" src="images/printprev.html" /> <tt class="literal"><span class="pre">lambda</span> <span class="pre">e:</span> <span class="pre">self.OnPrint(e,</span> <span class="pre">prev=True)</span></tt></td>
</tr>
<tr><td>&quot;Mail...&quot;</td>
<td><tt class="literal"><span class="pre">self.OnMailView</span></tt></td>
</tr>
<tr><td>&quot;Work Offline&quot;</td>
<td><tt class="literal"><span class="pre">self.OnWorkOffline</span></tt></td>
</tr>
<tr><td>&quot;Exit&quot;</td>
<td><tt class="literal"><span class="pre">self.OnExit</span></tt></td>
</tr>
<tr><td><strong>Edit Menu</strong></td>
<td>&nbsp;</td>
</tr>
<tr><td>&quot;Cut&quot; [Ctrl+X ]</td>
<td><img alt="ec" src="images/editcut.html" /> <tt class="literal"><span class="pre">lambda</span> <span class="pre">e:</span> <span class="pre">self.OnCopyItems(e,</span> <span class="pre">cut=True)</span></tt></td>
</tr>
<tr><td>&quot;Copy&quot; [Ctrl+C]</td>
<td><img alt="ey" src="images/editcopy.html" /> <tt class="literal"><span class="pre">self.OnCopyItems</span></tt></td>
</tr>
<tr><td>&quot;Paste&quot; [Ctrl+V]</td>
<td><img alt="ep" src="images/editpaste.html" /> <tt class="literal"><span class="pre">self.OnPasteItems</span></tt></td>
</tr>
<tr><td>&quot;Delete&quot;</td>
<td><img alt="de" src="images/delete.html" /> <tt class="literal"><span class="pre">self.OnDeleteItems</span></tt></td>
</tr>
<tr><td>&quot;Combine Items...&quot;</td>
<td><tt class="literal"><span class="pre">self.OnCombineItems</span></tt></td>
</tr>
<tr><td>&quot;Find...&quot;</td>
<td><img alt="fi" src="images/find.html" /> <tt class="literal"><span class="pre">self.OnFind</span></tt></td>
</tr>
<tr><td><strong>Item Menu</strong></td>
<td>&nbsp;</td>
</tr>
<tr><td>&quot;New Item&quot;</td>
<td><img alt="ni" src="images/new_item.html" /> <tt class="literal"><span class="pre">self.OnNewItem</span></tt></td>
</tr>
<tr><td>&quot;Toggle Finished&quot;</td>
<td><img alt="co" src="images/complete.html" /> <tt class="literal"><span class="pre">self.OnToggleFinished</span></tt></td>
</tr>
<tr><td>&quot;Owner...&quot;</td>
<td><img alt="ow" src="images/owners.html" /> <tt class="literal"><span class="pre">self.OnEditOwner</span></tt></td>
</tr>
<tr><td>&quot;Due Date...&quot;</td>
<td><img alt="dd" src="images/duedate.html" /> <tt class="literal"><span class="pre">self.OnDueDate</span></tt></td>
</tr>
<tr><td>&quot;Note...&quot;</td>
<td><img alt="en" src="images/edit_note.html" /> <tt class="literal"><span class="pre">self.OnEditNote</span></tt></td>
</tr>
<tr><td>&quot;Mail...&quot;</td>
<td><img alt="mi" src="images/mail_item.html" /> <tt class="literal"><span class="pre">self.OnMailItem</span></tt></td>
</tr>
<tr><td><strong>Display Menu</strong></td>
<td>&nbsp;</td>
</tr>
<tr><td>&quot;Show/Hide Finished...&quot;</td>
<td><tt class="literal"><span class="pre">self.OnShowFinished</span></tt></td>
</tr>
<tr><td>&quot;Show All&quot;</td>
<td><tt class="literal"><span class="pre">self.OnShowAll</span></tt></td>
</tr>
<tr><td>&quot;Refresh Display&quot;</td>
<td><img alt="re" src="images/refresh.html" /> <tt class="literal"><span class="pre">self.OnRefresh</span></tt></td>
</tr>
<tr><td>&quot;Select Date to Display&quot;</td>
<td><tt class="literal"><span class="pre">self.OnDisplayDateCategory</span></tt></td>
</tr>
<tr><td><strong>Tool Menu</strong></td>
<td>&nbsp;</td>
</tr>
<tr><td>&quot;Tickler Active&quot;</td>
<td><tt class="literal"><span class="pre">self.OnActivateTickler</span></tt></td>
</tr>
<tr><td>&quot;Show Next Reminder&quot;</td>
<td><tt class="literal"><span class="pre">self.OnShowTickler</span></tt></td>
</tr>
<tr><td>&quot;Synchronize ...&quot;</td>
<td><tt class="literal"><span class="pre">self.OnSync</span></tt></td>
</tr>
<tr><td>&quot;Archive completed...&quot;</td>
<td><tt class="literal"><span class="pre">self.OnArchive</span></tt></td>
</tr>
<tr><td>&quot;Evaluate expression&quot;</td>
<td><tt class="literal"><span class="pre">self.OnShowEvaluate</span></tt></td>
</tr>
<tr><td><strong>Help Menu</strong></td>
<td>&nbsp;</td>
</tr>
<tr><td>&quot;About ListManager&quot;</td>
<td><tt class="literal"><span class="pre">self.OnShowAbout</span></tt></td>
</tr>
<tr><td>&quot;Help&quot;</td>
<td><tt class="literal"><span class="pre">self.OnShowHelp</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="toolbar-setup">
<h5><a class="toc-backref" href="#id26" name="toolbar-setup">&lt;&lt; Toolbar Setup &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateToolBar</span><span class="p_operator">(</span><span class="p_identifier">wxTB_HORIZONTAL</span><span class="p_operator">|</span><span class="p_identifier">wxTB_FLAT</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idNEWLIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"New&nbsp;(local)&nbsp;List"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\new.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Create&nbsp;New&nbsp;List"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idOPENLIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Open"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\open.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Open&nbsp;List"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idTOOLPRINT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Print"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\print.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Print&nbsp;List"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idPRINTPREV</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Preview"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\preview.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Print&nbsp;Preview"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idPAGESETUP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Setup"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\setup.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Page&nbsp;Setup"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idNEWITEM</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"New&nbsp;Item"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\new_item.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Create&nbsp;New&nbsp;Item"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idREFRESH</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Refresh"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\refresh.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Refresh&nbsp;Display"</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idEDITNOTE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Edit&nbsp;Note"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\edit_doc.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Edit&nbsp;Note"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idFIND</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Find"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\find.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Find&nbsp;Item"</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idCUT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Cut"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\editcut.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_string">"Cut&nbsp;Item"</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idCOPY</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Copy"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\copy.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_string">"Copy&nbsp;Item"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idPASTE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Paste"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\paste.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Paste&nbsp;Item"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idTOGGLEFINISHED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Toggle&nbsp;Date"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\filledbox.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Toggle&nbsp;Finished&nbsp;Date"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idDELETEITEMS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Delete"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\delete.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Delete&nbsp;Item"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idDUEDATE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Due&nbsp;Date"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\calendar.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Enter&nbsp;Due&nbsp;Date"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idEDITOWNER</span><span class="p_operator">,</span><span class="p_string">"Owner"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\owners.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Select&nbsp;Owner(s)"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idMAILITEM</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Mail"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\mail.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Mail&nbsp;Item"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">QUICK_LIST</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">AddLabelTool</span><span class="p_operator">(</span><span class="p_identifier">idSENDTO</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Send&nbsp;to"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\sendto.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">shortHelp</span><span class="p_operator">=</span><span class="p_string">"Send&nbsp;to&nbsp;%s"</span><span class="p_operator">%</span><span class="p_identifier">QUICK_LIST</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">Realize</span><span class="p_operator">()</span>
</div>
<p><strong>comments</strong>:</p>
<p><img alt="images\toolbar.gif" src="images/toolbar.html" /></p>
<table border class="table">
<colgroup>
<col width="8%" />
<col width="30%" />
<col width="62%" />
</colgroup>
<tbody valign="top">
<tr><td><img alt="nl" src="images/newlist.html" /></td>
<td>Creates a new List</td>
<td><tt class="literal"><span class="pre">self.OnNewList</span></tt></td>
</tr>
<tr><td><img alt="ol" src="images/openlist.html" /></td>
<td>Open an existing List</td>
<td><tt class="literal"><span class="pre">self.OnOpenList</span></tt></td>
</tr>
<tr><td><img alt="pt" src="images/print.html" /></td>
<td>Print</td>
<td><tt class="literal"><span class="pre">lambda</span> <span class="pre">e:</span> <span class="pre">self.OnPrint(e,showprtdlg=False))</span></tt></td>
</tr>
<tr><td><img alt="pp" src="images/printprev.html" /></td>
<td>Print Preview</td>
<td><tt class="literal"><span class="pre">lambda</span> <span class="pre">e:</span> <span class="pre">self.OnPrint(e,</span> <span class="pre">prev=True))</span></tt></td>
</tr>
<tr><td><img alt="ps" src="images/page_setup.html" /></td>
<td>Page Setup</td>
<td><tt class="literal"><span class="pre">self.OnPageSetup</span></tt></td>
</tr>
<tr><td><img alt="ni" src="images/new_item.html" /></td>
<td>New Item</td>
<td><tt class="literal"><span class="pre">self.OnNewItem</span></tt></td>
</tr>
<tr><td><img alt="re" src="images/refresh.html" /></td>
<td>Refresh</td>
<td><tt class="literal"><span class="pre">self.OnRefresh</span></tt></td>
</tr>
<tr><td><img alt="en" src="images/edit_note.html" /></td>
<td>Edit Note</td>
<td><tt class="literal"><span class="pre">self.OnEditNote</span></tt></td>
</tr>
<tr><td><img alt="fi" src="images/find.html" /></td>
<td>Find</td>
<td><tt class="literal"><span class="pre">self.OnFind</span></tt></td>
</tr>
<tr><td><img alt="ec" src="images/editcut.html" /></td>
<td>Cut</td>
<td><tt class="literal"><span class="pre">lambda</span> <span class="pre">e:</span> <span class="pre">self.OnCopyItems(e,</span> <span class="pre">cut=True))</span></tt></td>
</tr>
<tr><td><img alt="ey" src="images/editcopy.html" /></td>
<td>Copy</td>
<td><tt class="literal"><span class="pre">self.OnCopyItems</span></tt></td>
</tr>
<tr><td><img alt="ep" src="images/editpaste.html" /></td>
<td>Paste</td>
<td><tt class="literal"><span class="pre">self.OnPasteItems</span></tt></td>
</tr>
<tr><td><img alt="co" src="images/complete.html" /></td>
<td>Toggle Finished</td>
<td><tt class="literal"><span class="pre">self.OnToggleFinished</span></tt></td>
</tr>
<tr><td><img alt="de" src="images/delete.html" /></td>
<td>Delete Item</td>
<td><tt class="literal"><span class="pre">self.OnDeleteItems</span></tt></td>
</tr>
<tr><td><img alt="dd" src="images/duedate.html" /></td>
<td>Set Item Due Date</td>
<td><tt class="literal"><span class="pre">self.OnDueDate</span></tt></td>
</tr>
<tr><td><img alt="ow" src="images/owners.html" /></td>
<td>Set Item Owners</td>
<td><tt class="literal"><span class="pre">self.OnEditOwner</span></tt></td>
</tr>
<tr><td><img alt="mi" src="images/mail_item.html" /></td>
<td>Mail Item</td>
<td><tt class="literal"><span class="pre">self.OnMailItem</span></tt></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="menu-toolbar-events">
<h5><a class="toc-backref" href="#id27" name="menu-toolbar-events">&lt;&lt; Menu/Toolbar Events &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#File&nbsp;Menu&nbsp;------------------------------------</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idNEWLIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnNewList</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idOPENLIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnOpenList</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idCLOSELIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCloseList</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idCLOSEALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCloseAll</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idSAVEAS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnSaveAsText</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idDELETELIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnDeleteList</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idPAGESETUP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPageSetup</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idPRINT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPrint</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idPRINTPREV</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPrint</span><span class="p_operator">(</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">prev</span><span class="p_operator">=</span><span class="p_identifier">True</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idOFFLINE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnWorkOffline</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idMAILLIST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnMailView</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU_RANGE</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_FILE1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_FILE9</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnFileList</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idEXIT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnExit</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Edit&nbsp;Menu&nbsp;------------------------------------</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idCUT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCopyItems</span><span class="p_operator">(</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cut</span><span class="p_operator">=</span><span class="p_identifier">True</span><span class="p_operator">))</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idCOPY</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCopyItems</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idPASTE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPasteItems</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idDELETEITEMS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnDeleteItems</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idCOMBINEITEMS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCombineItems</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idFIND</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnFind</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#item&nbsp;Menu&nbsp;------------------------------------</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idNEWITEM</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnNewItem</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idTOGGLEFINISHED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnToggleFinished</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idDUEDATE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnDueDate</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idEDITOWNER</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnEditOwner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idEDITNOTE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnEditNote</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idMAILITEM</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnMailItem</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Dips&nbsp;Menu&nbsp;------------------------------------</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idSHOWFINISHED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnShowFinished</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idSHOWALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnShowAll</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idREFRESH</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnRefresh</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idDISPLAYDATE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnDisplayDateCategory</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Tool&nbsp;Menu&nbsp;---------------------------------------</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idTICKLERACTIVE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnActivateTickler</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idSHOWNEXT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnShowTickler</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idSYNC</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnSync</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idARCHIVE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnArchive</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idEVALUATE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnShowEvaluate</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Help&nbsp;Menu&nbsp;-----------------------------------------</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idABOUT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnShowAbout</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idHELP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnShowHelp</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_TOOL</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idTOOLPRINT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPrint</span><span class="p_operator">(</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_identifier">showprtdlg</span><span class="p_operator">=</span><span class="p_identifier">False</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">QUICK_LIST</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_TOOL</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">idSENDTO</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnMoveToSpecificList</span><span class="p_operator">(</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_identifier">QUICK_LIST</span><span class="p_operator">))</span>
</div>
<p><strong>comments</strong>:</p>
<p>(see toolbar table above)</p>
<p>Note about the use of lambda functions in <tt class="literal"><span class="pre">EVT</span></tt> macros:</p>
<blockquote>
<p>When an event occurs, it sends an event object to the method that the event is connected to through the <tt class="literal"><span class="pre">EVT</span></tt> macro.  If we want to have several <tt class="literal"><span class="pre">EVT</span></tt> macros connect to the same method with different arguments then one way to accomplish that is to use a lambda function.  Instead of calling the a method directly with the event object as an argument, the lambda function will be called (with the event object argument) and the action of the lambda function will be to call the method in question with whatever additional arguments are specified.  For example:</p>
<pre class="literal-block">
EVT_MENU(self, idPRINTPREV, lambda e: self.OnPrint(e, prev=True))
</pre>
<p>The method <tt class="literal"><span class="pre">OnPrint</span></tt> is the callback for both the Print event and the Print Preview event and by using a lambda function, we can pass an additional argument to the method (in this case setting the additional argument <em>prev</em> to True).</p>
</blockquote>
<p>Printing by clicking the print icon in the Toolbar <img alt="pt" src="images/print.html" /> doesn't bring up a dialog it just prints to the default printer and that is why there is a separate <tt class="literal"><span class="pre">EVT_TOOL</span></tt> macro with an <tt class="literal"><span class="pre">idTOOLPRINT</span></tt> id:</p>
<pre class="literal-block">
EVT_TOOL(self, idTOOLPRINT, lambda e: self.OnPrint(e,showprtdlg=False))
</pre>
</div>
<div class="section" id="create-controls">
<h5><a class="toc-backref" href="#id28" name="create-controls">&lt;&lt; Create Controls&gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">upper_panel</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPanel</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#size&nbsp;=&nbsp;(900,400)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">bottom_panel</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPanel</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">900</span><span class="p_operator">,</span><span class="p_number">150</span><span class="p_operator">))</span><span class="p_default">&nbsp;</span><span class="p_commentline">#900&nbsp;note&nbsp;that&nbsp;000&nbsp;seems&nbsp;to&nbsp;work???</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">nb</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNotebook</span><span class="p_operator">(</span><span class="p_identifier">upper_panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">900</span><span class="p_operator">,</span><span class="p_number">500</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxNB_BOTTOM</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxFont</span><span class="p_operator">(</span><span class="p_number">10</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSWISS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">bottom_panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">285</span><span class="p_operator">,</span><span class="p_number">42</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTE_MULTILINE</span><span class="p_operator">|</span><span class="p_identifier">wxTE_RICH2</span><span class="p_operator">)</span><span class="p_commentline">#34&nbsp;#wxTE_PROCESS_ENTER</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">SetDefaultStyle</span><span class="p_operator">(</span><span class="p_identifier">wxTextAttr</span><span class="p_operator">(</span><span class="p_string">"BLACK"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">font</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">bottom_panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">250</span><span class="p_operator">,</span><span class="p_number">42</span><span class="p_operator">),</span><span class="p_identifier">style</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTE_MULTILINE</span><span class="p_operator">|</span><span class="p_identifier">wxTE_RICH2</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">SetDefaultStyle</span><span class="p_operator">(</span><span class="p_identifier">wxTextAttr</span><span class="p_operator">(</span><span class="p_string">"BLACK"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">font</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">bottom_panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">400</span><span class="p_operator">,</span><span class="p_number">50</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxTE_MULTILINE</span><span class="p_operator">)</span>
</div>
<p><strong>comments</strong>:</p>
<p>The <tt class="literal"><span class="pre">wxFrame</span></tt> has two <tt class="literal"><span class="pre">wxPanels</span></tt>:  <em>upper_panel</em> will contain the notebook.  The <em>bottom_panel</em> will contain the various item textctrls including name, owners and note.</p>
</div>
<div class="section" id="other-events">
<h5><a class="toc-backref" href="#id29" name="other-events">&lt;&lt; Other Events &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_TEXT</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">.</span><span class="p_identifier">update</span><span class="p_operator">({</span><span class="p_character">'name'</span><span class="p_operator">:</span><span class="p_number">1</span><span class="p_operator">}))</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_TEXT</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">.</span><span class="p_identifier">update</span><span class="p_operator">({</span><span class="p_character">'note'</span><span class="p_operator">:</span><span class="p_number">1</span><span class="p_operator">}))</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_TEXT</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">.</span><span class="p_identifier">update</span><span class="p_operator">({</span><span class="p_character">'owners'</span><span class="p_operator">:</span><span class="p_number">1</span><span class="p_operator">}))</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_CLOSE</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnWindowExit</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_IDLE</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnIdle</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>The <tt class="literal"><span class="pre">EVT_TEXT</span></tt> event macros indicate whether a particular textctrl has changed.</p>
<p><tt class="literal"><span class="pre">EVT_CLOSE(self,</span> <span class="pre">self.OnWindowExit)</span></tt> is used to record settings and cleanup on exiting</p>
<p><tt class="literal"><span class="pre">EVT_IDLE(self,</span> <span class="pre">self.OnIdle)</span></tt> --&gt; Idle events used for checking text files and transfers from Outlook</p>
<p>There are also a number of events related to the individual ListCtrls that are placed on Notebook pages <a class="reference" href="#listcontrol-events">&lt;&lt; ListControl Events &gt;&gt;</a>.</p>
</div>
<div class="section" id="layout-stuff">
<h5><a class="toc-backref" href="#id30" name="layout-stuff">&lt;&lt; Layout Stuff &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#Appears&nbsp;necessary&nbsp;to&nbsp;really&nbsp;get&nbsp;the&nbsp;listcontrol&nbsp;to&nbsp;size&nbsp;with&nbsp;the&nbsp;overall&nbsp;window&nbsp;&nbsp;</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#upper_panel&nbsp;sizer</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">nb</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">wxALIGN_LEFT</span><span class="p_operator">|</span><span class="p_identifier">wxEXPAND</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">upper_panel</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#sizer&nbsp;for&nbsp;the&nbsp;row&nbsp;of&nbsp;data&nbsp;items</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">wxEXPAND</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#bottom_panel&nbsp;sizer&nbsp;&nbsp;</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">wxALIGN_LEFT</span><span class="p_operator">|</span><span class="p_identifier">wxEXPAND</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">bottom_panel</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">upper_panel</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">wxALIGN_TOP</span><span class="p_operator">|</span><span class="p_identifier">wxEXPAND</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">bottom_panel</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_identifier">wxALIGN_TOP</span><span class="p_operator">|</span><span class="p_identifier">wxEXPAND</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetAutoLayout</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#sizer.Fit(self)&nbsp;#actively&nbsp;does&nbsp;bad&nbsp;things&nbsp;to&nbsp;the&nbsp;dimensions&nbsp;on&nbsp;startup</span>
</div>
<p><strong>comments</strong>:</p>
<!-- Not sure I have the strength but will discuss sizers here.  The basis use of sizers is pretty straightforward in my opinion, however, what is wildly hard to remember are the meaning of the parameters in the sizer Add method. -->
<p>The parent of the <tt class="literal"><span class="pre">wxPanel</span></tt> object <em>upper_panel</em> is the <em>ListManager</em>, which is a subclass of <tt class="literal"><span class="pre">wxFrame</span></tt>.  The parent of <tt class="literal"><span class="pre">wxNotebook</span></tt> object <em>nb</em> is <em>upper_panel</em>.  Since the only child of <em>upper_panel</em> is the <em>nb</em> it wasn't obvious to me that a sizer was needed but apparently without it the <tt class="literal"><span class="pre">wxListCtrl</span></tt> that will be a child of the wxPanel of <em>nb</em> won't size right if we don't do it this was.</p>
<pre class="literal-block">
Frame ---&gt; upper_panel ---&gt; notebook ---&gt; panel (for each page) ---&gt; listctrl
  |                                                             |            } one on each page
  ---&gt; lower_panel ---&gt; variety of textctrls                    ---&gt; listbox
</pre>
</div>
<div class="section" id="gui-instance-objects">
<h5><a class="toc-backref" href="#id31" name="gui-instance-objects">&lt;&lt; GUI Instance Objects &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">toolmenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">toolmenu</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">filemenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">filemenu</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">nb</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">tb</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">tb</span>
</div>
<p><strong>comments</strong>:</p>
<p>No comments yet.</p>
</div>
<div class="section" id="create-socket">
<h5><a class="toc-backref" href="#id32" name="create-socket">&lt;&lt; Create Socket &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">OUTLOOK</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">s</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">socket</span><span class="p_operator">.</span><span class="p_identifier">socket</span><span class="p_operator">(</span><span class="p_identifier">socket</span><span class="p_operator">.</span><span class="p_identifier">AF_INET</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">socket</span><span class="p_operator">.</span><span class="p_identifier">SOCK_STREAM</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;Create&nbsp;a&nbsp;TCP&nbsp;socket</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">s</span><span class="p_operator">.</span><span class="p_identifier">bind</span><span class="p_operator">((</span><span class="p_character">'localhost'</span><span class="p_operator">,</span><span class="p_number">8888</span><span class="p_operator">))</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;Bind&nbsp;to&nbsp;port&nbsp;8888</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">s</span><span class="p_operator">.</span><span class="p_identifier">listen</span><span class="p_operator">(</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;Listen,&nbsp;but&nbsp;allow&nbsp;no&nbsp;more&nbsp;than</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">sock</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">s</span>
</div>
<p><strong>comments</strong>:</p>
<p>No comment</p>
</div>
<div class="section" id="load-recent-files">
<h5><a class="toc-backref" href="#id33" name="load-recent-files">&lt;&lt; Load Recent Files &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pathlist</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">f</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">items</span><span class="p_operator">(</span><span class="p_character">'Files'</span><span class="p_operator">)]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pathlist</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">pathlist</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pathlist</span><span class="p_operator">.</span><span class="p_identifier">sort</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pathlist</span><span class="p_operator">.</span><span class="p_identifier">reverse</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">path</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">pathlist</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">:]:</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnFileList</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">=</span><span class="p_identifier">path</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#don't&nbsp;want&nbsp;to&nbsp;trigger&nbsp;the&nbsp;page&nbsp;change&nbsp;event&nbsp;until&nbsp;n-1&nbsp;of&nbsp;n&nbsp;files&nbsp;are&nbsp;loaded</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_NOTEBOOK_PAGE_CHANGED</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPageChange</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnFileList</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">=</span><span class="p_identifier">pathlist</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_NOTEBOOK_PAGE_CHANGED</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPageChange</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p><tt class="literal"><span class="pre">pathlist</span> <span class="pre">=</span> <span class="pre">[f[1]</span> <span class="pre">for</span> <span class="pre">f</span> <span class="pre">in</span> <span class="pre">cp.items('Files')]</span></tt></p>
<p>This uses the new in 2.3 <tt class="literal"><span class="pre">ConfigParser</span></tt> method <tt class="literal"><span class="pre">items</span></tt>.  This will not work unless ConfigParser has been constructed without any defaults and so a ConfigParser object is created twice.</p>
<p>The only remotely subtle thing here is that we don't want to execute the <tt class="literal"><span class="pre">EVT_NOTEBOOK_PAGE_CHANGED</span></tt> statement while we're doing the initial loading of files since it does unnecessary processing.  The statement is executed before the last file is loaded.</p>
</div>
<div class="section" id="idle-timer">
<h5><a class="toc-backref" href="#id34" name="idle-timer">&lt;&lt; Idle Timer &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">ID_TIMER</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNewId</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">timer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTimer</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">ID_TIMER</span><span class="p_operator">)</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_TIMER</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">ID_TIMER</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnIdle</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">timer</span><span class="p_operator">.</span><span class="p_identifier">Start</span><span class="p_operator">(</span><span class="p_number">3000</span><span class="p_operator">)</span>
</div>
<p><strong>comments</strong>:</p>
<p>Need to figure out exactly what this timer is doing.</p>
</div>
</div>
</div>
<div class="section" id="ownerlist-creation-methods-used-by-thread">
<h3><a class="toc-backref" href="#id35" name="ownerlist-creation-methods-used-by-thread">Ownerlist creation methods (used by thread)</a></h3>
<p><strong>comments</strong>:</p>
<p>No comment.</p>
<div class="section" id="def-createownerlist">
<h4><a class="toc-backref" href="#id36" name="def-createownerlist">def createownerlist</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">createownerlist</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">REMOTE_HOST</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SHOW&nbsp;TABLES"</span><span class="p_default">&nbsp;</span><span class="p_commentline">#sorted</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">LOCAL_HOST</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SELECT&nbsp;name&nbsp;FROM&nbsp;sqlite_master&nbsp;WHERE&nbsp;type='table'&nbsp;ORDER&nbsp;BY&nbsp;name"</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">sql</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#excluding&nbsp;'system'&nbsp;tables&nbsp;and&nbsp;archive&nbsp;tables</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">excluded_tables</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_character">'user_sync'</span><span class="p_operator">,</span><span class="p_character">'sync'</span><span class="p_operator">,</span><span class="p_character">'owners'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tables</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">t</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">t</span><span class="p_operator">,)</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">t</span><span class="p_operator">.</span><span class="p_identifier">find</span><span class="p_operator">(</span><span class="p_character">'_archive'</span><span class="p_operator">)==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">t</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">excluded_tables</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">tables</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql_list</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_tripledouble">"""SELECT&nbsp;owner1&nbsp;FROM&nbsp;%s&nbsp;UNION&nbsp;SELECT&nbsp;owner2&nbsp;FROM&nbsp;%s&nbsp;UNION&nbsp;SELECT&nbsp;owner3&nbsp;FROM&nbsp;%s"""</span><span class="p_operator">%((</span><span class="p_identifier">table</span><span class="p_operator">,)*</span><span class="p_number">3</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"&nbsp;UNION&nbsp;"</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">sql_list</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">sql</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">x</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_character">''</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">_list</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">_list</span><span class="p_operator">.</span><span class="p_identifier">remove</span><span class="p_operator">(</span><span class="p_character">''</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">_list</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">_list</span><span class="p_operator">.</span><span class="p_identifier">remove</span><span class="p_operator">(</span><span class="p_word">None</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">_list</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#posting&nbsp;custom&nbsp;event&nbsp;to&nbsp;signal&nbsp;that&nbsp;this&nbsp;thread&nbsp;is&nbsp;done</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">evt</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPyEvent</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">evt_id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNewEventType</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">SetEventType</span><span class="p_operator">(</span><span class="p_identifier">evt_id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Connect</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt_id</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">createownerdialog</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxPostEvent</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>This method grabs the owners from many of the tables to create a list of possile owners for each item.  The alternative is actually to create a separate owner table but it seemed to make sense to just construct the owners on the fly from the various List databases.  This is done in a thread so no matter how long it takes to construct the owners it doesn't slow the appearance of the GUI.  The result of this method is the contruction of the instance variable <em>self._list</em>.</p>
<p>The most interesting thing here is creating a custom event (without needing to create an event macro) to signal that this thread is done:</p>
<pre class="literal-block">
evt = wxPyEvent()
evt_id = wxNewEventType()
evt.SetEventType(evt_id)
self.Connect(-1, -1, evt_id, self.createownerdialog)
wxPostEvent(self, evt)
</pre>
<p>The code above is adapted from the more general <tt class="literal"><span class="pre">wxCallAfter</span></tt>, which I could have used but just wanted to explicitly show the steps involved in creating a custom event, associating it with a callback and posting it.</p>
<p>The general point is that if you want to notify the main GUI thread of something going on in a non-GUI thread, posting events is an easy way to do it whether you use the code above, the more complete wxCallAfter (see below) from which it was derived or actually create your own custom event macro (farther below).</p>
<p>The code for <tt class="literal"><span class="pre">wxCallAfter</span></tt> is:</p>
<pre class="literal-block">
def wxCallAfter(callable, *args, **kw):
     &quot;&quot;&quot;
     Call the specified function after the current and pending event
     handlers have been completed.  This is also good for making GUI
     method calls from non-GUI threads.
     &quot;&quot;&quot;
     app = wxGetApp()
     assert app, 'No wxApp created yet'

     global _wxCallAfterId
     if _wxCallAfterId is None:
         _wxCallAfterId = wxNewEventType()
         app.Connect(-1, -1, _wxCallAfterId,
               lambda event: event.callable(*event.args, **event.kw) )
     evt = wxPyEvent()
     evt.SetEventType(_wxCallAfterId)
     evt.callable = callable
     evt.args = args
     evt.kw = kw
     wxPostEvent(app, evt)
</pre>
<p>Unless you want multiple handlers to be able to respond to a custom event (by using evt.Skip()) or just want custom event macros that are like native event macros there doesn't seem to be much need to create full-blown custom events.  If you do need to, here is how it is done:</p>
<pre class="literal-block">
wxEVT_THREAD_DONE = wxNewEventType()

def EVT_THREAD_DONE(win, func):
    win.Connect(-1, -1, wxEVT_THREAD_DONE, func)
    
class ThreadDoneEvent(wxPyEvent):
    def __init__(self):
        wxPyEvent.__init__(self)
        self.SetEventType(wxEVT_THREAD_DONE)
</pre>
<p>When you want to post the custom event, you do the following:</p>
<pre class="literal-block">
evt = ThreadDoneEvent() 
wxPostEvent(win, evt)
</pre>
</div>
<div class="section" id="def-createownerdialog">
<h4><a class="toc-backref" href="#id37" name="def-createownerdialog">def createownerdialog</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">createownerdialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">(</span><span class="p_identifier">parent</span><span class="p_operator">=</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">=</span><span class="p_string">"Select&nbsp;owner(s)"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">180</span><span class="p_operator">,</span><span class="p_number">300</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">modifierlist</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">_list</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">del</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">_list</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>When the thread is done that creates the owner list it posts an event whose callback is this method.  This method uses <em>self._list</em> that was generated by the <tt class="literal"><span class="pre">createownerlist</span></tt> method.  As an alternative, we could probably pass the list as an attribute of the event that is generated in the thread.</p>
</div>
</div>
<div class="section" id="notebook-methods">
<h3><a class="toc-backref" href="#id38" name="notebook-methods">Notebook methods</a></h3>
<p><strong>comments</strong>:</p>
<p>The main method here is the one that constructs a new Notebook page by creating a new ListCtrl and new OwnerListBox and populating them.  The second method does what is needed when an existing notebook page is selected.</p>
<div class="section" id="def-createnewnotebookpage">
<h4><a class="toc-backref" href="#id39" name="def-createnewnotebookpage">def CreateNewNotebookPage</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">CreateNewNotebookPage</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{</span><span class="p_character">'owner'</span><span class="p_operator">:</span><span class="p_character">'*ALL'</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_character">'LCdate'</span><span class="p_operator">:</span><span class="p_character">'duedate'</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_character">'sort'</span><span class="p_operator">:{</span><span class="p_character">'attribute'</span><span class="p_operator">:</span><span class="p_character">'priority'</span><span class="p_operator">,</span><span class="p_character">'direction'</span><span class="p_operator">:</span><span class="p_number">0</span><span class="p_operator">},</span><span class="p_default">&nbsp;</span><span class="p_commentline">#these&nbsp;could&nbsp;be&nbsp;set&nbsp;in&nbsp;Config</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_character">'showfinished'</span><span class="p_operator">:</span><span class="p_number">0</span><span class="p_operator">}</span><span class="p_default">&nbsp;</span><span class="p_commentline">#-1&nbsp;show&nbsp;them&nbsp;all;&nbsp;0&nbsp;show&nbsp;none;&nbsp;integer&nbsp;show&nbsp;for&nbsp;that&nbsp;many&nbsp;days</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">Properties</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">)</span><span class="p_commentline">#could&nbsp;use&nbsp;self.ListCtrls,&nbsp;self.OwnerLBoxes,&nbsp;etc.&nbsp;with&nbsp;a&nbsp;-1</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ReadFromDB</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[:-</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">panel</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPanel</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">900</span><span class="p_operator">,</span><span class="p_number">400</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ListCtrl</span><span class="p_operator">(</span><span class="p_identifier">panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxLC_REPORT</span><span class="p_operator">|</span><span class="p_identifier">wxSUNKEN_BORDER</span><span class="p_operator">|</span><span class="p_identifier">wxLC_VRULES</span><span class="p_operator">|</span><span class="p_identifier">wxLC_HRULES</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxListBox</span><span class="p_operator">(</span><span class="p_identifier">panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">126</span><span class="p_operator">,</span><span class="p_number">550</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">choices</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_string">""</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxLB_SORT</span><span class="p_operator">|</span><span class="p_identifier">wxSUNKEN_BORDER</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">OLBox</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">OLBox</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_identifier">wxALIGN_LEFT</span><span class="p_operator">|</span><span class="p_identifier">wxEXPAND</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">wxALIGN_LEFT</span><span class="p_operator">|</span><span class="p_identifier">wxEXPAND</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">panel</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateAndDisplayList</span><span class="p_operator">(</span><span class="p_identifier">results</span><span class="p_operator">))</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Fill</span><span class="p_default">&nbsp;</span><span class="p_identifier">OwnerListBox</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">ListControl</span><span class="p_default">&nbsp;</span><span class="p_identifier">Events</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#img_num&nbsp;=&nbsp;LCtrl.arrows[Properties['sort']['direction']]</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#LCtrl.SetColumnImage(self.attr2col_num[Properties['sort']['attribute']],&nbsp;img_num)</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'mysql'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tab_title</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'%s&nbsp;(remote)'</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tab_title</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">SYNC_TABLES</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tab_title</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'*'</span><span class="p_operator">+</span><span class="p_identifier">tab_title</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">AddPage</span><span class="p_operator">(</span><span class="p_identifier">panel</span><span class="p_operator">,</span><span class="p_identifier">tab_title</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">filehistory</span><span class="p_operator">.</span><span class="p_identifier">AddFileToHistory</span><span class="p_operator">(</span><span class="p_character">'%s:%s'</span><span class="p_operator">%(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetStatusText</span><span class="p_operator">(</span><span class="p_string">"Successfully&nbsp;loaded&nbsp;%s"</span><span class="p_operator">%</span><span class="p_identifier">tab_title</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>This method creates the ListCtrl and ListBox that appears on every notebook page.</p>
<p>Each list has a properties dictionary associated with it.</p>
<table border class="table">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr><td>'owner'</td>
<td>The owner that is filtering the display or '*ALL'</td>
</tr>
<tr><td>'LCdate'</td>
<td>Date that is displayed by the ListCtrl; values: 'duedate', 'createdate', 'timestamp', 'finisheddate'</td>
</tr>
<tr><td>'sort'</td>
<td>Value is a dictionary of the form {'attribute':'priority','direction':0}</td>
</tr>
<tr><td>'showfinished'</td>
<td>Values: -1 show them all; 0 show none; integer show for that many days</td>
</tr>
<tr><td>'table'</td>
<td>The table that holds the List</td>
</tr>
<tr><td>'host'</td>
<td>The form for this is 'nycpsszatzsql:mysql' or 'wxLMDB:sqlite'</td>
</tr>
</tbody>
</table>
<div class="section" id="fill-ownerlistbox">
<h5><a class="toc-backref" href="#id40" name="fill-ownerlistbox">&lt;&lt; Fill OwnerListBox &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Couldn't&nbsp;get&nbsp;cursor&nbsp;to&nbsp;fill&nbsp;OwnerListBox"</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;owner1&nbsp;FROM&nbsp;%s&nbsp;UNION&nbsp;SELECT&nbsp;owner2&nbsp;FROM&nbsp;%s&nbsp;UNION&nbsp;SELECT&nbsp;owner3&nbsp;FROM&nbsp;%s"</span><span class="p_operator">%((</span><span class="p_identifier">table</span><span class="p_operator">,)*</span><span class="p_number">3</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">owners</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">,)</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">owners</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">remove</span><span class="p_operator">(</span><span class="p_word">None</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_character">''</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">owners</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">remove</span><span class="p_operator">(</span><span class="p_character">''</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">owners</span><span class="p_operator">:</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_character">'*ALL'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>The list is sorted by the ListBox control.</p>
<p>mysql doesn't like '%s' while sqlite is fine with '%s' for table names.</p>
<p>If you don't do <tt class="literal"><span class="pre">OLBox.Clear()</span></tt> then you get a blank line in the list that must be from initiating it with &quot;&quot;.</p>
<p>Relying on the fact that '*All' should be first alphabetically, which is dumb so should change it.</p>
</div>
<div class="section" id="listcontrol-events">
<h5><a class="toc-backref" href="#id41" name="listcontrol-events">&lt;&lt; ListControl Events &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCId</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_LIST_ITEM_SELECTED</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCId</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnItemSelected</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_LIST_ITEM_ACTIVATED</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCId</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnDisplayInPlaceEditor</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_LEFT_DOWN</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnLeftDown</span><span class="p_operator">)</span><span class="p_default">&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_LEFT_DCLICK</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnLeftDown</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_RIGHT_DOWN</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnRightDown</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_LIST_COL_CLICK</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCId</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnColumnClick</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_LIST_COL_RIGHT_CLICK</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCId</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnColumnRightClick</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;the&nbsp;following&nbsp;is&nbsp;a&nbsp;ListBox&nbsp;event</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">EVT_LISTBOX</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnFilterOwners</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>It would seem that the two mouse events:  <tt class="literal"><span class="pre">EVT_LEFT_DOWN(LCtrl,</span> <span class="pre">self.OnLeftDown)</span></tt> and <tt class="literal"><span class="pre">EVT_LEFT_DCLICK(LCtrl,</span> <span class="pre">self.OnLeftDown)</span></tt> could be owned by the ListManager object and not each ListCtrl object, but when I tried this, the mouse events were not detected. I did not investigate this for long so maybe I was just screwing things up or perhaps a <tt class="literal"><span class="pre">wxFrame</span></tt> cannot detect a mousedown event (does that make sense?).  In any event (no pun intended), it is certainly not a big deal to create these mousedown events for each ListCtrl.</p>
<p>Each ListBox object has one event associated with it that occurs, not surprisingly, when a name in the control is selected.  The callback, <em>self.OnFilterOwners</em>, causes the ListCtrl to display only the items of the selected owner.</p>
</div>
</div>
<div class="section" id="def-onpagechange">
<h4><a class="toc-backref" href="#id42" name="def-onpagechange">def OnPageChange</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnPageChange</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">GetSelection</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Find</span><span class="p_default">&nbsp;</span><span class="p_identifier">Highlighted</span><span class="p_default">&nbsp;</span><span class="p_identifier">Row</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Update</span><span class="p_default">&nbsp;</span><span class="p_identifier">Title</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">Skip</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#051403</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>Call-back for the <tt class="literal"><span class="pre">EVT_NOTEBOOK_PAGE_CHANGED(self,nb.GetId(),self.OnPageChange)</span></tt> event.</p>
<p>self.modified is the dictionary that indicates which textctrls have data that has changed.</p>
<div class="note">
<p class="admonition-title">Note</p>
Not sure whether event.Skip() is needed or not.</div>
<div class="section" id="find-highlighted-row">
<h5><a class="toc-backref" href="#id43" name="find-highlighted-row">&lt;&lt; Find Highlighted Row &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">GetNextItem</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_NEXT_ALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#LCtrl.EnsureVisible(idx)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnItemSelected</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#the&nbsp;line&nbsp;above&nbsp;triggers&nbsp;an&nbsp;OnItemSelected&nbsp;EVT&nbsp;so&nbsp;don't&nbsp;need&nbsp;self.OnItemSelected()&nbsp;092803</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
</div>
<div class="section" id="update-title">
<h5><a class="toc-backref" href="#id44" name="update-title">&lt;&lt; Update Title &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'host'</span><span class="p_operator">].</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetTitle</span><span class="p_operator">(</span><span class="p_string">"List&nbsp;Manager:&nbsp;&nbsp;%s:&nbsp;&nbsp;%s:&nbsp;&nbsp;%s"</span><span class="p_operator">%(</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_identifier">rdbms</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
</div>
</div>
</div>
<div class="section" id="tickler-methods">
<h3><a class="toc-backref" href="#id45" name="tickler-methods">Tickler methods</a></h3>
<div class="section" id="def-onshowtickler">
<h4><a class="toc-backref" href="#id46" name="def-onshowtickler">def OnShowTickler</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnShowTickler</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">popupvisible</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">popupvisible</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'wxLMDB:sqlite'</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'follow_ups'</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SELECT&nbsp;COUNT()&nbsp;FROM&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;finisheddate&nbsp;IS&nbsp;NULL&nbsp;AND&nbsp;priority&nbsp;&gt;&nbsp;1"</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">sql</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">num_items</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">int</span><span class="p_operator">(</span><span class="p_identifier">results</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">num_items</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_commentline">#Should&nbsp;decide&nbsp;if&nbsp;this&nbsp;should&nbsp;be&nbsp;put&nbsp;back&nbsp;or&nbsp;not</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">n</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">random</span><span class="p_operator">.</span><span class="p_identifier">randint</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_identifier">num_items</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SELECT&nbsp;priority,name,createdate,finisheddate,duedate,owner1,owner2,owner3,id,timestamp,note&nbsp;FROM&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;finisheddate&nbsp;IS&nbsp;NULL&nbsp;AND&nbsp;priority&nbsp;&gt;&nbsp;1&nbsp;LIMIT&nbsp;1&nbsp;OFFSET&nbsp;%d"</span><span class="p_operator">%</span><span class="p_identifier">n</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">sql</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"In&nbsp;OnShowTickler&nbsp;and&nbsp;attempt&nbsp;to&nbsp;Select&nbsp;an&nbsp;item&nbsp;failed"</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">row</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">Item</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_word">pass</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Item</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">int</span><span class="p_operator">(</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">])</span><span class="p_default">&nbsp;</span><span class="p_commentline">#int(row[0])&nbsp;needs&nbsp;int&nbsp;because&nbsp;it&nbsp;seems&nbsp;to&nbsp;come&nbsp;back&nbsp;as&nbsp;a&nbsp;long&nbsp;from&nbsp;MySQL</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">2</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">3</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">4</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">5</span><span class="p_operator">:</span><span class="p_number">7</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_commentline">#if&nbsp;you&nbsp;carry&nbsp;around&nbsp;['tom',None,None]&nbsp;you&nbsp;have&nbsp;an&nbsp;issue&nbsp;when&nbsp;you&nbsp;go&nbsp;write&nbsp;it</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">8</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">9</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">10</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">TicklerDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Do&nbsp;something&nbsp;about&nbsp;this!!!"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">550</span><span class="p_operator">,</span><span class="p_number">350</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">TC</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxFont</span><span class="p_operator">(</span><span class="p_number">14</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSWISS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxITALIC</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBOLD</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">SetDefaultStyle</span><span class="p_operator">(</span><span class="p_identifier">wxTextAttr</span><span class="p_operator">(</span><span class="p_string">"BLUE"</span><span class="p_operator">,</span><span class="p_identifier">wxNullColour</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_string">"%s..."</span><span class="p_operator">%</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_number">3</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">SetDefaultStyle</span><span class="p_operator">(</span><span class="p_identifier">wxTextAttr</span><span class="p_operator">(</span><span class="p_string">"RED"</span><span class="p_operator">,</span><span class="p_string">"YELLOW"</span><span class="p_operator">,</span><span class="p_identifier">f</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_string">"%d\n\n"</span><span class="p_operator">%</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxFont</span><span class="p_operator">(</span><span class="p_number">8</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSWISS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">SetDefaultStyle</span><span class="p_operator">(</span><span class="p_identifier">wxTextAttr</span><span class="p_operator">(</span><span class="p_string">"BLACK"</span><span class="p_operator">,</span><span class="p_string">"WHITE"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_string">"owners:&nbsp;%s\n"</span><span class="p_operator">%</span><span class="p_string">",&nbsp;"</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">62</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_string">"created&nbsp;on:&nbsp;%s\n"</span><span class="p_operator">%</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_character">'%m/%d/%y'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">63</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">64</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ddate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_character">'%m/%d/%y'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">65</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">66</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ddate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"&lt;no&nbsp;due&nbsp;date&gt;"</span><span class="p_default"><br/>
</span><span class="p_number">67</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_string">"due&nbsp;on:&nbsp;%s\n\n"</span><span class="p_operator">%</span><span class="p_identifier">ddate</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">68</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">69</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_default"><br/>
</span><span class="p_number">70</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">note</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">71</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"&lt;no&nbsp;note&gt;"</span><span class="p_default"><br/>
</span><span class="p_number">72</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_string">"%s\n\n"</span><span class="p_operator">%</span><span class="p_identifier">note</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">73</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxFont</span><span class="p_operator">(</span><span class="p_number">10</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSWISS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxITALIC</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBOLD</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">74</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">SetDefaultStyle</span><span class="p_operator">(</span><span class="p_identifier">wxTextAttr</span><span class="p_operator">(</span><span class="p_string">"BLACK"</span><span class="p_operator">,</span><span class="p_identifier">wxNullColour</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">75</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_character">'follow_ups'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">76</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">ShowPosition</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#did&nbsp;not&nbsp;do&nbsp;anything</span><span class="p_default"><br/>
</span><span class="p_number">77</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">SetInsertionPoint</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">78</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">result</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">79</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">80</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">popupvisible</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">81</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">82</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">result</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_APPLY</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">83</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">84</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_operator">,</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">85</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">86</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">break</span><span class="p_default"><br/>
</span><span class="p_number">87</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">88</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Can't&nbsp;find&nbsp;%s"</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_default"><br/>
</span><span class="p_number">89</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">90</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">91</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(</span><span class="p_identifier">L</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#if&nbsp;the&nbsp;page&nbsp;changes&nbsp;it&nbsp;sends&nbsp;a&nbsp;EVT_NOTEBOOK_PAGE_CHANGED,&nbsp;which&nbsp;calls&nbsp;OnPageChange</span><span class="p_default"><br/>
</span><span class="p_number">92</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_default"><br/>
</span><span class="p_number">93</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindNode</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">94</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">result</span><span class="p_operator">==</span><span class="p_identifier">wxID_APPLY</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">95</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnMailItem</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">96</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">97</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">result</span><span class="p_operator">==</span><span class="p_identifier">wxID_FORWARD</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">98</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnShowTickler</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">99</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="def-onactivatetickler">
<h4><a class="toc-backref" href="#id47" name="def-onactivatetickler">def OnActivateTickler</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnActivateTickler</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">tickler_active</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">tickler_active</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">toolmenu</span><span class="p_operator">.</span><span class="p_identifier">Enable</span><span class="p_operator">(</span><span class="p_identifier">idSHOWNEXT</span><span class="p_operator">,</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">tickler_active</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="email-methods">
<h3><a class="toc-backref" href="#id48" name="email-methods">Email methods</a></h3>
<div class="section" id="onmailitem">
<h4><a class="toc-backref" href="#id49" name="onmailitem">OnMailItem</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnMailItem</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">MailDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_string">"Mail&nbsp;a&nbsp;reminder"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">450</span><span class="p_operator">,</span><span class="p_number">500</span><span class="p_operator">),</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">recipients</span><span class="p_operator">=</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">,</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">subject</span><span class="p_operator">=</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">body</span><span class="p_operator">=</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetNote</span><span class="p_operator">())</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">result</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">result</span><span class="p_operator">==</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">outlook</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Dispatch</span><span class="p_operator">(</span><span class="p_string">"Outlook.Application"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">outlook</span><span class="p_operator">.</span><span class="p_identifier">CreateItem</span><span class="p_operator">(</span><span class="p_identifier">olMailItem</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#outlook.CreateItem(constants.olMailItem)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">To</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">to</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">RTC</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">Subject</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">subject</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">STC</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">Body</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">body</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">BTC</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#newMsg.FlagStatus&nbsp;=&nbsp;constants.olFlagMarked</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">Display</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#del&nbsp;outlook</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">WriteText</span><span class="p_operator">(</span><span class="p_string">"**************************************************\n"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">WriteText</span><span class="p_operator">(</span><span class="p_string">"Email&nbsp;sent&nbsp;on&nbsp;%s\n"</span><span class="p_operator">%</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">today</span><span class="p_operator">().</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d/%y"</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">WriteText</span><span class="p_operator">(</span><span class="p_string">"To:&nbsp;%s\n"</span><span class="p_operator">%</span><span class="p_identifier">to</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">WriteText</span><span class="p_operator">(</span><span class="p_string">"Subject:&nbsp;%s\n"</span><span class="p_operator">%</span><span class="p_identifier">subject</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">WriteText</span><span class="p_operator">(</span><span class="p_string">"%s\n"</span><span class="p_operator">%</span><span class="p_identifier">body</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">WriteText</span><span class="p_operator">(</span><span class="p_string">"**************************************************\n"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onmailview">
<h4><a class="toc-backref" href="#id50" name="onmailview">OnMailView</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnMailView</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">recipients</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'owner'</span><span class="p_operator">]]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">body</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">body</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">body</span><span class="p_operator">+</span><span class="p_string">"%d.&nbsp;%s&nbsp;(%d)\n"</span><span class="p_operator">%(</span><span class="p_identifier">i</span><span class="p_operator">+</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">subject</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Follow-ups&nbsp;"</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">today</span><span class="p_operator">().</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d/%y"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">MailDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_string">"Follow-up&nbsp;List"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">450</span><span class="p_operator">,</span><span class="p_number">500</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">recipients</span><span class="p_operator">=</span><span class="p_identifier">recipients</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">subject</span><span class="p_operator">=</span><span class="p_identifier">subject</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">body</span><span class="p_operator">=</span><span class="p_identifier">body</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_operator">==</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">outlook</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Dispatch</span><span class="p_operator">(</span><span class="p_string">"Outlook.Application"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">outlook</span><span class="p_operator">.</span><span class="p_identifier">CreateItem</span><span class="p_operator">(</span><span class="p_identifier">olMailItem</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#outlook.CreateItem(constants.olMailItem)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">To</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">RTC</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">Subject</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">STC</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">Body</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">BTC</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">FlagStatus</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">olFlagMarked</span><span class="p_default">&nbsp;</span><span class="p_commentline">#constants.olFlagMarked</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">Categories</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Follow-up"</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">newMsg</span><span class="p_operator">.</span><span class="p_identifier">Display</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#del&nbsp;outlook</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="cut-copy-paste-methods">
<h3><a class="toc-backref" href="#id51" name="cut-copy-paste-methods">Cut/Copy/Paste methods</a></h3>
<div class="section" id="oncopyitems">
<h4><a class="toc-backref" href="#id52" name="oncopyitems">OnCopyItems</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnCopyItems</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">event</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cut</span><span class="p_operator">=</span><span class="p_identifier">False</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">IList</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Find</span><span class="p_default">&nbsp;</span><span class="p_identifier">Highlighted</span><span class="p_default">&nbsp;</span><span class="p_identifier">Items</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetStatusText</span><span class="p_operator">(</span><span class="p_string">"%d&nbsp;items&nbsp;copied"</span><span class="p_operator">%</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">copyitems</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cut</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnDeleteItems</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<div class="section" id="find-highlighted-items">
<h5><a class="toc-backref" href="#id53" name="find-highlighted-items">&lt;&lt; Find Highlighted Items &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">copyitems</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">while</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetNextItem</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_NEXT_ALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_operator">==-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">break</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">IList</span><span class="p_operator">[</span><span class="p_identifier">i</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">notes</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetNote</span><span class="p_operator">(</span><span class="p_identifier">L</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#handles&nbsp;the&nbsp;database&nbsp;situation</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">copyitems</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="onpasteitems">
<h4><a class="toc-backref" href="#id54" name="onpasteitems">OnPasteItems</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnPasteItems</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default">&nbsp;</span><span class="p_commentline">#noselect&nbsp;051603</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#used&nbsp;by&nbsp;OnMoveToList,&nbsp;OnMoveToSpecificList&nbsp;and&nbsp;called&nbsp;directly</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">copyitems</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Nothing&nbsp;was&nbsp;selected&nbsp;to&nbsp;be&nbsp;copied"</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_commentline">#this&nbsp;is&nbsp;not&nbsp;needed&nbsp;by&nbsp;OnMoveTo&nbsp;or&nbsp;OnDragToTab&nbsp;but&nbsp;is&nbsp;for&nbsp;a&nbsp;straight&nbsp;call</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">IList</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">items</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">copyitems</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">numitems</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">items</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">items</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">+[</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetUID</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#we&nbsp;do&nbsp;give&nbsp;it&nbsp;a&nbsp;new&nbsp;id</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#need&nbsp;this&nbsp;or&nbsp;else&nbsp;it&nbsp;won't&nbsp;be&nbsp;seen&nbsp;as&nbsp;a&nbsp;new&nbsp;item&nbsp;when&nbsp;synching;&nbsp;would&nbsp;be&nbsp;seen&nbsp;as&nbsp;updated</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">command</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;(priority,name,createdate,finisheddate,duedate,note,owner1,owner2,owner3,id)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)"</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">command</span><span class="p_operator">,(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_identifier">createdate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">notes</span><span class="p_operator">,</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">2</span><span class="p_operator">],</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#creating&nbsp;a&nbsp;new&nbsp;item&nbsp;breaks&nbsp;the&nbsp;connection&nbsp;between&nbsp;item.x&nbsp;and&nbsp;new_item.x</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">Item</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_word">pass</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Item</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">createdate</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">IList</span><span class="p_operator">.</span><span class="p_identifier">insert</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_identifier">new_item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">DisplayList</span><span class="p_operator">(</span><span class="p_identifier">IList</span><span class="p_operator">,</span><span class="p_identifier">L</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#If&nbsp;we&nbsp;didn't&nbsp;come&nbsp;from&nbsp;OnMoveToList&nbsp;or&nbsp;OnMoveToSpecificList&nbsp;where&nbsp;L&nbsp;!=&nbsp;self.L</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_operator">==</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">range</span><span class="p_operator">(</span><span class="p_identifier">numitems</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">numitems</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="ondeleteitems">
<h4><a class="toc-backref" href="#id55" name="ondeleteitems">OnDeleteItems</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnDeleteItems</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">event</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_tripledouble">"""Called&nbsp;directly&nbsp;and&nbsp;by&nbsp;OnCopyItems&nbsp;(cut&nbsp;=&nbsp;true)<br/>
&nbsp;3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"""</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_commentline">#not&nbsp;absolutely&nbsp;necessary&nbsp;but&nbsp;gets&nbsp;you&nbsp;out&nbsp;quickly</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">IList</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">while</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetNextItem</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_NEXT_ALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_operator">==-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">break</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">IList</span><span class="p_operator">.</span><span class="p_identifier">pop</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">DeleteItem</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"DELETE&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#Track&nbsp;Deletes&nbsp;for&nbsp;Syncing&nbsp;############################################</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">SYNC_TABLES</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;sync&nbsp;(id,action,table_name,name,timestamp)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s)"</span><span class="p_operator">,(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_character">'d'</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_identifier">timestamp</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;sync&nbsp;(id,action,table_name,user,name)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s)"</span><span class="p_operator">,(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_character">'d'</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">USER</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentblock">#########################################################################</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">i</span><span class="p_operator">-=</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#note&nbsp;that&nbsp;Clearing&nbsp;does&nbsp;cause&nbsp;self.modified&nbsp;--&gt;{'name':1}</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="mousedown-methods">
<h3><a class="toc-backref" href="#id56" name="mousedown-methods">MouseDown methods</a></h3>
<div class="section" id="onleftdown-action-depends-on-x-coordinate">
<h4><a class="toc-backref" href="#id57" name="onleftdown-action-depends-on-x-coordinate">OnLeftDown (Action depends on x coordinate)</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnLeftDown</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Here"</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;inplace&nbsp;editor&nbsp;is&nbsp;open&nbsp;and&nbsp;you&nbsp;click&nbsp;anywhere&nbsp;(same&nbsp;or&nbsp;different&nbsp;row&nbsp;from&nbsp;current&nbsp;row)&nbsp;but&nbsp;in&nbsp;the&nbsp;editor&nbsp;itself&nbsp;then&nbsp;just&nbsp;to&nbsp;close&nbsp;editor</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">flag</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">.</span><span class="p_identifier">has_key</span><span class="p_operator">(</span><span class="p_character">'inplace'</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">flag</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">Skip</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#without&nbsp;Skip,&nbsp;EVT_LIST_ITEM_SELECTED&nbsp;is&nbsp;not&nbsp;generated&nbsp;if&nbsp;you&nbsp;click&nbsp;in&nbsp;a&nbsp;new&nbsp;row</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_identifier">y</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">GetPosition</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#Using&nbsp;HitTest&nbsp;to&nbsp;obtain&nbsp;row&nbsp;clicked&nbsp;on&nbsp;because&nbsp;there&nbsp;was&nbsp;a&nbsp;noticable&nbsp;delay&nbsp;in&nbsp;the&nbsp;generation&nbsp;of&nbsp;an</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#EVT_LIST_ITEM_SELECTED&nbsp;event&nbsp;when&nbsp;you&nbsp;click&nbsp;on&nbsp;the&nbsp;already&nbsp;selected&nbsp;row</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_identifier">flags</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">HitTest</span><span class="p_operator">((</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_identifier">y</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;you&nbsp;are&nbsp;below&nbsp;rows&nbsp;of&nbsp;items&nbsp;then&nbsp;idx&nbsp;=&nbsp;-1&nbsp;which&nbsp;could&nbsp;match&nbsp;self.curIdx&nbsp;=&nbsp;-1</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;only&nbsp;if&nbsp;you&nbsp;click&nbsp;on&nbsp;the&nbsp;currently&nbsp;selected&nbsp;row&nbsp;do&nbsp;the&nbsp;following&nbsp;events&nbsp;occur</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_operator">&lt;</span><span class="p_default">&nbsp;</span><span class="p_number">18</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnToggleFinished</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_operator">&lt;</span><span class="p_default">&nbsp;</span><span class="p_number">33</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPriority</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_operator">&lt;</span><span class="p_default">&nbsp;</span><span class="p_number">33</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetColumnWidth</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnDisplayInPlaceEditor</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_operator">&lt;</span><span class="p_default">&nbsp;</span><span class="p_number">33</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetColumnWidth</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetColumnWidth</span><span class="p_operator">(</span><span class="p_number">2</span><span class="p_operator">):</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnEditOwner</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnDueDate</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">Skip</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#without&nbsp;Skip,&nbsp;EVT_LIST_ITEM_SELECTED&nbsp;is&nbsp;not&nbsp;generated&nbsp;if&nbsp;you&nbsp;click&nbsp;in&nbsp;a&nbsp;new&nbsp;row</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onrightdown-display-popup-sendto-menu">
<h4><a class="toc-backref" href="#id58" name="onrightdown-display-popup-sendto-menu">OnRightDown (Display popup sendto menu)</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnRightDown</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_identifier">y</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">GetPosition</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sendtomenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMenu</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">open_tables</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">page</span><span class="p_operator">,</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">],</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">open_tables</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">((</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sendtomenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">+</span><span class="p_identifier">page</span><span class="p_operator">,</span><span class="p_string">"%s&nbsp;(%s)"</span><span class="p_operator">%(</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">host</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">+</span><span class="p_identifier">page</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_identifier">p</span><span class="p_operator">=</span><span class="p_identifier">page</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnMoveToList</span><span class="p_operator">(</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_identifier">p</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sendtomenu</span><span class="p_operator">.</span><span class="p_identifier">Delete</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">+</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;don't&nbsp;send&nbsp;it&nbsp;to&nbsp;the&nbsp;page&nbsp;you're&nbsp;already&nbsp;on</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sendtomenu</span><span class="p_operator">.</span><span class="p_identifier">AppendSeparator</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">closed_tables</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">.</span><span class="p_identifier">items</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;name&nbsp;FROM&nbsp;sqlite_master&nbsp;WHERE&nbsp;type='table'&nbsp;ORDER&nbsp;BY&nbsp;name"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'mysql'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SHOW&nbsp;tables"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">page</span><span class="p_operator">+=</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">table</span><span class="p_operator">,)</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_operator">((</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">open_tables</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_character">'user_sync'</span><span class="p_operator">,</span><span class="p_character">'owners'</span><span class="p_operator">,</span><span class="p_character">'sync'</span><span class="p_operator">]):</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">closed_tables</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">((</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sendtomenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">+</span><span class="p_identifier">page</span><span class="p_operator">,</span><span class="p_string">"%s&nbsp;(%s)"</span><span class="p_operator">%(</span><span class="p_character">'*'</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">host</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">+</span><span class="p_identifier">page</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_identifier">p</span><span class="p_operator">=</span><span class="p_identifier">page</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnMoveToList</span><span class="p_operator">(</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_identifier">p</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">page</span><span class="p_operator">+=</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PopupMenu</span><span class="p_operator">(</span><span class="p_identifier">sendtomenu</span><span class="p_operator">,(</span><span class="p_identifier">x</span><span class="p_operator">+</span><span class="p_number">125</span><span class="p_operator">,</span><span class="p_identifier">y</span><span class="p_operator">+</span><span class="p_number">40</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sendtomenu</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="move-combine-items-methods">
<h3><a class="toc-backref" href="#id59" name="move-combine-items-methods">Move/Combine items methods</a></h3>
<div class="section" id="oncombineitems">
<h4><a class="toc-backref" href="#id60" name="oncombineitems">OnCombineItems</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnCombineItems</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">IList</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">combine_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">while</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetNextItem</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_NEXT_ALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_operator">==-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">break</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">combine_list</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">((</span><span class="p_identifier">IList</span><span class="p_operator">[</span><span class="p_identifier">i</span><span class="p_operator">].</span><span class="p_identifier">createdate</span><span class="p_operator">,</span><span class="p_identifier">IList</span><span class="p_operator">[</span><span class="p_identifier">i</span><span class="p_operator">]))</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">combine_list</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_operator">&lt;</span><span class="p_default">&nbsp;</span><span class="p_number">2</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Fewer&nbsp;than&nbsp;two&nbsp;items&nbsp;highlighted"</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">combine_list</span><span class="p_operator">.</span><span class="p_identifier">sort</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">combine_list</span><span class="p_operator">.</span><span class="p_identifier">reverse</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Combine&nbsp;the&nbsp;%d&nbsp;selected&nbsp;items?"</span><span class="p_operator">%</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">combine_list</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Combine&nbsp;Items?"</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_QUESTION</span><span class="p_operator">|</span><span class="p_identifier">wxYES_NO</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_YES</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">t_item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">combine_list</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">][</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">merge_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">combine_list</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">:]</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">merge_list</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetNote</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">=</span><span class="p_identifier">item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d/%y"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"%s\n%s&nbsp;%s\n\n%s"</span><span class="p_operator">%(</span><span class="p_identifier">new_note</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">note</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"DELETE&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#Track&nbsp;Deletes&nbsp;for&nbsp;Syncing&nbsp;############################################</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">SYNC_TABLES</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;sync&nbsp;(id,action,table_name,name,timestamp)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s)"</span><span class="p_operator">,(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_character">'d'</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_identifier">timestamp</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;sync&nbsp;(id,action,table_name,user,name)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s)"</span><span class="p_operator">,(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_character">'d'</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">USER</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentblock">#########################################################################</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">t_note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetNote</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">=</span><span class="p_identifier">t_item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">t_note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"%s\n%s"</span><span class="p_operator">%(</span><span class="p_identifier">t_note</span><span class="p_operator">,</span><span class="p_identifier">new_note</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#What&nbsp;about&nbsp;combining&nbsp;owners?######################################</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;name&nbsp;=&nbsp;%s,&nbsp;note&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">t_item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">+</span><span class="p_string">"*"</span><span class="p_operator">,</span><span class="p_identifier">t_note</span><span class="p_operator">,</span><span class="p_identifier">t_item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">t_item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">t_item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnRefresh</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">62</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">63</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">IList</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">64</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">t_item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default"><br/>
</span><span class="p_number">65</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">66</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">IList</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">67</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_operator">+=</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">68</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">69</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">break</span><span class="p_default"><br/>
</span><span class="p_number">70</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">71</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">72</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">73</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#should&nbsp;never&nbsp;be&nbsp;-1</span><span class="p_default"><br/>
</span><span class="p_number">74</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">75</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">76</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">EnsureVisible</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">77</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default"><br/>
</span><span class="p_number">78</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">79</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">80</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onmovetolist">
<h4><a class="toc-backref" href="#id61" name="onmovetolist">OnMoveToList</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnMoveToList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">page</span><span class="p_operator">=</span><span class="p_number">0</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCopyItems</span><span class="p_operator">(</span><span class="p_identifier">cut</span><span class="p_operator">=</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pc</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">GetPageCount</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">page</span><span class="p_default">&nbsp;</span><span class="p_operator">&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">pc</span><span class="p_operator">:</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPasteItems</span><span class="p_operator">(</span><span class="p_identifier">L</span><span class="p_operator">=</span><span class="p_identifier">page</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">closed_tables</span><span class="p_operator">[</span><span class="p_identifier">page</span><span class="p_operator">-</span><span class="p_identifier">pc</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_commentline">#&nbsp;in&nbsp;ini&nbsp;self.Cursors[host]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">copyitems</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">+[</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetUID</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#give&nbsp;it&nbsp;a&nbsp;new&nbsp;id</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#need&nbsp;this&nbsp;or&nbsp;else&nbsp;it&nbsp;won't&nbsp;be&nbsp;seen&nbsp;as&nbsp;a&nbsp;new&nbsp;item&nbsp;when&nbsp;syncing;&nbsp;would&nbsp;be&nbsp;seen&nbsp;as&nbsp;updated</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">command</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;(priority,name,createdate,finisheddate,duedate,note,owner1,owner2,owner3,id)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)"</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">command</span><span class="p_operator">,(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_identifier">createdate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">notes</span><span class="p_operator">,</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">2</span><span class="p_operator">],</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">copyitems</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onmovetospecificlist">
<h4><a class="toc-backref" href="#id62" name="onmovetospecificlist">OnMoveToSpecificList</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnMoveToSpecificList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">=</span><span class="p_character">'follow_ups'</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">matches</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">page</span><span class="p_operator">,</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">tble</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">],</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">tble</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">matches</span><span class="p_operator">[</span><span class="p_identifier">rdbms</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">page</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCopyItems</span><span class="p_operator">(</span><span class="p_identifier">cut</span><span class="p_operator">=</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">matches</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">matches</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'mysql'</span><span class="p_operator">):</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPasteItems</span><span class="p_operator">(</span><span class="p_identifier">L</span><span class="p_operator">=</span><span class="p_identifier">matches</span><span class="p_operator">[</span><span class="p_character">'mysql'</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnPasteItems</span><span class="p_operator">(</span><span class="p_identifier">L</span><span class="p_operator">=</span><span class="p_identifier">matches</span><span class="p_operator">[</span><span class="p_character">'sqlite'</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">LOCAL_HOST</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">copyitems</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">+[</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetUID</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#give&nbsp;it&nbsp;a&nbsp;new&nbsp;id</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#need&nbsp;this&nbsp;or&nbsp;else&nbsp;it&nbsp;won't&nbsp;be&nbsp;seen&nbsp;as&nbsp;a&nbsp;new&nbsp;item&nbsp;when&nbsp;syncing;&nbsp;would&nbsp;be&nbsp;seen&nbsp;as&nbsp;updated</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">command</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;(priority,name,createdate,finisheddate,duedate,note,owner1,owner2,owner3,id)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)"</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">command</span><span class="p_operator">,(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_identifier">createdate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">notes</span><span class="p_operator">,</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">2</span><span class="p_operator">],</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">copyitems</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="change-update-items-methods">
<h3><a class="toc-backref" href="#id63" name="change-update-items-methods">Change/update items methods</a></h3>
<div class="section" id="ontogglefinished">
<h4><a class="toc-backref" href="#id64" name="ontogglefinished">OnToggleFinished</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnToggleFinished</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">today</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetImage</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">idx0</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetImage</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">idx1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">draw</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">tb</span><span class="p_operator">.</span><span class="p_identifier">EnableTool</span><span class="p_operator">(</span><span class="p_number">30</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;finisheddate&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d&nbsp;%H:%M:%S"</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'finisheddate'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_character">'%m/%d/%y'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<div class="section" id="draw-item">
<h5><a class="toc-backref" href="#id65" name="draw-item">&lt;&lt; draw item &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#It&nbsp;appears&nbsp;that&nbsp;SetTextColour&nbsp;resets&nbsp;font&nbsp;weight&nbsp;to&nbsp;Normal&nbsp;but&nbsp;this&nbsp;makes&nbsp;no&nbsp;sense</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#This&nbsp;means&nbsp;that&nbsp;all&nbsp;finished&nbsp;items&nbsp;have&nbsp;Normal&nbsp;weight&nbsp;whether&nbsp;they&nbsp;are&nbsp;priority&nbsp;3,2&nbsp;or&nbsp;1</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#May&nbsp;actually&nbsp;be&nbsp;that&nbsp;GetItem()&nbsp;and&nbsp;then&nbsp;SetItem()&nbsp;sets&nbsp;the&nbsp;weight&nbsp;to&nbsp;Normal&nbsp;no&nbsp;matter&nbsp;what&nbsp;it&nbsp;was&nbsp;originally</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">==</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#see&nbsp;note&nbsp;above&nbsp;about&nbsp;SetTextColour&nbsp;apparently&nbsp;resetting&nbsp;weight</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxBLACK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">==</span><span class="p_number">2</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#LC_Item.SetTextColour(wxBLACK)&nbsp;--&nbsp;this&nbsp;line&nbsp;should&nbsp;be&nbsp;necessary&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;appear&nbsp;to&nbsp;be</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;?&nbsp;font&nbsp;is&nbsp;black&nbsp;so&nbsp;?&nbsp;if&nbsp;have&nbsp;to&nbsp;reset&nbsp;it</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxBOLD</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">f</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;resetting&nbsp;font&nbsp;weight</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxRED</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#appears&nbsp;to&nbsp;be&nbsp;the&nbsp;only&nbsp;way&nbsp;to&nbsp;set&nbsp;color&nbsp;-&nbsp;can't&nbsp;through&nbsp;font</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_default">&nbsp;</span><span class="p_commentline">#LCtrl.font</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxBOLD</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">f</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;resetting&nbsp;font&nbsp;weight</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="onpriority">
<h4><a class="toc-backref" href="#id66" name="onpriority">OnPriority</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnPriority</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">event</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">input</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">input</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">=</span><span class="p_identifier">input</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_default">&nbsp;</span><span class="p_operator">&lt;</span><span class="p_default">&nbsp;</span><span class="p_number">3</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">+=</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">=</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">draw</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">text</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">str</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">text</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;priority&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_character">'%m/%d&nbsp;%H:%M:%S'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxCallAfter</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetFocus</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
<div class="section" id="id1">
<h5><a class="toc-backref" href="#id67" name="id1">&lt;&lt; draw item &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#It&nbsp;appears&nbsp;that&nbsp;SetTextColour&nbsp;resets&nbsp;font&nbsp;weight&nbsp;to&nbsp;Normal&nbsp;but&nbsp;this&nbsp;makes&nbsp;no&nbsp;sense</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#This&nbsp;means&nbsp;that&nbsp;all&nbsp;finished&nbsp;items&nbsp;have&nbsp;Normal&nbsp;weight&nbsp;whether&nbsp;they&nbsp;are&nbsp;priority&nbsp;3,2&nbsp;or&nbsp;1</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#May&nbsp;actually&nbsp;be&nbsp;that&nbsp;GetItem()&nbsp;and&nbsp;then&nbsp;SetItem()&nbsp;sets&nbsp;the&nbsp;weight&nbsp;to&nbsp;Normal&nbsp;no&nbsp;matter&nbsp;what&nbsp;it&nbsp;was&nbsp;originally</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">==</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#see&nbsp;note&nbsp;above&nbsp;about&nbsp;SetTextColour&nbsp;apparently&nbsp;resetting&nbsp;weight</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxBLACK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">==</span><span class="p_number">2</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#LC_Item.SetTextColour(wxBLACK)&nbsp;--&nbsp;this&nbsp;line&nbsp;should&nbsp;be&nbsp;necessary&nbsp;but&nbsp;it&nbsp;does&nbsp;not&nbsp;appear&nbsp;to&nbsp;be</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;?&nbsp;font&nbsp;is&nbsp;black&nbsp;so&nbsp;?&nbsp;if&nbsp;have&nbsp;to&nbsp;reset&nbsp;it</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxBOLD</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">f</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;resetting&nbsp;font&nbsp;weight</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxRED</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#appears&nbsp;to&nbsp;be&nbsp;the&nbsp;only&nbsp;way&nbsp;to&nbsp;set&nbsp;color&nbsp;-&nbsp;can't&nbsp;through&nbsp;font</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_default">&nbsp;</span><span class="p_commentline">#LCtrl.font</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxBOLD</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">f</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;resetting&nbsp;font&nbsp;weight</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="inplace-edit-methods">
<h4><a class="toc-backref" href="#id68" name="inplace-edit-methods">Inplace Edit Methods</a></h4>
<div class="section" id="ondisplayinplaceeditor">
<h5><a class="toc-backref" href="#id69" name="ondisplayinplaceeditor">OnDisplayInPlaceEditor</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnDisplayInPlaceEditor</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;self.Conflict(host,&nbsp;cursor,&nbsp;table,&nbsp;item):&nbsp;return&nbsp;#works&nbsp;--&nbsp;may&nbsp;be&nbsp;overkill&nbsp;so&nbsp;i've&nbsp;commented&nbsp;it&nbsp;out</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TCid</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNewId</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">y</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItemPosition</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">length</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetColumnWidth</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">editor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">TCid</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">167</span><span class="p_operator">,</span><span class="p_identifier">y</span><span class="p_operator">+</span><span class="p_number">28</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">length</span><span class="p_operator">,</span><span class="p_number">23</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxTE_PROCESS_ENTER</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">editor</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">wxFont</span><span class="p_operator">(</span><span class="p_number">9</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSWISS</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">editor</span><span class="p_operator">.</span><span class="p_identifier">SetBackgroundColour</span><span class="p_operator">(</span><span class="p_identifier">wxColour</span><span class="p_operator">(</span><span class="p_identifier">red</span><span class="p_operator">=</span><span class="p_number">255</span><span class="p_operator">,</span><span class="p_identifier">green</span><span class="p_operator">=</span><span class="p_number">255</span><span class="p_operator">,</span><span class="p_identifier">blue</span><span class="p_operator">=</span><span class="p_number">175</span><span class="p_operator">))</span><span class="p_default">&nbsp;</span><span class="p_commentline">#Yellow</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">editor</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">editor</span><span class="p_operator">.</span><span class="p_identifier">Show</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">editor</span><span class="p_operator">.</span><span class="p_identifier">Raise</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">editor</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">editor</span><span class="p_operator">.</span><span class="p_identifier">SetFocus</span><span class="p_operator">()</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_TEXT_ENTER</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">TCid</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCloseInPlaceEditor</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">in_place_editor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">editor</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">[</span><span class="p_character">'inplace'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="oncloseinplaceeditor">
<h5><a class="toc-backref" href="#id70" name="oncloseinplaceeditor">OnCloseInPlaceEditor</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnCloseInPlaceEditor</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;self.Conflict(host,&nbsp;cursor,&nbsp;table,&nbsp;item)...</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">text</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">in_place_editor</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">().</span><span class="p_identifier">strip</span><span class="p_operator">()[:</span><span class="p_number">150</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">text</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'name'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">text</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">in_place_editor</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;name&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">text</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_character">'%m/%d&nbsp;%H:%M:%S'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_identifier">text</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#this&nbsp;will&nbsp;cause&nbsp;self.modified['name']&nbsp;=&nbsp;1,&nbsp;which&nbsp;is&nbsp;dealt&nbsp;with&nbsp;below</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#using&nbsp;default&nbsp;in&nbsp;case&nbsp;for&nbsp;some&nbsp;reason&nbsp;self.modified&nbsp;does&nbsp;not&nbsp;have&nbsp;the&nbsp;keys</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">.</span><span class="p_identifier">pop</span><span class="p_operator">(</span><span class="p_character">'inplace'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">.</span><span class="p_identifier">pop</span><span class="p_operator">(</span><span class="p_character">'name'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxCallAfter</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetFocus</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#sets&nbsp;focus&nbsp;on&nbsp;LCtrl&nbsp;and&nbsp;current&nbsp;selection&nbsp;to&nbsp;be&nbsp;highlighted</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="onduedate">
<h4><a class="toc-backref" href="#id71" name="onduedate">OnDueDate</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnDueDate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxDateTime</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">.</span><span class="p_identifier">SetTimeT</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#I&nbsp;am&nbsp;surprised&nbsp;it&nbsp;takes&nbsp;a&nbsp;mx.DateTime&nbsp;object;&nbsp;supposed&nbsp;to&nbsp;need&nbsp;ticks</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">CalendarDialog</span><span class="p_operator">(</span><span class="p_identifier">parent</span><span class="p_operator">=</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">=</span><span class="p_string">"Select&nbsp;a&nbsp;date"</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">400</span><span class="p_operator">,</span><span class="p_number">400</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()==</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">cal</span><span class="p_operator">.</span><span class="p_identifier">GetDate</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;this&nbsp;is&nbsp;some&nbsp;date&nbsp;object</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#date&nbsp;=&nbsp;date.GetTicks()</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">DateFromTicks</span><span class="p_operator">(</span><span class="p_identifier">date</span><span class="p_operator">.</span><span class="p_identifier">GetTicks</span><span class="p_operator">())</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;duedate&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d&nbsp;%H:%M:%S"</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'duedate'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_character">'%m/%d/%y'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">cal</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="oneditowner">
<h4><a class="toc-backref" href="#id72" name="oneditowner">OnEditOwner</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnEditOwner</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default">&nbsp;</span><span class="p_commentline">#,&nbsp;new=False)&nbsp;removed&nbsp;Aug.&nbsp;31&nbsp;for&nbsp;simplicity</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"self.ModifierDialog&nbsp;is&nbsp;still&nbsp;being&nbsp;constructed"</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#need&nbsp;to&nbsp;clear&nbsp;the&nbsp;current&nbsp;selections&nbsp;or&nbsp;you'll&nbsp;just&nbsp;be&nbsp;making&nbsp;more&nbsp;and&nbsp;more&nbsp;selections</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">.</span><span class="p_identifier">SelectCurrent</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">.</span><span class="p_identifier">tc</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">.</span><span class="p_identifier">CenterOnParent</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">new_names</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">.</span><span class="p_identifier">GetUserInput</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Common</span><span class="p_default">&nbsp;</span><span class="p_identifier">Owner</span><span class="p_default">&nbsp;</span><span class="p_identifier">Code</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">FindString</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">new_names</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;owner1&nbsp;=&nbsp;%s,&nbsp;owner2&nbsp;=&nbsp;%s,&nbsp;owner3&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">2</span><span class="p_operator">],</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d&nbsp;%H:%M:%S"</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_character">'owners'</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">del</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">[</span><span class="p_character">'owners'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxCallAfter</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetFocus</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
<div class="section" id="common-owner-code">
<h5><a class="toc-backref" href="#id73" name="common-owner-code">&lt;&lt; Common Owner Code &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">owner_str</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">';&nbsp;'</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'owners'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner_str</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_identifier">owner_str</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">+[</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_commentline">#note&nbsp;that&nbsp;+&nbsp;creates&nbsp;a&nbsp;new&nbsp;list</span>
</div>
</div>
</div>
<div class="section" id="onupdate">
<h4><a class="toc-backref" href="#id74" name="onupdate">OnUpdate</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnUpdate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_character">'inplace'</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCloseInPlaceEditor</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">IList</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;there&nbsp;is&nbsp;some&nbsp;chance&nbsp;that&nbsp;it&nbsp;is&nbsp;never&nbsp;true&nbsp;that&nbsp;idx&nbsp;==&nbsp;-1&nbsp;and&nbsp;then&nbsp;this&nbsp;could&nbsp;be&nbsp;eliminated</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">IList</span><span class="p_operator">[</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">msg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"There&nbsp;is&nbsp;no&nbsp;selected&nbsp;item&nbsp;to&nbsp;update"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxICON_ERROR</span><span class="p_operator">|</span><span class="p_identifier">wxOK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_character">'name'</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">().</span><span class="p_identifier">strip</span><span class="p_operator">()[:</span><span class="p_number">150</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'name'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;name&nbsp;=%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_character">'note'</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#a&nbsp;blank&nbsp;note&nbsp;starts&nbsp;out&nbsp;as&nbsp;None&nbsp;but&nbsp;after&nbsp;this&nbsp;it&nbsp;becomes&nbsp;''&nbsp;--&nbsp;??</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;note&nbsp;=%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,(</span><span class="p_identifier">note</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_character">'owners'</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owner_str</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">().</span><span class="p_identifier">strip</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner_str</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owner_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">x</span><span class="p_operator">.</span><span class="p_identifier">strip</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner_str</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">';'</span><span class="p_operator">)]</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner_list</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">",&nbsp;"</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">([</span><span class="p_identifier">x</span><span class="p_operator">.</span><span class="p_identifier">strip</span><span class="p_operator">().</span><span class="p_identifier">title</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">','</span><span class="p_operator">)])</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Common</span><span class="p_default">&nbsp;</span><span class="p_identifier">Owner</span><span class="p_default">&nbsp;</span><span class="p_identifier">Code</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;owner1&nbsp;=&nbsp;%s,&nbsp;owner2&nbsp;=&nbsp;%s,&nbsp;owner3&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">],</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">2</span><span class="p_operator">],</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">FindString</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_operator">.</span><span class="p_identifier">FindString</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">3</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d&nbsp;%H:%M:%S"</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
</span><span class="p_number">62</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">63</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
<div class="section" id="id2">
<h5><a class="toc-backref" href="#id75" name="id2">&lt;&lt; Common Owner Code &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">owner_str</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">';&nbsp;'</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'owners'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner_str</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_identifier">owner_str</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">+[</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_commentline">#note&nbsp;that&nbsp;+&nbsp;creates&nbsp;a&nbsp;new&nbsp;list</span>
</div>
</div>
</div>
<div class="section" id="onnewitem">
<h4><a class="toc-backref" href="#id76" name="onnewitem">OnNewItem</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnNewItem</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_operator">=</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Clear</span><span class="p_default">&nbsp;</span><span class="p_identifier">data</span><span class="p_default">&nbsp;</span><span class="p_identifier">fields</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">Item</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_word">pass</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Item</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'&lt;New&nbsp;Item&gt;'</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#need&nbsp;this&nbsp;to&nbsp;be&nbsp;a&nbsp;timestamp&nbsp;and&nbsp;not&nbsp;just&nbsp;date&nbsp;for&nbsp;syncing</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">insert</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetUID</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;(priority,name,createdate,finisheddate,duedate,id)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s,%s)"</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#tracking&nbsp;new&nbsp;item&nbsp;for&nbsp;syncing&nbsp;will&nbsp;happen&nbsp;in&nbsp;Edit&nbsp;Name</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">InsertImageStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_string">"1"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">idx1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d&nbsp;%H:%M:%S"</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'createdate'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_character">'%m/%d/%y'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;Display&nbsp;is&nbsp;being&nbsp;filtered&nbsp;we&nbsp;assume&nbsp;that&nbsp;is&nbsp;the&nbsp;owner&nbsp;of&nbsp;the&nbsp;new&nbsp;node</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'owner'</span><span class="p_operator">]</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_operator">!=</span><span class="p_character">'*ALL'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'owners'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">owner</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;owner1&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">owner</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#not&nbsp;really&nbsp;necessary&nbsp;since&nbsp;just&nbsp;got&nbsp;a&nbsp;timestamp</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;decided&nbsp;that&nbsp;it&nbsp;was&nbsp;actually&nbsp;better&nbsp;not&nbsp;to&nbsp;ask&nbsp;for&nbsp;the&nbsp;owner&nbsp;on&nbsp;a&nbsp;new&nbsp;node&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_default"><br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#else:</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#self.OnEditOwner()</span><span class="p_default"><br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetFocus</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#needed&nbsp;for&nbsp;the&nbsp;in&nbsp;place&nbsp;editor&nbsp;to&nbsp;look&nbsp;right</span><span class="p_default"><br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
<div class="section" id="clear-data-fields">
<h5><a class="toc-backref" href="#id77" name="clear-data-fields">&lt;&lt; Clear data fields &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span>
</div>
</div>
</div>
<div class="section" id="conflict-not-in-use">
<h4><a class="toc-backref" href="#id78" name="conflict-not-in-use">Conflict (not in use)</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;@&nbsp;</span><span class="p_identifier">Need</span><span class="p_default">&nbsp;</span><span class="p_identifier">to</span><span class="p_default">&nbsp;</span><span class="p_identifier">decide</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">we</span><span class="p_default">&nbsp;</span><span class="p_identifier">are</span><span class="p_default">&nbsp;</span><span class="p_identifier">going</span><span class="p_default">&nbsp;</span><span class="p_identifier">to</span><span class="p_default">&nbsp;</span><span class="p_identifier">have</span><span class="p_default">&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_identifier">checking</span><span class="p_default">&nbsp;</span><span class="p_identifier">to</span><span class="p_default">&nbsp;</span><span class="p_identifier">be</span><span class="p_default">&nbsp;</span><span class="p_identifier">sure</span><span class="p_default">&nbsp;</span><span class="p_identifier">something</span><span class="p_default">&nbsp;</span><span class="p_identifier">hasn</span><span class="p_stringeol">'t&nbsp;changed<br/>
</span><span class="p_default">&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">Note</span><span class="p_default">&nbsp;</span><span class="p_identifier">that</span><span class="p_default">&nbsp;</span><span class="p_identifier">there</span><span class="p_default">&nbsp;</span><span class="p_identifier">would</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">need</span><span class="p_default">&nbsp;</span><span class="p_identifier">to</span><span class="p_default">&nbsp;</span><span class="p_identifier">be</span><span class="p_default">&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_identifier">checking</span><span class="p_default">&nbsp;</span><span class="p_identifier">on</span><span class="p_default">&nbsp;</span><span class="p_identifier">a</span><span class="p_default">&nbsp;</span><span class="p_identifier">new</span><span class="p_default">&nbsp;</span><span class="p_identifier">node</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">Also</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">there</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_identifier">no</span><span class="p_default">&nbsp;</span><span class="p_identifier">need</span><span class="p_default">&nbsp;</span><span class="p_identifier">to</span><span class="p_default">&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_identifier">check</span><span class="p_default">&nbsp;</span><span class="p_identifier">on</span><span class="p_default">&nbsp;</span><span class="p_identifier">a</span><span class="p_default">&nbsp;</span><span class="p_identifier">local</span><span class="p_default">&nbsp;</span><span class="p_identifier">DB</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">The</span><span class="p_default">&nbsp;</span><span class="p_identifier">following</span><span class="p_default">&nbsp;</span><span class="p_identifier">code</span><span class="p_default">&nbsp;</span><span class="p_identifier">seems</span><span class="p_default">&nbsp;</span><span class="p_identifier">to</span><span class="p_default">&nbsp;</span><span class="p_identifier">work</span><span class="p_default">&nbsp;</span><span class="p_identifier">fine</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">however</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">I</span><span class="p_default">&nbsp;</span><span class="p_identifier">have</span><span class="p_default">&nbsp;</span><span class="p_identifier">just</span><span class="p_default">&nbsp;</span><span class="p_identifier">commented</span><span class="p_default">&nbsp;</span><span class="p_identifier">out</span><span class="p_default">&nbsp;</span><span class="p_identifier">the</span><span class="p_default">&nbsp;</span><span class="p_identifier">calls</span><span class="p_default">&nbsp;</span><span class="p_identifier">to</span><span class="p_default">&nbsp;</span><span class="p_identifier">it</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">NameEditor</span><span class="p_default">&nbsp;</span><span class="p_identifier">methods</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;@</span><span class="p_identifier">c</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">Conflict</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"Select&nbsp;timestamp&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">db_timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">db_timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"There&nbsp;is&nbsp;a&nbsp;conflict&nbsp;and&nbsp;you&nbsp;should&nbsp;refresh&nbsp;display"</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span>
</div>
</div>
<div class="section" id="oneditnote">
<h4><a class="toc-backref" href="#id79" name="oneditnote">OnEditNote</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnEditNote</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;self.editor:</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#machine&nbsp;=&nbsp;None</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#win32pdh.EnumObjects(None,&nbsp;machine,&nbsp;0,&nbsp;1)&nbsp;#&nbsp;resets&nbsp;Enum&nbsp;otherwise&nbsp;it&nbsp;seems&nbsp;to&nbsp;hold&nbsp;onto&nbsp;old&nbsp;data</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#object&nbsp;=&nbsp;"Process"</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#items,&nbsp;instances&nbsp;=&nbsp;win32pdh.EnumObjectItems(None,None,"Process",&nbsp;-1)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;'TextPad'&nbsp;in&nbsp;instances:</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#print&nbsp;"TextPad&nbsp;is&nbsp;running"</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#else:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#self.editor&nbsp;=&nbsp;{}</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">file_name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">re</span><span class="p_operator">.</span><span class="p_identifier">sub</span><span class="p_operator">(</span><span class="p_character">'[\\/:*"&lt;&gt;|\?]'</span><span class="p_operator">,</span><span class="p_character">'-'</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#make&nbsp;sure&nbsp;all&nbsp;chars&nbsp;are&nbsp;legal&nbsp;file&nbsp;name&nbsp;characters</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">path</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">environ</span><span class="p_operator">[</span><span class="p_character">'TMP'</span><span class="p_operator">],</span><span class="p_identifier">file_name</span><span class="p_operator">[:</span><span class="p_number">50</span><span class="p_operator">])+</span><span class="p_character">'.%s'</span><span class="p_operator">%</span><span class="p_identifier">NOTE_EXT</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">file</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">,</span><span class="p_character">'w'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">write</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetNote</span><span class="p_operator">())</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">close</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">startfile</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">d</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">editor</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'id'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ed</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'time'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">getmtime</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'path'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">path</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'id'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">editor</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">ed</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">time</span><span class="p_operator">.</span><span class="p_identifier">sleep</span><span class="p_operator">(</span><span class="p_number">.1</span><span class="p_operator">)</span>
</div>
</div>
</div>
<div class="section" id="file-menu-methods">
<h3><a class="toc-backref" href="#id80" name="file-menu-methods">File menu methods</a></h3>
<div class="section" id="onnewlist">
<h4><a class="toc-backref" href="#id81" name="onnewlist">OnNewList</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnNewList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">event</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">hosts</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">LOCAL_HOST</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">hosts</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">LOCAL_HOST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSingleChoiceDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Databases'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Choose&nbsp;a&nbsp;database:'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">hosts</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCHOICEDLG_STYLE</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">GetStringSelection</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextEntryDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'What&nbsp;is&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;new&nbsp;table?'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Create&nbsp;Table'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;name&nbsp;FROM&nbsp;sqlite_master&nbsp;WHERE&nbsp;type='table'&nbsp;ORDER&nbsp;BY&nbsp;name"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SHOW&nbsp;tables"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">table</span><span class="p_operator">,)</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">msg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Table&nbsp;'%s'&nbsp;already&nbsp;exists"</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Duplicate&nbsp;Table"</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_ERROR</span><span class="p_operator">|</span><span class="p_identifier">wxOK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Are&nbsp;you&nbsp;sure&nbsp;you&nbsp;want&nbsp;to&nbsp;create&nbsp;Table&nbsp;'%s'?"</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Create&nbsp;Table?"</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_QUESTION</span><span class="p_operator">|</span><span class="p_identifier">wxYES_NO</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_YES</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateTable</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateNewNotebookPage</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#self.AddListControl(tab_title)&nbsp;#add&nbsp;listcontrol&nbsp;displays&nbsp;the&nbsp;list</span><span class="p_default"><br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#self.OnNewItem()</span><span class="p_default"><br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">62</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">63</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">64</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onfilelist">
<h4><a class="toc-backref" href="#id82" name="onfilelist">OnFileList</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnFileList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">path</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;there&nbsp;is&nbsp;no&nbsp;event,&nbsp;we&nbsp;got&nbsp;here&nbsp;through&nbsp;the&nbsp;start&nbsp;up&nbsp;loading&nbsp;of&nbsp;lists</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">fileNum</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_FILE1</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">path</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">filehistory</span><span class="p_operator">.</span><span class="p_identifier">GetHistoryFile</span><span class="p_operator">(</span><span class="p_identifier">fileNum</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'%s:%s'</span><span class="p_operator">%(</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;only&nbsp;need&nbsp;to&nbsp;check&nbsp;if&nbsp;table&nbsp;is&nbsp;open&nbsp;if&nbsp;this&nbsp;is&nbsp;not&nbsp;at&nbsp;startup</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">p</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">p</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">p</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">]:</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_string">"%s&nbsp;(%s)&nbsp;is&nbsp;already&nbsp;open!"</span><span class="p_operator">%(</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">host</span><span class="p_operator">),</span><span class="p_string">"List&nbsp;Open"</span><span class="p_operator">,</span><span class="p_identifier">wxICON_ERROR</span><span class="p_operator">|</span><span class="p_identifier">wxOK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'%s:%s'</span><span class="p_operator">%(</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SELECT&nbsp;name&nbsp;FROM&nbsp;sqlite_master&nbsp;WHERE&nbsp;name&nbsp;=&nbsp;'%s'"</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SHOW&nbsp;TABLES&nbsp;LIKE&nbsp;'%s'"</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">sql</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Table&nbsp;'%s'&nbsp;at&nbsp;host&nbsp;'%s'&nbsp;does&nbsp;not&nbsp;appear&nbsp;to&nbsp;exist!"</span><span class="p_operator">%(</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">host</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Table&nbsp;does&nbsp;not&nbsp;exist"</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_ERROR</span><span class="p_operator">|</span><span class="p_identifier">wxOK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateNewNotebookPage</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onopenlist">
<h4><a class="toc-backref" href="#id83" name="onopenlist">OnOpenList</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnOpenList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tree</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">hosts</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">LOCAL_HOST</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">hosts</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">LOCAL_HOST</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">hosts</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SELECT&nbsp;name&nbsp;FROM&nbsp;sqlite_master&nbsp;WHERE&nbsp;type='table'&nbsp;ORDER&nbsp;BY&nbsp;name"</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SHOW&nbsp;TABLES"</span><span class="p_default">&nbsp;</span><span class="p_commentline">#sorted</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">sql</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#excluding&nbsp;already&nbsp;open&nbsp;tables&nbsp;+&nbsp;'system'&nbsp;tables</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">excluded_tables</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">p</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">p</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">p</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">excluded_tables</span><span class="p_operator">.</span><span class="p_identifier">extend</span><span class="p_operator">([</span><span class="p_character">'user_sync'</span><span class="p_operator">,</span><span class="p_character">'sync'</span><span class="p_operator">,</span><span class="p_character">'owners'</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tables</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">t</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">t</span><span class="p_operator">,)</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">t</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">excluded_tables</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tree</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">tables</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">TreeDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Open&nbsp;List"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">tree</span><span class="p_operator">=</span><span class="p_identifier">tree</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sel</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetSelection</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItemText</span><span class="p_operator">(</span><span class="p_identifier">sel</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sel</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItemParent</span><span class="p_operator">(</span><span class="p_identifier">sel</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItemText</span><span class="p_operator">(</span><span class="p_identifier">sel</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">hosts</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_commentline">#takes&nbsp;care&nbsp;of&nbsp;highlighting&nbsp;root&nbsp;or&nbsp;hosts</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateNewNotebookPage</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="ondeletelist">
<h4><a class="toc-backref" href="#id84" name="ondeletelist">OnDeleteList</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnDeleteList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#ini&nbsp;controls&nbsp;whether&nbsp;the&nbsp;menu&nbsp;item&nbsp;is&nbsp;enabled</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;table&nbsp;is&nbsp;in&nbsp;SYNC_TABLES,&nbsp;should&nbsp;we&nbsp;make&nbsp;a&nbsp;point&nbsp;of&nbsp;that?</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Are&nbsp;you&nbsp;sure&nbsp;that&nbsp;you&nbsp;want&nbsp;to&nbsp;delete&nbsp;table&nbsp;%s&nbsp;(%s)?\n(Please&nbsp;note&nbsp;that&nbsp;you&nbsp;cannot&nbsp;recover&nbsp;it&nbsp;once&nbsp;it&nbsp;is&nbsp;deleted!)"</span><span class="p_operator">%(</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">host</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Delete&nbsp;Table..."</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_EXCLAMATION</span><span class="p_operator">|</span><span class="p_identifier">wxYES_NO</span><span class="p_operator">|</span><span class="p_identifier">wxNO_DEFAULT</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_NO</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'mysql'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Are&nbsp;you&nbsp;sure&nbsp;really&nbsp;really&nbsp;sure&nbsp;you&nbsp;want&nbsp;to&nbsp;delete&nbsp;table&nbsp;%s&nbsp;(%s)?\n(You&nbsp;really&nbsp;really&nbsp;cannot&nbsp;recover&nbsp;it&nbsp;once&nbsp;it&nbsp;is&nbsp;deleted)"</span><span class="p_operator">%(</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">host</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Delete&nbsp;Table..."</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_EXCLAMATION</span><span class="p_operator">|</span><span class="p_identifier">wxYES_NO</span><span class="p_operator">|</span><span class="p_identifier">wxNO_DEFAULT</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_NO</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"DROP&nbsp;TABLE&nbsp;%s"</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCloseList</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="oncloselist">
<h4><a class="toc-backref" href="#id85" name="oncloselist">OnCloseList</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnCloseList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">del</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">del</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">del</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">del</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">DeletePage</span><span class="p_operator">(</span><span class="p_identifier">L</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ln</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">ln</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="oncloseall">
<h4><a class="toc-backref" href="#id86" name="oncloseall">OnCloseAll</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnCloseAll</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">while</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCloseList</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#note&nbsp;that&nbsp;Clearing&nbsp;does&nbsp;set&nbsp;self.modified&nbsp;(eg&nbsp;{'name':1})</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onsaveastext">
<h4><a class="toc-backref" href="#id87" name="onsaveastext">OnSaveAsText</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnSaveAsText</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wildcard</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"txt&nbsp;files&nbsp;(*.txt)|*.txt|All&nbsp;files&nbsp;(*.*)|*.*"</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#dlg&nbsp;=&nbsp;wxFileDialog(self,&nbsp;"Save&nbsp;file",&nbsp;"",&nbsp;Properties['table'],&nbsp;wildcard,&nbsp;wxSAVE|wxOVERWRITE_PROMPT|wxCHANGE_DIR)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">body</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]):</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">body</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">body</span><span class="p_operator">+</span><span class="p_string">"%d.&nbsp;%s&nbsp;(%d)\n"</span><span class="p_operator">%(</span><span class="p_identifier">i</span><span class="p_operator">+</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">].</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">filename</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">re</span><span class="p_operator">.</span><span class="p_identifier">sub</span><span class="p_operator">(</span><span class="p_character">'[\\/:*"&lt;&gt;|\?]'</span><span class="p_operator">,</span><span class="p_character">'-'</span><span class="p_operator">,</span><span class="p_character">'%s-%s-%s'</span><span class="p_operator">%(</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_identifier">rdbms</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">))</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">filename</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">filename</span><span class="p_operator">[:</span><span class="p_number">50</span><span class="p_operator">]+</span><span class="p_character">'.txt'</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">path</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">DIRECTORY</span><span class="p_operator">,</span><span class="p_identifier">filename</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">file</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">,</span><span class="p_character">'w'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">write</span><span class="p_operator">(</span><span class="p_identifier">body</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">close</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">startfile</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetStatusText</span><span class="p_operator">(</span><span class="p_string">"Saved&nbsp;file&nbsp;%s"</span><span class="p_operator">%</span><span class="p_identifier">path</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onarchive">
<h4><a class="toc-backref" href="#id88" name="onarchive">OnArchive</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnArchive</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table_archive</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_character">'_archive'</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#need&nbsp;to&nbsp;test&nbsp;for&nbsp;existence&nbsp;of&nbsp;table_archive</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;name&nbsp;FROM&nbsp;sqlite_master&nbsp;WHERE&nbsp;type='table'&nbsp;ORDER&nbsp;BY&nbsp;name"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SHOW&nbsp;tables"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">table_archive</span><span class="p_operator">,)</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Do&nbsp;you&nbsp;want&nbsp;to&nbsp;create&nbsp;an&nbsp;archive&nbsp;for&nbsp;table&nbsp;%s&nbsp;(%s)"</span><span class="p_operator">%(</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">rdbms</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Create&nbsp;an&nbsp;archive..."</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_QUESTION</span><span class="p_operator">|</span><span class="p_identifier">wxYES_NO</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_operator">==</span><span class="p_identifier">wxID_YES</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateTable</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">table_archive</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">label1</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"In&nbsp;table&nbsp;%s&nbsp;(%s)&nbsp;\narchive&nbsp;all&nbsp;finished&nbsp;items&nbsp;older&nbsp;than:"</span><span class="p_operator">%(</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">rdbms</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">label2</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Archive&nbsp;all&nbsp;finished&nbsp;items"</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">FinishedDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Archive&nbsp;completed&nbsp;items"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">days</span><span class="p_operator">=</span><span class="p_number">7</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">spin_label</span><span class="p_operator">=</span><span class="p_identifier">label1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">check_label</span><span class="p_operator">=</span><span class="p_identifier">label2</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#dialogs&nbsp;and&nbsp;frames&nbsp;not&nbsp;destroyed&nbsp;right&nbsp;away&nbsp;to&nbsp;allow&nbsp;processing&nbsp;events,&nbsp;methods</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_operator">==</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">check</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;id,priority,name,createdate,finisheddate,duedate,owner1,owner2,owner3,note&nbsp;FROM&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;finisheddate&nbsp;IS&nbsp;NOT&nbsp;NULL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">days</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">today</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_default">&nbsp;</span><span class="p_identifier">int</span><span class="p_operator">(</span><span class="p_identifier">days</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;id,priority,name,createdate,finisheddate,duedate,owner1,owner2,owner3,note&nbsp;FROM&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;finisheddate&nbsp;&lt;&nbsp;%s"</span><span class="p_operator">,(</span><span class="p_identifier">date</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Archiving&nbsp;will&nbsp;remove&nbsp;%d&nbsp;records&nbsp;from&nbsp;%s.\nDo&nbsp;you&nbsp;want&nbsp;to&nbsp;proceed?"</span><span class="p_operator">%(</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">results</span><span class="p_operator">),</span><span class="p_identifier">table</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Proceed&nbsp;to&nbsp;archive..."</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_QUESTION</span><span class="p_operator">|</span><span class="p_identifier">wxYES_NO</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_NO</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">SYNC_TABLES</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">62</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">track_deletes</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">63</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">64</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;sync&nbsp;(id,action,table_name,name,timestamp)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s)"</span><span class="p_operator">,(</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_character">'d'</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_identifier">timestamp</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">65</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">66</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">track_deletes</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">67</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;sync&nbsp;(id,action,table_name,user,name)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s)"</span><span class="p_operator">,(</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_character">'d'</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">USER</span><span class="p_operator">,</span><span class="p_identifier">name</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">68</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">69</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">track_deletes</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">70</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">pass</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">71</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">72</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">73</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;the&nbsp;next&nbsp;line&nbsp;is&nbsp;necessary&nbsp;because&nbsp;pysqlite&nbsp;returns&nbsp;a&nbsp;tuple-like&nbsp;object&nbsp;that&nbsp;is&nbsp;not&nbsp;a&nbsp;tuple</span><span class="p_default"><br/>
</span><span class="p_number">74</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">tuple</span><span class="p_operator">(</span><span class="p_identifier">row</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">75</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">r</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">76</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">r</span><span class="p_operator">[</span><span class="p_number">2</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">77</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table_archive</span><span class="p_operator">+</span><span class="p_string">"&nbsp;&nbsp;(id,priority,name,createdate,finisheddate,duedate,owner1,owner2,owner3,note)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)"</span><span class="p_operator">,</span><span class="p_identifier">r</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">78</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table_archive</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">79</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"DELETE&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">80</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">track_deletes</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">81</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">82</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnRefresh</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">83</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">84</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Table&nbsp;%s&nbsp;had&nbsp;items&nbsp;older&nbsp;than&nbsp;%s&nbsp;days&nbsp;successfully&nbsp;archived"</span><span class="p_operator">%(</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">days</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">85</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Archiving&nbsp;successful..."</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">86</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_INFORMATION</span><span class="p_operator">|</span><span class="p_identifier">wxOK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">87</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span>
</div>
</div>
<div class="section" id="onworkoffline">
<h4><a class="toc-backref" href="#id89" name="onworkoffline">OnWorkOffline</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnWorkOffline</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">global</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">del</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">REMOTE_HOST</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">server</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">socket</span><span class="p_operator">.</span><span class="p_identifier">gethostbyname</span><span class="p_operator">(</span><span class="p_identifier">server</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Cannot&nbsp;connect&nbsp;to&nbsp;remote&nbsp;server!&nbsp;Will&nbsp;set&nbsp;to&nbsp;work&nbsp;offline."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"ListManager"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxOK</span><span class="p_operator">|</span><span class="p_identifier">wxICON_EXCLAMATION</span><span class="p_operator">|</span><span class="p_identifier">wxSTAY_ON_TOP</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">filemenu</span><span class="p_operator">.</span><span class="p_identifier">Check</span><span class="p_operator">(</span><span class="p_identifier">idOFFLINE</span><span class="p_operator">,</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>This method toggles whether we are working offline only or both on and offline.</p>
</div>
</div>
<div class="section" id="display-methods">
<h3><a class="toc-backref" href="#id90" name="display-methods">Display methods</a></h3>
<div class="section" id="onitemselected">
<h4><a class="toc-backref" href="#id91" name="onitemselected">OnItemSelected</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnItemSelected</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">GetIndex</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;really&nbsp;to&nbsp;catch&nbsp;self.curIdx&nbsp;=&nbsp;-1&nbsp;(see&nbsp;OnDelete&nbsp;and&nbsp;OnRefresh)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;could&nbsp;be&nbsp;moved&nbsp;out&nbsp;of&nbsp;if</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;could&nbsp;be&nbsp;moved&nbsp;out&nbsp;of&nbsp;if</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#note&nbsp;that&nbsp;Clearing&nbsp;does&nbsp;set&nbsp;self.modified&nbsp;(eg&nbsp;{'name':1})</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#SetValue(item.name)&nbsp;-&nbsp;if&nbsp;you&nbsp;use&nbsp;setvalue&nbsp;you&nbsp;don't&nbsp;get&nbsp;the&nbsp;font</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_character">';&nbsp;'</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetNote</span><span class="p_operator">(</span><span class="p_identifier">L</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">find</span><span class="p_operator">(</span><span class="p_string">"&lt;leo_file&gt;"</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">SetValue</span><span class="p_operator">(</span><span class="p_string">"Leo&nbsp;Outline"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">SetEditable</span><span class="p_operator">(</span><span class="p_identifier">False</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">SetValue</span><span class="p_operator">(</span><span class="p_identifier">note</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">SetEditable</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">EnsureVisible</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#writing&nbsp;to&nbsp;text&nbsp;widgets&nbsp;caused&nbsp;wxEVT_COMMAND_TEXT_UPDATED&nbsp;which&nbsp;is&nbsp;caught&nbsp;by&nbsp;EVT_TEXT,&nbsp;which&nbsp;updates&nbsp;self.modified</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">={}</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onitemactivated">
<h4><a class="toc-backref" href="#id92" name="onitemactivated">OnItemActivated</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnItemActivated</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"On&nbsp;Activated"</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onshowall">
<h4><a class="toc-backref" href="#id93" name="onshowall">OnShowAll</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnShowAll</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'showfinished'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'owner'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'*ALL'</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OLBox</span><span class="p_operator">.</span><span class="p_identifier">SetStringSelection</span><span class="p_operator">(</span><span class="p_character">'*ALL'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnRefresh</span><span class="p_operator">()</span>
</div>
</div>
<div class="section" id="onrefresh">
<h4><a class="toc-backref" href="#id94" name="onrefresh">OnRefresh</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnRefresh</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#OnItemSelected&nbsp;should&nbsp;be&nbsp;able&nbsp;to&nbsp;handle&nbsp;no&nbsp;items&nbsp;so&nbsp;this&nbsp;could&nbsp;be&nbsp;very&nbsp;short</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ReadFromDB</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateAndDisplayList</span><span class="p_operator">(</span><span class="p_identifier">results</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnItemSelected</span><span class="p_operator">()</span>
</div>
</div>
<div class="section" id="onfilterowners">
<h4><a class="toc-backref" href="#id95" name="onfilterowners">OnFilterOwners</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnFilterOwners</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sel</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">GetStringSelection</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">sel</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'owner'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">sel</span><span class="p_default"><br/>
</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnRefresh</span><span class="p_operator">()</span>
</div>
</div>
<div class="section" id="oncolumnclick-to-sort-columns">
<h4><a class="toc-backref" href="#id96" name="oncolumnclick-to-sort-columns">OnColumnClick (to sort columns)</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnColumnClick</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">col_num</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">GetColumn</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Sort</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'sort'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">attr2col</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prev_sort_attr</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Sort</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_character">'attribute'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#if&nbsp;this&nbsp;is&nbsp;the&nbsp;first&nbsp;sort&nbsp;Properties['sort']&nbsp;is&nbsp;{}</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#following&nbsp;is&nbsp;a&nbsp;little&nbsp;bit&nbsp;ugly&nbsp;but&nbsp;gets&nbsp;the&nbsp;key&nbsp;from&nbsp;the&nbsp;value,&nbsp;which&nbsp;is&nbsp;col_num</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Sort</span><span class="p_operator">[</span><span class="p_character">'attribute'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">attr2col</span><span class="p_operator">.</span><span class="p_identifier">keys</span><span class="p_operator">()[</span><span class="p_identifier">attr2col</span><span class="p_operator">.</span><span class="p_identifier">values</span><span class="p_operator">().</span><span class="p_identifier">index</span><span class="p_operator">(</span><span class="p_identifier">col_num</span><span class="p_operator">)]</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">prev_sort_attr</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">Sort</span><span class="p_operator">[</span><span class="p_character">'attribute'</span><span class="p_operator">]:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Sort</span><span class="p_operator">[</span><span class="p_character">'direction'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">Sort</span><span class="p_operator">[</span><span class="p_character">'direction'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Sort</span><span class="p_operator">[</span><span class="p_character">'direction'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnRefresh</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">ClearColumnImage</span><span class="p_operator">(</span><span class="p_identifier">attr2col</span><span class="p_operator">[</span><span class="p_character">'priority'</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">ClearColumnImage</span><span class="p_operator">(</span><span class="p_identifier">attr2col</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">img_num</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">arrows</span><span class="p_operator">[</span><span class="p_identifier">Sort</span><span class="p_operator">[</span><span class="p_character">'direction'</span><span class="p_operator">]]</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetColumnImage</span><span class="p_operator">(</span><span class="p_identifier">col_num</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">img_num</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onshowfinished">
<h4><a class="toc-backref" href="#id97" name="onshowfinished">OnShowFinished</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnShowFinished</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">label1</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Enter&nbsp;the&nbsp;number&nbsp;of&nbsp;days&nbsp;to&nbsp;retain\ncompleted&nbsp;tasks&nbsp;in&nbsp;the&nbsp;display:"</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">label2</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Show&nbsp;all&nbsp;finished&nbsp;items"</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">FinishedDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Display&nbsp;of&nbsp;completed&nbsp;items"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">days</span><span class="p_operator">=</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'showfinished'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">spin_label</span><span class="p_operator">=</span><span class="p_identifier">label1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">check_label</span><span class="p_operator">=</span><span class="p_identifier">label2</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()==</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">check</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">():</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'showfinished'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">days</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'showfinished'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">int</span><span class="p_operator">(</span><span class="p_identifier">days</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnRefresh</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="oncolumnrightclick-popup-to-change-date-displayed">
<h4><a class="toc-backref" href="#id98" name="oncolumnrightclick-popup-to-change-date-displayed">OnColumnRightClick (popup to change date displayed)</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnColumnRightClick</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">col</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">GetColumn</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">col</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">]:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#x,y&nbsp;=&nbsp;evt.GetPosition()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">datemenu</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMenu</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_operator">,</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">([</span><span class="p_character">'Create&nbsp;Date'</span><span class="p_operator">,</span><span class="p_character">'Last&nbsp;Modified'</span><span class="p_operator">,</span><span class="p_character">'Due&nbsp;Date'</span><span class="p_operator">,</span><span class="p_character">'Completion&nbsp;Date'</span><span class="p_operator">]):</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">datemenu</span><span class="p_operator">.</span><span class="p_identifier">Append</span><span class="p_operator">(</span><span class="p_number">200</span><span class="p_operator">+</span><span class="p_identifier">i</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_MENU</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">200</span><span class="p_operator">+</span><span class="p_identifier">i</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_word">lambda</span><span class="p_default">&nbsp;</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_operator">=</span><span class="p_identifier">i</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ChangeDateDisplayed</span><span class="p_operator">(</span><span class="p_identifier">e</span><span class="p_operator">,</span><span class="p_identifier">i</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetColumnWidth</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">)+</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetColumnWidth</span><span class="p_operator">(</span><span class="p_number">2</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetColumnWidth</span><span class="p_operator">(</span><span class="p_number">3</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PopupMenu</span><span class="p_operator">(</span><span class="p_identifier">datemenu</span><span class="p_operator">,(</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_number">40</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">datemenu</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="ondisplaydatecategory">
<h4><a class="toc-backref" href="#id99" name="ondisplaydatecategory">OnDisplayDateCategory</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnDisplayDateCategory</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSingleChoiceDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Date&nbsp;Display'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Choose&nbsp;a&nbsp;date&nbsp;to&nbsp;display:'</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">[</span><span class="p_character">'Create&nbsp;Date'</span><span class="p_operator">,</span><span class="p_character">'Last&nbsp;Modified'</span><span class="p_operator">,</span><span class="p_character">'Due&nbsp;Date'</span><span class="p_operator">,</span><span class="p_character">'Completion&nbsp;Date'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxOK</span><span class="p_operator">|</span><span class="p_identifier">wxCANCEL</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">GetSelection</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ChangeDateDisplayed</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">=</span><span class="p_identifier">idx</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="changedatedisplayed">
<h4><a class="toc-backref" href="#id100" name="changedatedisplayed">ChangeDateDisplayed</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">ChangeDateDisplayed</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_operator">=</span><span class="p_number">0</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">displaydate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_character">'createdate'</span><span class="p_operator">,</span><span class="p_character">'timestamp'</span><span class="p_operator">,</span><span class="p_character">'duedate'</span><span class="p_operator">,</span><span class="p_character">'finisheddate'</span><span class="p_operator">)[</span><span class="p_identifier">i</span><span class="p_operator">]</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">col_num</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">col_info</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetColumn</span><span class="p_operator">(</span><span class="p_identifier">col_num</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">col_info</span><span class="p_operator">.</span><span class="p_identifier">SetText</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">date_titles</span><span class="p_operator">[</span><span class="p_identifier">displaydate</span><span class="p_operator">])</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetColumn</span><span class="p_operator">(</span><span class="p_identifier">col_num</span><span class="p_operator">,</span><span class="p_identifier">col_info</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">DisplayList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#self.OnRefresh()&nbsp;#have&nbsp;gone&nbsp;back&nbsp;and&nbsp;forth&nbsp;but&nbsp;think&nbsp;that&nbsp;it&nbsp;should&nbsp;be&nbsp;self.DisplayList</span>
</div>
</div>
<div class="section" id="displaylist">
<h4><a class="toc-backref" href="#id101" name="displaylist">DisplayList</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">DisplayList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">List</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#OnPasteItems&nbsp;needs&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;have&nbsp;an&nbsp;L&nbsp;that&nbsp;is&nbsp;not&nbsp;self.L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCdate</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">format</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'%m/%d&nbsp;%H:%M:%S'</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">format</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'%m/%d/%y'</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">DeleteAllItems</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">(</span><span class="p_identifier">List</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">draw</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<div class="section" id="id3">
<h5><a class="toc-backref" href="#id102" name="id3">&lt;&lt; draw item &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">InsertImageStringItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">str</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">idx1</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_number">2</span><span class="p_operator">,</span><span class="p_character">';&nbsp;'</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">__dict__</span><span class="p_operator">[</span><span class="p_identifier">LCdate</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_number">3</span><span class="p_operator">,</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_identifier">format</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetImage</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">idx0</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#might&nbsp;just&nbsp;want&nbsp;generic&nbsp;number&nbsp;or&nbsp;greyed&nbsp;one&nbsp;two&nbsp;three</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItem</span><span class="p_operator">(</span><span class="p_identifier">LC_Item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">==</span><span class="p_number">2</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxBOLD</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">f</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#resetting&nbsp;weight</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItem</span><span class="p_operator">(</span><span class="p_identifier">LC_Item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">==</span><span class="p_number">3</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxBOLD</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">f</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#return&nbsp;to&nbsp;normal</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxRED</span><span class="p_operator">)</span>
</div>
</div>
</div>
</div>
<div class="section" id="printing-methods">
<h3><a class="toc-backref" href="#id103" name="printing-methods">Printing methods</a></h3>
<div class="section" id="onpagesetup">
<h4><a class="toc-backref" href="#id104" name="onpagesetup">OnPageSetup</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnPageSetup</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#need&nbsp;to&nbsp;pass&nbsp;printdata&nbsp;to&nbsp;tableprint</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">psdata</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPageSetupDialogData</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;if&nbsp;want&nbsp;to&nbsp;vary&nbsp;margins&nbsp;will&nbsp;need&nbsp;to&nbsp;save&nbsp;them&nbsp;as&nbsp;ivars&nbsp;and&nbsp;then&nbsp;set</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#psdata.SetMarginTopLeft((self.Left,self.Top))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">psdata</span><span class="p_operator">.</span><span class="p_identifier">EnableMargins</span><span class="p_operator">(</span><span class="p_identifier">False</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">psdata</span><span class="p_operator">.</span><span class="p_identifier">SetPrintData</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">printdata</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#gets&nbsp;Paper&nbsp;Orientation&nbsp;and&nbsp;PaperId&nbsp;info&nbsp;from&nbsp;printdata</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPageSetupDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">psdata</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">printdata</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">GetPageSetupData</span><span class="p_operator">().</span><span class="p_identifier">GetPrintData</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span>
</div>
</div>
<div class="section" id="onprint">
<h4><a class="toc-backref" href="#id105" name="onprint">OnPrint</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnPrint</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">prev</span><span class="p_operator">=</span><span class="p_identifier">False</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">showprtdlg</span><span class="p_operator">=</span><span class="p_identifier">True</span><span class="p_operator">):</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#???self.psdata&nbsp;=&nbsp;psdata</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">IList</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">PrintTable</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">printdata</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#self.printdata&nbsp;is&nbsp;the&nbsp;wxPrintData&nbsp;object&nbsp;with&nbsp;Orientation&nbsp;Info</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">font_name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">default_font_name</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">text_font</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{</span><span class="p_character">'Name'</span><span class="p_operator">:</span><span class="p_identifier">font_name</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Size'</span><span class="p_operator">:</span><span class="p_number">11</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Colour'</span><span class="p_operator">:[</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_character">'Attr'</span><span class="p_operator">:[</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">]}</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">label_font</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{</span><span class="p_character">'Name'</span><span class="p_operator">:</span><span class="p_identifier">font_name</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Size'</span><span class="p_operator">:</span><span class="p_number">12</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Colour'</span><span class="p_operator">:[</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_character">'Attr'</span><span class="p_operator">:[</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">]}</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">header_font</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{</span><span class="p_character">'Name'</span><span class="p_operator">:</span><span class="p_identifier">font_name</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Size'</span><span class="p_operator">:</span><span class="p_number">14</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Colour'</span><span class="p_operator">:[</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_character">'Attr'</span><span class="p_operator">:[</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">]}</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">row_def_line_colour</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">column_def_line_colour</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">left_margin</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0.5</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">data</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">(</span><span class="p_identifier">IList</span><span class="p_operator">):</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">data</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">([</span><span class="p_identifier">str</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_character">'%m/%d/%y'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_character">''</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_character">';&nbsp;'</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">([</span><span class="p_identifier">x</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">','</span><span class="p_operator">)[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">])])</span><span class="p_default">&nbsp;</span><span class="p_commentline">#just&nbsp;last&nbsp;names</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">SetCellText</span><span class="p_operator">(</span><span class="p_identifier">row</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">SetCellText</span><span class="p_operator">(</span><span class="p_identifier">row</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">SetCellText</span><span class="p_operator">(</span><span class="p_identifier">row</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">2</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">SetCellText</span><span class="p_operator">(</span><span class="p_identifier">row</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">3</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">data</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">data</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">label</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_character">'P'</span><span class="p_operator">,</span><span class="p_character">'Item'</span><span class="p_operator">,</span><span class="p_character">'Due'</span><span class="p_operator">,</span><span class="p_character">'Owner'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">printdata</span><span class="p_operator">.</span><span class="p_identifier">GetOrientation</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPORTRAIT</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">set_column</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_number">.2</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">.65</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">set_column</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_number">.2</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">7</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">.65</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1.5</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">title</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Table:&nbsp;%s&nbsp;&nbsp;&nbsp;Owner:&nbsp;%s&nbsp;&nbsp;&nbsp;&nbsp;"</span><span class="p_operator">%(</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">],</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'owner'</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">SetHeader</span><span class="p_operator">(</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">type</span><span class="p_operator">=</span><span class="p_character">'Date&nbsp;&amp;&nbsp;Time'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">align</span><span class="p_operator">=</span><span class="p_identifier">wxALIGN_LEFT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">indent</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1.5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">SetFooter</span><span class="p_operator">(</span><span class="p_string">"Page&nbsp;No&nbsp;"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">type</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_string">"Num"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">prev</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">Preview</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">prt</span><span class="p_operator">.</span><span class="p_identifier">Print</span><span class="p_operator">(</span><span class="p_identifier">prompt</span><span class="p_operator">=</span><span class="p_identifier">showprtdlg</span><span class="p_operator">)</span>
</div>
</div>
</div>
<div class="section" id="exiting-methods">
<h3><a class="toc-backref" href="#id106" name="exiting-methods">Exiting methods</a></h3>
<div class="section" id="onwindowexit">
<h4><a class="toc-backref" href="#id107" name="onwindowexit">OnWindowExit</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnWindowExit</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#this&nbsp;is&nbsp;called&nbsp;if&nbsp;you&nbsp;close&nbsp;the&nbsp;ListManager&nbsp;Window&nbsp;with&nbsp;the&nbsp;X</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">CanVeto</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnExit</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">Skip</span><span class="p_operator">()</span>
</div>
</div>
<div class="section" id="onexit">
<h4><a class="toc-backref" href="#id108" name="onexit">OnExit</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnExit</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">event</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default">&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">save</span><span class="p_default">&nbsp;</span><span class="p_identifier">configuration</span><span class="p_default">&nbsp;</span><span class="p_identifier">file</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sys</span><span class="p_operator">.</span><span class="p_identifier">stderr</span><span class="p_operator">.</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#destroys&nbsp;the&nbsp;error&nbsp;dialog;&nbsp;need&nbsp;to&nbsp;do&nbsp;this&nbsp;to&nbsp;shut&nbsp;down&nbsp;correctly</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_commentline">#only&nbsp;reason&nbsp;to&nbsp;check&nbsp;is&nbsp;if&nbsp;closed&nbsp;before&nbsp;ModifierDialog&nbsp;is&nbsp;constructed</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ModifierDialog</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Close</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">)</span>
</div>
<div class="section" id="save-configuration-file">
<h5><a class="toc-backref" href="#id109" name="save-configuration-file">&lt;&lt;save configuration file&gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">remove_section</span><span class="p_operator">(</span><span class="p_character">'Files'</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">add_section</span><span class="p_operator">(</span><span class="p_string">"Files"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_identifier">y</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetSizeTuple</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">set</span><span class="p_operator">(</span><span class="p_character">'Configuration'</span><span class="p_operator">,</span><span class="p_character">'x'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">str</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">set</span><span class="p_operator">(</span><span class="p_character">'Configuration'</span><span class="p_operator">,</span><span class="p_character">'y'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">str</span><span class="p_operator">(</span><span class="p_identifier">y</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">numfiles</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">filehistory</span><span class="p_operator">.</span><span class="p_identifier">GetNoHistoryFiles</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">n</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">range</span><span class="p_operator">(</span><span class="p_identifier">numfiles</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">set</span><span class="p_operator">(</span><span class="p_string">"Files"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"path%d"</span><span class="p_operator">%</span><span class="p_identifier">n</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">filehistory</span><span class="p_operator">.</span><span class="p_identifier">GetHistoryFile</span><span class="p_operator">(</span><span class="p_identifier">n</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#you&nbsp;have&nbsp;to&nbsp;give&nbsp;ConfigParser&nbsp;a&nbsp;writable&nbsp;object</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cfile</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">file</span><span class="p_operator">(</span><span class="p_identifier">config_file</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'w'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cp</span><span class="p_operator">.</span><span class="p_identifier">write</span><span class="p_operator">(</span><span class="p_identifier">cfile</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cfile</span><span class="p_operator">.</span><span class="p_identifier">close</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_default">&nbsp;</span><span class="p_identifier">IOError</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"The&nbsp;configuration&nbsp;file&nbsp;can't&nbsp;be&nbsp;written!"</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">time</span><span class="p_operator">.</span><span class="p_identifier">sleep</span><span class="p_operator">(</span><span class="p_number">10</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#so&nbsp;you&nbsp;can&nbsp;see&nbsp;that&nbsp;there&nbsp;was&nbsp;a&nbsp;problem</span>
</div>
</div>
</div>
</div>
<div class="section" id="find-methods">
<h3><a class="toc-backref" href="#id110" name="find-methods">Find methods</a></h3>
<div class="section" id="onfind">
<h4><a class="toc-backref" href="#id111" name="onfind">OnFind</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnFind</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindDialog</span><span class="p_operator">.</span><span class="p_identifier">Show</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindDialog</span><span class="p_operator">.</span><span class="p_identifier">FindText</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindDialog</span><span class="p_operator">.</span><span class="p_identifier">FindText</span><span class="p_operator">.</span><span class="p_identifier">SetFocus</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="findstring">
<h4><a class="toc-backref" href="#id112" name="findstring">FindString</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">FindString</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pat</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindDialog</span><span class="p_operator">.</span><span class="p_identifier">FindText</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">likepat</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">r"'%"</span><span class="p_operator">+</span><span class="p_identifier">pat</span><span class="p_operator">+</span><span class="p_string">r"%'"</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">finished</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindDialog</span><span class="p_operator">.</span><span class="p_identifier">SearchFinished</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">notes</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindDialog</span><span class="p_operator">.</span><span class="p_identifier">SearchNotes</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">finished</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"WHERE&nbsp;"</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"WHERE&nbsp;finisheddate&nbsp;IS&nbsp;NULL&nbsp;AND&nbsp;"</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">notes</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">SELECT</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SELECT&nbsp;priority,name,createdate,finisheddate,duedate,owner1,owner2,owner3,id,timestamp,note&nbsp;FROM&nbsp;%s&nbsp;"</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_string">"(name&nbsp;LIKE&nbsp;%s&nbsp;OR&nbsp;note&nbsp;LIKE&nbsp;%s)&nbsp;ORDER&nbsp;BY&nbsp;timestamp&nbsp;DESC"</span><span class="p_operator">%(</span><span class="p_identifier">likepat</span><span class="p_operator">,</span><span class="p_identifier">likepat</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">SELECT</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SELECT&nbsp;priority,name,createdate,finisheddate,duedate,owner1,owner2,owner3,id,timestamp&nbsp;FROM&nbsp;%s&nbsp;"</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_string">"name&nbsp;LIKE&nbsp;%s&nbsp;ORDER&nbsp;BY&nbsp;timestamp&nbsp;DESC"</span><span class="p_operator">%</span><span class="p_identifier">likepat</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">SELECT</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">sql</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Cannot&nbsp;read&nbsp;%s:&nbsp;%s"</span><span class="p_operator">%(</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">],</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">case</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindDialog</span><span class="p_operator">.</span><span class="p_identifier">MatchCase</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">whole</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindDialog</span><span class="p_operator">.</span><span class="p_identifier">MatchWhole</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">whole</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pat</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'\\b%s\\b'</span><span class="p_operator">%</span><span class="p_identifier">pat</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">case</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">re</span><span class="p_operator">.</span><span class="p_identifier">compile</span><span class="p_operator">(</span><span class="p_identifier">pat</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_identifier">re</span><span class="p_operator">.</span><span class="p_identifier">compile</span><span class="p_operator">(</span><span class="p_identifier">pat</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">re</span><span class="p_operator">.</span><span class="p_identifier">I</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">notes</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">re</span><span class="p_operator">.</span><span class="p_identifier">search</span><span class="p_operator">(</span><span class="p_identifier">z</span><span class="p_operator">,</span><span class="p_identifier">x</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">])</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_identifier">re</span><span class="p_operator">.</span><span class="p_identifier">search</span><span class="p_operator">(</span><span class="p_identifier">z</span><span class="p_operator">,</span><span class="p_identifier">x</span><span class="p_operator">[</span><span class="p_number">10</span><span class="p_operator">])]</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">re</span><span class="p_operator">.</span><span class="p_identifier">search</span><span class="p_operator">(</span><span class="p_identifier">z</span><span class="p_operator">,</span><span class="p_identifier">x</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">])]</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]=</span><span class="p_default">&nbsp;</span><span class="p_identifier">IList</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateAndDisplayList</span><span class="p_operator">(</span><span class="p_identifier">results</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">col_num</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">col_info</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetColumn</span><span class="p_operator">(</span><span class="p_identifier">col_num</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">col_info</span><span class="p_operator">.</span><span class="p_identifier">SetText</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">date_titles</span><span class="p_operator">[</span><span class="p_character">'timestamp'</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetColumn</span><span class="p_operator">(</span><span class="p_identifier">col_num</span><span class="p_operator">,</span><span class="p_identifier">col_info</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">IList</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default"><br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">62</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">63</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">64</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnItemSelected</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">65</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">66</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'sort'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{</span><span class="p_character">'direction'</span><span class="p_operator">:</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_character">'attribute'</span><span class="p_operator">:</span><span class="p_character">'date'</span><span class="p_operator">}</span><span class="p_default"><br/>
</span><span class="p_number">67</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'owner'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'*ALL'</span><span class="p_default"><br/>
</span><span class="p_number">68</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">69</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owner_idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">GetSelection</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">70</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner_idx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">71</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OwnerLBoxes</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">SetSelection</span><span class="p_operator">(</span><span class="p_identifier">owner_idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#get&nbsp;exception&nbsp;if&nbsp;index&nbsp;=&nbsp;-1</span><span class="p_default"><br/>
</span><span class="p_number">72</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">73</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetStatusText</span><span class="p_operator">(</span><span class="p_string">"Found&nbsp;%d&nbsp;items"</span><span class="p_operator">%</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">IList</span><span class="p_operator">))</span>
</div>
</div>
<div class="section" id="findnode">
<h4><a class="toc-backref" href="#id113" name="findnode">FindNode</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">FindNode</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">showfinished</span><span class="p_operator">=</span><span class="p_identifier">True</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'owner'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'*ALL'</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'showfinished'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">showfinished</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">IList</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">CreateAndDisplayList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ReadFromDB</span><span class="p_operator">())</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">IList</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_operator">+=</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">break</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default">&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">EnsureVisible</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="database-related-methods">
<h3><a class="toc-backref" href="#id114" name="database-related-methods">Database-related methods</a></h3>
<div class="section" id="getcursor">
<h4><a class="toc-backref" href="#id115" name="getcursor">GetCursor</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">.</span><span class="p_identifier">get</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">db</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">DIRECTORY</span><span class="p_operator">,</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_identifier">DB</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Con</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">sqlite</span><span class="p_operator">.</span><span class="p_identifier">connect</span><span class="p_operator">(</span><span class="p_identifier">db</span><span class="p_operator">=</span><span class="p_identifier">db</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">autocommit</span><span class="p_operator">=</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Con</span><span class="p_operator">.</span><span class="p_identifier">cursor</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">sqlite_connections</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">Con</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#getting&nbsp;a&nbsp;weak&nbsp;reference&nbsp;error&nbsp;from&nbsp;PySQLite&nbsp;and&nbsp;this&nbsp;makes&nbsp;it&nbsp;go&nbsp;away</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Could&nbsp;not&nbsp;connect&nbsp;to&nbsp;SQLite&nbsp;database&nbsp;at&nbsp;%s"</span><span class="p_operator">%</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Connection&nbsp;problem!"</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_ERROR</span><span class="p_operator">|</span><span class="p_identifier">wxOK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Con</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">MySQLdb</span><span class="p_operator">.</span><span class="p_identifier">connect</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">=</span><span class="p_identifier">location</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">user</span><span class="p_operator">=</span><span class="p_identifier">USER</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">passwd</span><span class="p_operator">=</span><span class="p_identifier">PW</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">db</span><span class="p_operator">=</span><span class="p_identifier">DB</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Con</span><span class="p_operator">.</span><span class="p_identifier">cursor</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"host&nbsp;=&nbsp;%s&nbsp;|&nbsp;user&nbsp;=&nbsp;%s&nbsp;|&nbsp;password&nbsp;=&nbsp;%s****&nbsp;|&nbsp;db&nbsp;=&nbsp;%s&nbsp;-&nbsp;could&nbsp;not&nbsp;connect!"</span><span class="p_operator">%(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_identifier">USER</span><span class="p_operator">,</span><span class="p_identifier">PW</span><span class="p_operator">[:</span><span class="p_number">3</span><span class="p_operator">],</span><span class="p_identifier">DB</span><span class="p_operator">),</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_string">"Connection&nbsp;problem"</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxICON_ERROR</span><span class="p_operator">|</span><span class="p_identifier">wxOK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="getnote">
<h4><a class="toc-backref" href="#id116" name="getnote">GetNote</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">GetNote</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_character">''</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]]</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;note&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentblock">######&nbsp;Debug&nbsp;--&nbsp;this&nbsp;does&nbsp;happen&nbsp;where&nbsp;note&nbsp;brings&nbsp;back&nbsp;None&nbsp;053003</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"In&nbsp;GetNote&nbsp;-&gt;&nbsp;SELECT&nbsp;should&nbsp;not&nbsp;bring&nbsp;back&nbsp;None"</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt;&nbsp;item.id="</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">z</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_word">None</span><span class="p_operator">,)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">z</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">''</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">note</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="createtable">
<h4><a class="toc-backref" href="#id117" name="createtable">CreateTable</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">CreateTable</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">rdbms</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_tripledouble">"""CREATE&nbsp;TABLE&nbsp;'%s'&nbsp;('id'&nbsp;varchar(36)&nbsp;PRIMARY&nbsp;KEY,<br/>
&nbsp;6&nbsp;&nbsp;'priority'&nbsp;int(1),<br/>
&nbsp;7&nbsp;&nbsp;'name'&nbsp;varchar(150),<br/>
&nbsp;8&nbsp;&nbsp;'createdate'&nbsp;datetime,<br/>
&nbsp;9&nbsp;&nbsp;'finisheddate'&nbsp;date,<br/>
10&nbsp;&nbsp;'duedate'&nbsp;date,<br/>
11&nbsp;&nbsp;'owner1'&nbsp;varchar(25),<br/>
12&nbsp;&nbsp;'owner2'&nbsp;varchar(25),<br/>
13&nbsp;&nbsp;'owner3'&nbsp;varchar(25),<br/>
14&nbsp;&nbsp;'note'&nbsp;text,<br/>
15&nbsp;&nbsp;'timestamp'&nbsp;timestamp(14))"""</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_tripledouble">"""CREATE&nbsp;TABLE&nbsp;`%s`&nbsp;(`id`&nbsp;varchar(36)&nbsp;NOT&nbsp;NULL&nbsp;default&nbsp;'',<br/>
18&nbsp;&nbsp;`priority`&nbsp;int(1)&nbsp;NOT&nbsp;NULL&nbsp;default&nbsp;'1',<br/>
19&nbsp;&nbsp;`name`&nbsp;varchar(150)&nbsp;NOT&nbsp;NULL&nbsp;default&nbsp;'',<br/>
20&nbsp;&nbsp;`createdate`&nbsp;datetime&nbsp;NOT&nbsp;NULL&nbsp;default&nbsp;'0000-00-00&nbsp;00:00:00',<br/>
21&nbsp;&nbsp;`finisheddate`&nbsp;date&nbsp;default&nbsp;'0000-00-00',<br/>
22&nbsp;&nbsp;`duedate`&nbsp;date&nbsp;default&nbsp;'0000-00-00',<br/>
23&nbsp;&nbsp;`owner1`&nbsp;varchar(25)&nbsp;default&nbsp;'',<br/>
24&nbsp;&nbsp;`owner2`&nbsp;varchar(25)&nbsp;default&nbsp;'',<br/>
25&nbsp;&nbsp;`owner3`&nbsp;varchar(25)&nbsp;default&nbsp;'',<br/>
26&nbsp;&nbsp;`note`&nbsp;text,<br/>
27&nbsp;&nbsp;`timestamp`&nbsp;timestamp(14)&nbsp;NOT&nbsp;NULL,PRIMARY&nbsp;KEY&nbsp;&nbsp;(`id`))&nbsp;TYPE=MyISAM"""</span><span class="p_operator">%</span><span class="p_identifier">table</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">sql</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="readfromdb-returns-db-results">
<h4><a class="toc-backref" href="#id118" name="readfromdb-returns-db-results">ReadFromDB (returns db results)</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">ReadFromDB</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'owner'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'*ALL'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'WHERE&nbsp;(owner1&nbsp;=&nbsp;"%s"&nbsp;OR&nbsp;owner2&nbsp;=&nbsp;"%s"&nbsp;OR&nbsp;owner3&nbsp;=&nbsp;"%s")'</span><span class="p_operator">%(</span><span class="p_identifier">owner</span><span class="p_operator">,</span><span class="p_identifier">owner</span><span class="p_operator">,</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#-1&nbsp;show&nbsp;them&nbsp;all;&nbsp;0&nbsp;show&nbsp;none;&nbsp;integer&nbsp;show&nbsp;for&nbsp;that&nbsp;many&nbsp;days</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">days</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'showfinished'</span><span class="p_operator">]</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">days</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">days</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_default">&nbsp;</span><span class="p_identifier">days</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">t</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"(finisheddate&nbsp;IS&nbsp;NULL&nbsp;OR&nbsp;finisheddate&nbsp;&gt;&nbsp;'%s')"</span><span class="p_operator">%</span><span class="p_identifier">date</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">t</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"finisheddate&nbsp;IS&nbsp;NULL"</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"%s&nbsp;AND&nbsp;%s"</span><span class="p_operator">%(</span><span class="p_identifier">WHERE</span><span class="p_operator">,</span><span class="p_identifier">t</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"&nbsp;WHERE&nbsp;%s"</span><span class="p_operator">%</span><span class="p_identifier">t</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Sort</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'sort'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Sort</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sort_attr</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Sort</span><span class="p_operator">[</span><span class="p_character">'attribute'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">sort_attr</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'date'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sort_attr</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">sort_attr</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'owners'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sort_attr</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'owner1'</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_string">"&nbsp;ORDER&nbsp;BY&nbsp;"</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_identifier">sort_attr</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;not&nbsp;direction:&nbsp;WHERE&nbsp;=&nbsp;WHERE&nbsp;+&nbsp;"&nbsp;DESC"&nbsp;&nbsp;&nbsp;works&nbsp;because&nbsp;ASC&nbsp;is&nbsp;the&nbsp;default</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">Sort</span><span class="p_operator">[</span><span class="p_character">'direction'</span><span class="p_operator">]:</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">WHERE</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_string">"&nbsp;DESC"</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sql</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"SELECT&nbsp;priority,name,createdate,finisheddate,duedate,owner1,owner2,owner3,id,timestamp&nbsp;FROM&nbsp;%s&nbsp;%s"</span><span class="p_operator">%(</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_identifier">WHERE</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_identifier">sql</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Cannot&nbsp;read&nbsp;%s:&nbsp;%s"</span><span class="p_operator">%(</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">],</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default">&nbsp;</span><span class="p_commentline">#[]</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="createanddisplaylist-returns-item-list">
<h4><a class="toc-backref" href="#id119" name="createanddisplaylist-returns-item-list">CreateAndDisplayList (returns Item List)</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">CreateAndDisplayList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">results</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCdate</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">format</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'%m/%d&nbsp;%H:%M:%S'</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">format</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'%m/%d/%y'</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">itemlist</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">DeleteAllItems</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">Item</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_word">pass</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_identifier">row</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">(</span><span class="p_identifier">results</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Item</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">assign</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_identifier">attributes</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">itemlist</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">draw</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">itemlist</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<div class="section" id="assign-item-attributes">
<h5><a class="toc-backref" href="#id120" name="assign-item-attributes">&lt;&lt; assign item attributes &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">int</span><span class="p_operator">(</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">0</span><span class="p_operator">])</span><span class="p_default">&nbsp;</span><span class="p_commentline">#int(row[0])&nbsp;needs&nbsp;int&nbsp;because&nbsp;it&nbsp;seems&nbsp;to&nbsp;come&nbsp;back&nbsp;as&nbsp;a&nbsp;long&nbsp;from&nbsp;MySQL</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">2</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">3</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">4</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">y</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">y</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">5</span><span class="p_operator">:</span><span class="p_number">8</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">y</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_commentline">#if&nbsp;you&nbsp;carry&nbsp;around&nbsp;['tom',None,None]&nbsp;Note&nbsp;this&nbsp;is&nbsp;5:8&nbsp;not&nbsp;5:7</span><span class="p_default"><br/>
</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">8</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">[</span><span class="p_number">9</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="id4">
<h5><a class="toc-backref" href="#id121" name="id4">&lt;&lt; draw item &gt;&gt;</a></h5>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">InsertImageStringItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">str</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">idx1</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_number">2</span><span class="p_operator">,</span><span class="p_character">';&nbsp;'</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">__dict__</span><span class="p_operator">[</span><span class="p_identifier">LCdate</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">,</span><span class="p_number">3</span><span class="p_operator">,</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_identifier">format</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_word">or</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetImage</span><span class="p_operator">(</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">idx0</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#might&nbsp;just&nbsp;want&nbsp;generic&nbsp;number&nbsp;or&nbsp;greyed&nbsp;one&nbsp;two&nbsp;three</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxLIGHT_GREY</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItem</span><span class="p_operator">(</span><span class="p_identifier">LC_Item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">==</span><span class="p_number">2</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxBOLD</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">f</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#resetting&nbsp;weight</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItem</span><span class="p_operator">(</span><span class="p_identifier">LC_Item</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">==</span><span class="p_number">3</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">GetItem</span><span class="p_operator">(</span><span class="p_identifier">x</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">LC_font</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxBOLD</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetFont</span><span class="p_operator">(</span><span class="p_identifier">f</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">SetWeight</span><span class="p_operator">(</span><span class="p_identifier">wxNORMAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#return&nbsp;to&nbsp;normal</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LC_Item</span><span class="p_operator">.</span><span class="p_identifier">SetTextColour</span><span class="p_operator">(</span><span class="p_identifier">wxRED</span><span class="p_operator">)</span>
</div>
</div>
</div>
<div class="section" id="onsync">
<h4><a class="toc-backref" href="#id122" name="onsync">OnSync</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnSync</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#Note&nbsp;that&nbsp;the&nbsp;results&nbsp;of&nbsp;an&nbsp;sqlite&nbsp;query&nbsp;are&nbsp;an&nbsp;instance&nbsp;that&nbsp;you&nbsp;need&nbsp;to&nbsp;turn&nbsp;into&nbsp;a&nbsp;tuple&nbsp;or&nbsp;MySQL&nbsp;gets&nbsp;unhappy</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"You&nbsp;need&nbsp;to&nbsp;be&nbsp;online&nbsp;to&nbsp;synchronize!"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxOK</span><span class="p_operator">|</span><span class="p_identifier">wxICON_ERROR</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_string">"Synchronize&nbsp;Table(s):&nbsp;"</span><span class="p_operator">+</span><span class="p_string">"&nbsp;and&nbsp;"</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">SYNC_TABLES</span><span class="p_operator">),</span><span class="p_string">"Synchronize..."</span><span class="p_operator">,</span><span class="p_identifier">wxICON_QUESTION</span><span class="p_operator">|</span><span class="p_identifier">wxYES_NO</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_NO</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"There&nbsp;doesn't&nbsp;appear&nbsp;to&nbsp;be&nbsp;a&nbsp;Remote&nbsp;Server"</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">LOCAL_HOST</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"There&nbsp;doesn't&nbsp;appear&nbsp;to&nbsp;be&nbsp;a&nbsp;Local&nbsp;Server"</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"LOCAL_HOST="</span><span class="p_operator">,</span><span class="p_identifier">LOCAL_HOST</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"REMOTE_HOST="</span><span class="p_operator">,</span><span class="p_identifier">REMOTE_HOST</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">REMOTE_HOST</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Couldn't&nbsp;get&nbsp;a&nbsp;cursor&nbsp;for&nbsp;%s"</span><span class="p_operator">%</span><span class="p_identifier">REMOTE_HOST</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetCursor</span><span class="p_operator">(</span><span class="p_identifier">LOCAL_HOST</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Couldn't&nbsp;get&nbsp;a&nbsp;cursor&nbsp;for&nbsp;%s"</span><span class="p_operator">%</span><span class="p_identifier">LOCAL_HOST</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;moving&nbsp;the&nbsp;sync&nbsp;time&nbsp;back&nbsp;a&nbsp;second&nbsp;to&nbsp;make&nbsp;sure&nbsp;that&nbsp;we&nbsp;don't&nbsp;lose&nbsp;track&nbsp;of&nbsp;any&nbsp;nodes</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#that&nbsp;are&nbsp;being&nbsp;updated&nbsp;or&nbsp;inserted&nbsp;at&nbsp;the&nbsp;same&nbsp;time&nbsp;as&nbsp;we&nbsp;are&nbsp;syncing</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;NOW()"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_now</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()-</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">oneSecond</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_now</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()[</span><span class="p_number">0</span><span class="p_operator">]-</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">oneSecond</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#because&nbsp;of&nbsp;some&nbsp;inconsistent&nbsp;rounding&nbsp;appears&nbsp;necessary&nbsp;to&nbsp;make&nbsp;sure&nbsp;the&nbsp;sqlite&nbsp;timestamp&nbsp;is&nbsp;less&nbsp;than&nbsp;l_now</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#having&nbsp;seen&nbsp;same&nbsp;issue&nbsp;for&nbsp;mysql&nbsp;but&nbsp;for&nbsp;consistency&nbsp;(and&nbsp;because&nbsp;sqlite&nbsp;could&nbsp;also&nbsp;be&nbsp;"server"&nbsp;rdbms</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_ts</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_now</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">DateTimeDelta</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_number">0.02</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_ts</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_now</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">DateTimeDelta</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_number">0.02</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"l_now="</span><span class="p_operator">,</span><span class="p_identifier">l_now</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"l_ts&nbsp;="</span><span class="p_operator">,</span><span class="p_identifier">l_ts</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"r_now="</span><span class="p_operator">,</span><span class="p_identifier">r_now</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"r_ts="</span><span class="p_operator">,</span><span class="p_identifier">r_ts</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;MAX(last_sync)&nbsp;FROM&nbsp;user_sync&nbsp;WHERE&nbsp;user&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">USER</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_last_sync</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"last&nbsp;sync&nbsp;(remote&nbsp;time)&nbsp;="</span><span class="p_operator">,</span><span class="p_identifier">r_last_sync</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;MAX(last_sync)&nbsp;FROM&nbsp;user_sync"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_last_sync</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_commentline">#note&nbsp;MAX&nbsp;returns&nbsp;a&nbsp;string&nbsp;with&nbsp;sqlite&nbsp;so&nbsp;we&nbsp;turn&nbsp;it&nbsp;make&nbsp;into&nbsp;DateTime</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_last_sync</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">DateTimeFrom</span><span class="p_operator">(</span><span class="p_identifier">l_last_sync</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"last&nbsp;sync&nbsp;(local&nbsp;time)&nbsp;="</span><span class="p_operator">,</span><span class="p_identifier">l_last_sync</span><span class="p_default"><br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">SYNC_TABLES</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;Need&nbsp;to&nbsp;pick&nbsp;up&nbsp;changes&nbsp;for&nbsp;both&nbsp;so&nbsp;syncing&nbsp;one&nbsp;doesn't&nbsp;add&nbsp;new&nbsp;things&nbsp;and&nbsp;screw&nbsp;up&nbsp;the&nbsp;second&nbsp;sync</span><span class="p_default"><br/>
</span><span class="p_number">62</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Checking&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;on&nbsp;the&nbsp;Remote&nbsp;Server;&nbsp;changes&nbsp;(excluding&nbsp;deletes)&nbsp;are:"</span><span class="p_default"><br/>
</span><span class="p_number">63</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;id,createdate&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;timestamp&nbsp;&gt;&nbsp;%s&nbsp;AND&nbsp;timestamp&nbsp;&lt;=&nbsp;%s"</span><span class="p_operator">,(</span><span class="p_identifier">r_last_sync</span><span class="p_operator">,</span><span class="p_identifier">r_now</span><span class="p_operator">))</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">64</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">65</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Server&nbsp;changes&nbsp;(excluding&nbsp;deletes)"</span><span class="p_default"><br/>
</span><span class="p_number">66</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_results</span><span class="p_default"><br/>
</span><span class="p_number">67</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">68</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Checking&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;on&nbsp;Local;&nbsp;changes&nbsp;(excluding&nbsp;deletes)&nbsp;are:"</span><span class="p_default"><br/>
</span><span class="p_number">69</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;id,createdate&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;timestamp&nbsp;&gt;&nbsp;%s&nbsp;AND&nbsp;timestamp&nbsp;&lt;=&nbsp;%s"</span><span class="p_operator">,(</span><span class="p_identifier">l_last_sync</span><span class="p_operator">,</span><span class="p_identifier">l_now</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">70</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">71</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Local&nbsp;changes&nbsp;(excluding&nbsp;deletes)"</span><span class="p_default"><br/>
</span><span class="p_number">72</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_results</span><span class="p_default"><br/>
</span><span class="p_number">73</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">74</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_results</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">75</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;priority,name,owner1,owner2,owner3,createdate,finisheddate,duedate,note,id&nbsp;FROM&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;ID&nbsp;=&nbsp;%s"</span><span class="p_operator">,(</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">76</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">row</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">77</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">78</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_last_sync</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">79</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;(priority,name,owner1,owner2,owner3,createdate,finisheddate,duedate,note,id)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#*row&nbsp;also&nbsp;works</span><span class="p_default"><br/>
</span><span class="p_number">80</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Created&nbsp;%s&nbsp;in&nbsp;%s&nbsp;on&nbsp;Local"</span><span class="p_operator">%(</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">81</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">82</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;priority&nbsp;=&nbsp;%s,&nbsp;name&nbsp;=%s,&nbsp;owner1&nbsp;=&nbsp;%s,&nbsp;owner2&nbsp;=&nbsp;%s,&nbsp;owner3&nbsp;=&nbsp;%s,&nbsp;createdate&nbsp;=&nbsp;%s,&nbsp;finisheddate&nbsp;=&nbsp;%s,&nbsp;duedate&nbsp;=&nbsp;%s,&nbsp;note&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">83</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Updated&nbsp;%s&nbsp;in&nbsp;%s&nbsp;on&nbsp;Local"</span><span class="p_operator">%(</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">84</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;for&nbsp;reasons&nbsp;I&nbsp;don't&nbsp;understand&nbsp;l_now&nbsp;here&nbsp;is&nbsp;a&nbsp;1/100&nbsp;ahead&nbsp;of&nbsp;l_now&nbsp;when&nbsp;inserted&nbsp;into&nbsp;user_sync</span><span class="p_default"><br/>
</span><span class="p_number">85</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;timestamp&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">l_ts</span><span class="p_operator">,</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">86</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">87</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_results</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">88</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;priority,name,owner1,owner2,owner3,createdate,finisheddate,duedate,note,id&nbsp;FROM&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;ID&nbsp;=&nbsp;%s"</span><span class="p_operator">,(</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">89</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">row</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">90</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">91</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">row</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">tuple</span><span class="p_operator">(</span><span class="p_identifier">row</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">92</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#above&nbsp;needed&nbsp;because&nbsp;sqlite&nbsp;returns&nbsp;an&nbsp;enhanced&nbsp;tuple-like&nbsp;object&nbsp;that&nbsp;is&nbsp;not&nbsp;a&nbsp;tuple</span><span class="p_default"><br/>
</span><span class="p_number">93</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_last_sync</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">94</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;(priority,name,owner1,owner2,owner3,createdate,finisheddate,duedate,note,id)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s,%s,%s,%s,%s,%s)"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">95</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Created&nbsp;%s&nbsp;in&nbsp;%s&nbsp;on&nbsp;Server"</span><span class="p_operator">%(</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">96</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">97</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;priority&nbsp;=&nbsp;%s,&nbsp;name&nbsp;=%s,&nbsp;owner1&nbsp;=&nbsp;%s,&nbsp;owner2&nbsp;=&nbsp;%s,&nbsp;owner3&nbsp;=&nbsp;%s,&nbsp;createdate&nbsp;=&nbsp;%s,&nbsp;finisheddate&nbsp;=&nbsp;%s,&nbsp;duedate&nbsp;=&nbsp;%s,&nbsp;note&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">row</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">98</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Updated&nbsp;%s&nbsp;in&nbsp;%s&nbsp;on&nbsp;Server"</span><span class="p_operator">%(</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">99</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;timestamp&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">r_ts</span><span class="p_operator">,</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">100</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">101</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#Handle&nbsp;the&nbsp;deletes;&nbsp;Note&nbsp;if&nbsp;at&nbsp;some&nbsp;point&nbsp;only&nbsp;'d's&nbsp;are&nbsp;being&nbsp;written&nbsp;won't&nbsp;have&nbsp;to&nbsp;check&nbsp;for&nbsp;'d'</span><span class="p_default"><br/>
</span><span class="p_number">102</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;id,table_name&nbsp;FROM&nbsp;sync&nbsp;WHERE&nbsp;timestamp&nbsp;&gt;&nbsp;%s&nbsp;AND&nbsp;timestamp&nbsp;&lt;=&nbsp;%s&nbsp;AND&nbsp;action&nbsp;=&nbsp;'d'"</span><span class="p_operator">,(</span><span class="p_identifier">r_last_sync</span><span class="p_operator">,</span><span class="p_identifier">r_now</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">103</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">104</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">105</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"SELECT&nbsp;id,table_name&nbsp;FROM&nbsp;sync&nbsp;WHERE&nbsp;timestamp&nbsp;&gt;&nbsp;%s&nbsp;AND&nbsp;timestamp&nbsp;&lt;=&nbsp;%s&nbsp;AND&nbsp;action&nbsp;=&nbsp;'d'"</span><span class="p_operator">,(</span><span class="p_identifier">l_last_sync</span><span class="p_operator">,</span><span class="p_identifier">l_now</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">106</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_results</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchall</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">107</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">108</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">l_results</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">109</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"DELETE&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">110</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Deleted&nbsp;%s&nbsp;from&nbsp;%s&nbsp;on&nbsp;Server&nbsp;(if&nbsp;it&nbsp;existed&nbsp;there)"</span><span class="p_operator">%(</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">111</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">112</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">r_results</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">113</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"DELETE&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
</span><span class="p_number">114</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Deleted&nbsp;%s&nbsp;from&nbsp;%s&nbsp;on&nbsp;Local&nbsp;(if&nbsp;it&nbsp;existed&nbsp;there)"</span><span class="p_operator">%(</span><span class="p_identifier">id</span><span class="p_operator">,</span><span class="p_identifier">table</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">115</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#End&nbsp;of&nbsp;deletes&nbsp;code</span><span class="p_default"><br/>
</span><span class="p_number">116</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">117</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#update&nbsp;the&nbsp;user_sync&nbsp;database&nbsp;with&nbsp;the&nbsp;latest&nbsp;sync&nbsp;times</span><span class="p_default"><br/>
</span><span class="p_number">118</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">l_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;user_sync&nbsp;(user,last_sync)&nbsp;VALUES&nbsp;(%s,%s)"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">USER</span><span class="p_operator">,</span><span class="p_identifier">l_now</span><span class="p_operator">))</span><span class="p_default">&nbsp;</span><span class="p_commentline">#don't&nbsp;really&nbsp;need&nbsp;USER&nbsp;for&nbsp;local</span><span class="p_default"><br/>
</span><span class="p_number">119</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">r_cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;user_sync&nbsp;(user,last_sync)&nbsp;VALUES&nbsp;(%s,%s)"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">USER</span><span class="p_operator">,</span><span class="p_identifier">r_now</span><span class="p_operator">))</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">120</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">121</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Synchronization&nbsp;completed"</span><span class="p_default"><br/>
</span><span class="p_number">122</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="timestamper">
<h4><a class="toc-backref" href="#id123" name="timestamper">TimeStamper</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#note&nbsp;that&nbsp;you&nbsp;can&nbsp;insert&nbsp;a&nbsp;timestamp&nbsp;value&nbsp;into&nbsp;an&nbsp;mysql&nbsp;timestamp&nbsp;field</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'sqlite'</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_commentline">#host&nbsp;-&gt;&nbsp;location:rdbms</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;timestamp&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">timestamp</span><span class="p_operator">,</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"Select&nbsp;timestamp&nbsp;from&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">id</span><span class="p_operator">,))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">fetchone</span><span class="p_operator">()[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">timestamp</span>
</div>
</div>
</div>
<div class="section" id="evaluate-methods">
<h3><a class="toc-backref" href="#id124" name="evaluate-methods">Evaluate methods</a></h3>
<div class="section" id="onshowevaluate">
<h4><a class="toc-backref" href="#id125" name="onshowevaluate">OnShowEvaluate</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnShowEvaluate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EvalDialog</span><span class="p_operator">.</span><span class="p_identifier">Show</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EvalDialog</span><span class="p_operator">.</span><span class="p_identifier">EvalText</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EvalDialog</span><span class="p_operator">.</span><span class="p_identifier">EvalText</span><span class="p_operator">.</span><span class="p_identifier">SetFocus</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onevaluate">
<h4><a class="toc-backref" href="#id126" name="onevaluate">OnEvaluate</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnEvaluate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">expr</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EvalDialog</span><span class="p_operator">.</span><span class="p_identifier">EvalText</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"%s&nbsp;=&gt;&nbsp;"</span><span class="p_operator">%</span><span class="p_identifier">expr</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_identifier">eval</span><span class="p_operator">(</span><span class="p_identifier">expr</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="help-menu-methods">
<h3><a class="toc-backref" href="#id127" name="help-menu-methods">Help menu methods</a></h3>
<div class="section" id="onshowabout">
<h4><a class="toc-backref" href="#id128" name="onshowabout">OnShowAbout</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnShowAbout</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">about</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">AboutBox</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">AboutBox</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">app_version</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">VERSION</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onshowhelp">
<h4><a class="toc-backref" href="#id129" name="onshowhelp">OnShowHelp</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnShowHelp</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">startfile</span><span class="p_operator">(</span><span class="p_character">'ListManager.chm'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="getuid">
<h3><a class="toc-backref" href="#id130" name="getuid">GetUID</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">GetUID</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pyiid</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">CreateGuid</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;the&nbsp;str(pyiid)&nbsp;looks&nbsp;like&nbsp;{....}&nbsp;and&nbsp;doing&nbsp;[1:-1]&nbsp;strips&nbsp;that&nbsp;off</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">str</span><span class="p_operator">(</span><span class="p_identifier">pyiid</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">:-</span><span class="p_number">1</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onidle">
<h3><a class="toc-backref" href="#id131" name="onidle">OnIdle</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnIdle</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Check</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">Transfers</span><span class="p_default">&nbsp;</span><span class="p_identifier">From</span><span class="p_default">&nbsp;</span><span class="p_identifier">Outlook</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">Check</span><span class="p_default">&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Edited</span><span class="p_default">&nbsp;</span><span class="p_identifier">File</span><span class="p_default">&nbsp;</span><span class="p_identifier">has</span><span class="p_default">&nbsp;</span><span class="p_identifier">Changed</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>First thing, when are idle events triggered? --&gt; in wxPython they occur after there are no more events to process in the event queue.  So when things are happening rapidly (such as mouse movement) you actually see more idle events and when nothing at all is happening, you don't see any.  This is pretty counterintuitive initially since you would think that idle events should happen when things are truly idle.</p>
<div class="section" id="check-for-transfers-from-outlook">
<h4><a class="toc-backref" href="#id132" name="check-for-transfers-from-outlook">&lt;&lt; Check for Transfers From Outlook &gt;&gt;</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">OUTLOOK</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">input</span><span class="p_operator">,</span><span class="p_identifier">output</span><span class="p_operator">,</span><span class="p_identifier">exc</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">select</span><span class="p_operator">.</span><span class="p_identifier">select</span><span class="p_operator">([</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">sock</span><span class="p_operator">],[],[],</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">input</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">client</span><span class="p_operator">,</span><span class="p_identifier">addr</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">sock</span><span class="p_operator">.</span><span class="p_identifier">accept</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;Get&nbsp;a&nbsp;connection</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">rec</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">client</span><span class="p_operator">.</span><span class="p_identifier">recv</span><span class="p_operator">(</span><span class="p_number">8192</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">d</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">pickle</span><span class="p_operator">.</span><span class="p_identifier">loads</span><span class="p_operator">(</span><span class="p_identifier">rec</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">Item</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_word">pass</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Item</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetUID</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">mx</span><span class="p_operator">.</span><span class="p_identifier">DateTime</span><span class="p_operator">.</span><span class="p_identifier">now</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_word">None</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#outlook&nbsp;strings&nbsp;are&nbsp;unicode;&nbsp;ascii&nbsp;encode&nbsp;makes&nbsp;sure&nbsp;no&nbsp;chars&nbsp;above&nbsp;127</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'Subject'</span><span class="p_operator">].</span><span class="p_identifier">encode</span><span class="p_operator">(</span><span class="p_character">'ascii'</span><span class="p_operator">,</span><span class="p_character">'replace'</span><span class="p_operator">)</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">name</span><span class="p_operator">[:</span><span class="p_number">150</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'SenderName'</span><span class="p_operator">].</span><span class="p_identifier">encode</span><span class="p_operator">(</span><span class="p_character">'ascii'</span><span class="p_operator">,</span><span class="p_character">'replace'</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#encode&nbsp;takes&nbsp;unicode&nbsp;to&nbsp;standard&nbsp;strings</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">owner</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_operator">[:</span><span class="p_number">25</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">owners</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">owner</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'CreationTime'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_character">'\n'</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'Body'</span><span class="p_operator">].</span><span class="p_identifier">encode</span><span class="p_operator">(</span><span class="p_character">'ascii'</span><span class="p_operator">,</span><span class="p_character">'replace'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#foldername&nbsp;=&nbsp;d['Parent.Name']</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#location,&nbsp;rdbms,&nbsp;table&nbsp;=&nbsp;MAIL_LIST_PATH.split(':')</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#host&nbsp;=&nbsp;'%s:%s'%(location,rdbms)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">re</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">'(.*?:.*?):'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">MAIL_LIST_PATH</span><span class="p_operator">)[</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_number">3</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_commentline">#really&nbsp;just&nbsp;for&nbsp;fun</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"INSERT&nbsp;INTO&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;(priority,name,createdate,finisheddate,duedate,owner1,note,id)&nbsp;VALUES&nbsp;(%s,%s,%s,%s,%s,%s,%s,%s)"</span><span class="p_operator">,</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">priority</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">name</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">finisheddate</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">duedate</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">note</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#check&nbsp;to&nbsp;see&nbsp;if&nbsp;table&nbsp;is&nbsp;open</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_operator">,</span><span class="p_identifier">Properties</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">enumerate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_word">and</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">break</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"Table&nbsp;not&nbsp;open&nbsp;but&nbsp;wrote&nbsp;to&nbsp;database&nbsp;anyway"</span><span class="p_default">&nbsp;</span><span class="p_commentline">#Needs&nbsp;to&nbsp;be&nbsp;a&nbsp;dialog&nbsp;box</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;could&nbsp;have&nbsp;started&nbsp;to&nbsp;edit&nbsp;something&nbsp;and&nbsp;never&nbsp;finished&nbsp;it</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnUpdate</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_identifier">L</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">nb</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(</span><span class="p_identifier">L</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;Note&nbsp;that&nbsp;this&nbsp;does&nbsp;not&nbsp;call&nbsp;OnPageChange&nbsp;if&nbsp;the&nbsp;page&nbsp;doesn't&nbsp;change</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">insert</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_identifier">item</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">59</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">InsertImageStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_string">"1"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">idx1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">60</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'name'</span><span class="p_operator">],</span><span class="p_identifier">name</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">61</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'owners'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">owner</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">62</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">63</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">64</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d&nbsp;%H:%M:%S"</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">65</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">Properties</span><span class="p_operator">[</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'createdate'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">66</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">createdate</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_character">'%m/%d/%y'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">67</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">68</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">LCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemState</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_STATE_SELECTED</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">69</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">70</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>The select statement always confused me a bit so I'll come back to this to provide some more documentation of what is going on here.</p>
<p>The emails identified in Outlook are moved to ListManager through a socket connection.  There is a separate Outlook addin that allows the user to highlight an Outlook email message and click on a button in the Outlook toolbar to move the message into ListManager.  I find that many tasks originate or are documented in an email and this makes it very convenient to move those items from Outlook into ListManager without any retyping.</p>
</div>
<div class="section" id="check-if-edited-file-has-changed">
<h4><a class="toc-backref" href="#id133" name="check-if-edited-file-has-changed">&lt;&lt; Check if Edited File has Changed &gt;&gt;</a></h4>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">ed</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">editor</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">path</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'path'</span><span class="p_operator">]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">t</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">getmtime</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">t</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'time'</span><span class="p_operator">]:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">file</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">,</span><span class="p_character">'r'</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">note</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">read</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">close</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'time'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">t</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'host'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Cursors</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">table</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'table'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ed</span><span class="p_operator">[</span><span class="p_character">'id'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">.</span><span class="p_identifier">execute</span><span class="p_operator">(</span><span class="p_string">"UPDATE&nbsp;"</span><span class="p_operator">+</span><span class="p_identifier">table</span><span class="p_operator">+</span><span class="p_string">"&nbsp;SET&nbsp;note&nbsp;=&nbsp;%s&nbsp;WHERE&nbsp;id&nbsp;=&nbsp;%s"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">note</span><span class="p_operator">,</span><span class="p_identifier">id</span><span class="p_operator">))</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;see&nbsp;@rst&nbsp;documentation&nbsp;note</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ts</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TimeStamper</span><span class="p_operator">(</span><span class="p_identifier">host</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cursor</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">table</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">curIdx</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">L</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">L</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ItemLists</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_identifier">idx</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">id</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">id</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">note</span><span class="p_operator">.</span><span class="p_identifier">SetValue</span><span class="p_operator">(</span><span class="p_identifier">note</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ts</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">PropertyDicts</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">][</span><span class="p_character">'LCdate'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'timestamp'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ListCtrls</span><span class="p_operator">[</span><span class="p_identifier">L</span><span class="p_operator">].</span><span class="p_identifier">SetStringItem</span><span class="p_operator">(</span><span class="p_identifier">idx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">attr2col_num</span><span class="p_operator">[</span><span class="p_character">'date'</span><span class="p_operator">],</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">timestamp</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">(</span><span class="p_string">"%m/%d&nbsp;%H:%M:%S"</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_character">'note'</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">:</span><span class="p_default">&nbsp;</span><span class="p_commentline">#if&nbsp;necessary&nbsp;only&nbsp;if&nbsp;somehow&nbsp;note&nbsp;text&nbsp;didn't&nbsp;change</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">del</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">modified</span><span class="p_operator">[</span><span class="p_character">'note'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
<p><strong>comments</strong>:</p>
<p>This section in the OnIdle method checks to see if there are any open editors that have had a change in data in a manner that is similar to the code in Leo that works with the Leo Open With menu item.</p>
<div class="note">
<p class="admonition-title">Note</p>
<p>After the line:</p>
<pre class="literal-block">
cursor.execute(&quot;UPDATE &quot;+table+&quot; SET note = %s WHERE id = %s&quot;, (note,id))
</pre>
<p>normally the next line would be:</p>
<pre class="literal-block">
item.timestamp = self.TimeStamper(host, cursor, table, id)
</pre>
<p>however, this is actually a bit tricky since by the time the editor is closed the user may be on a different notebook page and you'd have to go from id --&gt; self.ItemLists[L][idx] to update the display so it didn't seem like it was worth the effort.  This means that the display timestamp doesn't automatically update when the external editor is closed but will update if the display is refreshed.</p>
</div>
</div>
</div>
</div>
<div class="section" id="class-listctrl">
<h2><a class="toc-backref" href="#id134" name="class-listctrl">class ListCtrl</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">ListCtrl</span><span class="p_operator">(</span><span class="p_identifier">wxListCtrl</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxListCtrlAutoWidthMixin</span><span class="p_operator">):</span>
</div>
<div class="section" id="init">
<h3><a class="toc-backref" href="#id135" name="init">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">ID</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultSize</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_number">0</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxListCtrl</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">ID</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxListCtrlAutoWidthMixin</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">il</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxImageList</span><span class="p_operator">(</span><span class="p_number">16</span><span class="p_operator">,</span><span class="p_number">16</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sm_up</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">il</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\up_arrow.bmp'</span><span class="p_operator">))</span><span class="p_default">&nbsp;</span><span class="p_commentline">#(images.getSmallUpArrowBitmap())</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sm_dn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">il</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\down_arrow.bmp'</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">arrows</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">sm_up</span><span class="p_operator">,</span><span class="p_identifier">sm_dn</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">idx1</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">il</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\box.bmp'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">idx0</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">il</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\filledwhitebox.bmp'</span><span class="p_operator">))</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetImageList</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">il</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxIMAGE_LIST_SMALL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_LIST_COL_BEGIN_DRAG</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnColBeginDrag</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetUpColumns</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="setupcolumns">
<h3><a class="toc-backref" href="#id136" name="setupcolumns">SetUpColumns</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">SetUpColumns</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#Need&nbsp;to&nbsp;to&nbsp;construct&nbsp;column&nbsp;heads&nbsp;for&nbsp;columns&nbsp;with&nbsp;sorting&nbsp;by&nbsp;hand&nbsp;to&nbsp;get&nbsp;sorting&nbsp;images&nbsp;on&nbsp;columns</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">info</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxListItem</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">info</span><span class="p_operator">.</span><span class="p_identifier">m_mask</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_MASK_TEXT</span><span class="p_default">&nbsp;</span><span class="p_operator">|</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_MASK_IMAGE</span><span class="p_default">&nbsp;</span><span class="p_operator">|</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_MASK_FORMAT</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">info</span><span class="p_operator">.</span><span class="p_identifier">m_image</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#Oth&nbsp;column&nbsp;is&nbsp;priority&nbsp;which&nbsp;is&nbsp;sortable</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">info</span><span class="p_operator">.</span><span class="p_identifier">m_format</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_FORMAT_LEFT</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">info</span><span class="p_operator">.</span><span class="p_identifier">m_text</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"P"</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">InsertColumnInfo</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">info</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetColumnWidth</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">35</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">InsertColumn</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Name"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetColumnWidth</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">590</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">InsertColumn</span><span class="p_operator">(</span><span class="p_number">2</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Owner"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetColumnWidth</span><span class="p_operator">(</span><span class="p_number">2</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">100</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#3th&nbsp;column&nbsp;is&nbsp;create&nbsp;ate&nbsp;and&nbsp;same&nbsp;as&nbsp;with&nbsp;priority&nbsp;-&nbsp;needs&nbsp;to&nbsp;constructed&nbsp;by&nbsp;hand</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">info</span><span class="p_operator">.</span><span class="p_identifier">m_format</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLIST_FORMAT_LEFT</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">info</span><span class="p_operator">.</span><span class="p_identifier">m_text</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Due&nbsp;Date"</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">InsertColumnInfo</span><span class="p_operator">(</span><span class="p_number">3</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">info</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetColumnWidth</span><span class="p_operator">(</span><span class="p_number">3</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">75</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="oncolbegindrag">
<h3><a class="toc-backref" href="#id137" name="oncolbegindrag">OnColBeginDrag</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnColBeginDrag</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;inplace&nbsp;editor&nbsp;then&nbsp;change&nbsp;its&nbsp;dimensions</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">GetColumn</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">Veto</span><span class="p_operator">()</span>
</div>
</div>
</div>
<div class="section" id="class-myapp">
<h2><a class="toc-backref" href="#id138" name="class-myapp">class MyApp</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">MyApp</span><span class="p_operator">(</span><span class="p_identifier">wxApp</span><span class="p_operator">):</span>
</div>
<div class="section" id="oninit">
<h3><a class="toc-backref" href="#id139" name="oninit">OnInit</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnInit</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">global</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">CANCEL</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxInitAllImageHandlers</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">STARTUP_DIALOG</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">startup</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">StartupDialog</span><span class="p_operator">(</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'List&nbsp;Manager'</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">startup</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">startup</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_YES</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_NO</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">elif</span><span class="p_default">&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">CANCEL</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_word">is</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">server</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">REMOTE_HOST</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">':'</span><span class="p_operator">)[</span><span class="p_number">0</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">socket</span><span class="p_operator">.</span><span class="p_identifier">gethostbyname</span><span class="p_operator">(</span><span class="p_identifier">server</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Cannot&nbsp;connect&nbsp;to&nbsp;remote&nbsp;server!&nbsp;Only&nbsp;offline&nbsp;access&nbsp;is&nbsp;possible."</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"ListManager"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxOK</span><span class="p_operator">|</span><span class="p_identifier">wxICON_EXCLAMATION</span><span class="p_operator">|</span><span class="p_identifier">wxSTAY_ON_TOP</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">OFFLINE_ONLY</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">frame</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ListManager</span><span class="p_operator">(</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"List&nbsp;Manager"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">X</span><span class="p_operator">,</span><span class="p_identifier">Y</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">frame</span><span class="p_operator">.</span><span class="p_identifier">Show</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetTopWindow</span><span class="p_operator">(</span><span class="p_identifier">frame</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">CANCEL</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">False</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="class-logger">
<h2><a class="toc-backref" href="#id140" name="class-logger">class Logger</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">Logger</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">LoggerDialog</span><span class="p_operator">(</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Alerts&nbsp;and&nbsp;Exceptions"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">dir</span><span class="p_operator">=</span><span class="p_identifier">DIRECTORY</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">write</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">error_msg</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">IsShown</span><span class="p_operator">():</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_string">"\n%s\n"</span><span class="p_operator">%</span><span class="p_identifier">time</span><span class="p_operator">.</span><span class="p_identifier">asctime</span><span class="p_operator">())</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Show</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">AppendText</span><span class="p_operator">(</span><span class="p_identifier">error_msg</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="run">
<h2><a class="toc-backref" href="#id141" name="run">run</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">run</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">app</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">MyApp</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">CANCEL</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sys</span><span class="p_operator">.</span><span class="p_identifier">stderr</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">sys</span><span class="p_operator">.</span><span class="p_identifier">stdout</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Logger</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">app</span><span class="p_operator">.</span><span class="p_identifier">MainLoop</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">__name__</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'__main__'</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">run</span><span class="p_operator">()</span>
</div>
</div>
</div>
<div class="section" id="file-lmdialogs-py">
<h1><a class="toc-backref" href="#id142" name="file-lmdialogs-py">&#64;file LMDialogs.py</a></h1>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;@</span><span class="p_identifier">language</span><span class="p_default">&nbsp;</span><span class="p_identifier">python</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPython</span><span class="p_operator">.</span><span class="p_identifier">wx</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_operator">*</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;the&nbsp;following&nbsp;two&nbsp;are&nbsp;needed&nbsp;for&nbsp;the&nbsp;calendar</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPython</span><span class="p_operator">.</span><span class="p_identifier">calendar</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_operator">*</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPython</span><span class="p_operator">.</span><span class="p_identifier">utils</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_operator">*</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span>
</div>
<div class="section" id="class-popdialog">
<h2><a class="toc-backref" href="#id143" name="class-popdialog">class PopDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">TicklerDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id144" name="id5">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxDefaultSize</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxSTAY_ON_TOP</span><span class="p_default">&nbsp;</span><span class="p_operator">|</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTHICK_FRAME</span><span class="p_default">&nbsp;</span><span class="p_operator">|</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">(</span><span class="p_number">450</span><span class="p_operator">,</span><span class="p_number">250</span><span class="p_operator">),</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxTE_MULTILINE</span><span class="p_default">&nbsp;</span><span class="p_operator">|</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTE_READONLY</span><span class="p_default">&nbsp;</span><span class="p_operator">|</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTE_RICH2</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">TC</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">line</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxStaticLine</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">20</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLI_HORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">line</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxTOP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"GO&nbsp;TO&nbsp;ITEM"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_FORWARD</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"SHOW&nbsp;NEXT"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_APPLY</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"MAIL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"CANCEL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetAutoLayout</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Fit</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_LEFT_DOWN</span><span class="p_operator">(</span><span class="p_identifier">TC</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnLeftDown</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_BUTTON</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_FORWARD</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnForward</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_BUTTON</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_APPLY</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnMail</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TC</span><span class="p_operator">.</span><span class="p_identifier">SetCursor</span><span class="p_operator">(</span><span class="p_identifier">wxStockCursor</span><span class="p_operator">(</span><span class="p_identifier">wxCURSOR_ARROW</span><span class="p_operator">))</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">TC</span>
</div>
</div>
<div class="section" id="onleftdown">
<h3><a class="toc-backref" href="#id145" name="onleftdown">OnLeftDown</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnLeftDown</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EndModal</span><span class="p_operator">(</span><span class="p_identifier">wxID_OK</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="onforward">
<h3><a class="toc-backref" href="#id146" name="onforward">OnForward</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnForward</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EndModal</span><span class="p_operator">(</span><span class="p_identifier">wxID_FORWARD</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="onmail">
<h3><a class="toc-backref" href="#id147" name="onmail">OnMail</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnMail</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EndModal</span><span class="p_operator">(</span><span class="p_identifier">wxID_APPLY</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="class-startupdialog">
<h2><a class="toc-backref" href="#id148" name="class-startupdialog">class StartupDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">StartupDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id6">
<h3><a class="toc-backref" href="#id149" name="id6">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">300</span><span class="p_operator">,</span><span class="p_number">115</span><span class="p_operator">)):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxSTAY_ON_TOP</span><span class="p_operator">|</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">msg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"You&nbsp;can&nbsp;connect&nbsp;to&nbsp;the&nbsp;server&nbsp;using&nbsp;the&nbsp;network,\nor&nbsp;work&nbsp;offline,&nbsp;or&nbsp;cancel&nbsp;this&nbsp;logon."</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">image</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxStaticBitmap</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\wxpdemo.bmp'</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">32</span><span class="p_operator">,</span><span class="p_number">32</span><span class="p_operator">))</span><span class="p_default">&nbsp;</span><span class="p_commentline">#sizer&nbsp;determines&nbsp;position</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">text</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxStaticText</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">250</span><span class="p_operator">,</span><span class="p_number">32</span><span class="p_operator">))</span><span class="p_default">&nbsp;</span><span class="p_commentline">#sizer&nbsp;determines&nbsp;position</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">rect</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">rect</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">image</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_LEFT</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">4</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">rect</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">text</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTER</span><span class="p_operator">|</span><span class="p_identifier">wxTOP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">7</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_NO</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Connect'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">10</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_YES</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Work&nbsp;Offline'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">10</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'Cancel'</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">10</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">rect</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_BUTTON</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_NO</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnSelection</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_BUTTON</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_YES</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnSelection</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="onselection">
<h3><a class="toc-backref" href="#id150" name="onselection">OnSelection</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnSelection</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">val</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">()</span>
</div>
</div>
</div>
<div class="section" id="class-modifierdialog">
<h2><a class="toc-backref" href="#id151" name="class-modifierdialog">class ModifierDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">ModifierDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id7">
<h3><a class="toc-backref" href="#id152" name="id7">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultSize</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">modifierlist</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">curselections</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">''</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer2</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">tc</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">""</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">150</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">tc</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">tc</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">tc</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">modifierlist</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">modifierlist</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">lb</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxListBox</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">150</span><span class="p_operator">,</span><span class="p_number">300</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_commentline">#wxPoint(90,&nbsp;80)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">modifierlist</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLB_MULTIPLE</span><span class="p_operator">|</span><span class="p_identifier">wxLB_SORT</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">lb</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">line</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxStaticLine</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">20</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLI_HORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">line</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxTOP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"OK"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer2</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"CANCEL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer2</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer2</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetAutoLayout</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_operator">.</span><span class="p_identifier">Fit</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">sel</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">curselections</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">index</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">FindString</span><span class="p_operator">(</span><span class="p_identifier">sel</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">index</span><span class="p_default">&nbsp;</span><span class="p_operator">!=-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(</span><span class="p_identifier">index</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">lb</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_BUTTON</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">ClearSelections</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="getuserinput">
<h3><a class="toc-backref" href="#id153" name="getuserinput">GetUserInput</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">GetUserInput</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">GetSelections</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">mod_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx_list</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">mod_list</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">GetString</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">Deselect</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#071203</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">manual_string</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">tc</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#text&nbsp;entry&nbsp;box</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">manual_string</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">manual_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_identifier">x</span><span class="p_operator">.</span><span class="p_identifier">strip</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">manual_string</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">';'</span><span class="p_operator">)]</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">name</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">manual_list</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">clean_name</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">",&nbsp;"</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">([</span><span class="p_identifier">x</span><span class="p_operator">.</span><span class="p_identifier">strip</span><span class="p_operator">().</span><span class="p_identifier">title</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">x</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">name</span><span class="p_operator">.</span><span class="p_identifier">split</span><span class="p_operator">(</span><span class="p_character">','</span><span class="p_operator">)])</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">clean_name</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">mod_list</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">mod_list</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">clean_name</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">new_list</span><span class="p_operator">.</span><span class="p_identifier">append</span><span class="p_operator">(</span><span class="p_identifier">clean_name</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="selectcurrent">
<h3><a class="toc-backref" href="#id154" name="selectcurrent">SelectCurrent</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">SelectCurrent</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cur_sel</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">sel</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">cur_sel</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">index</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">FindString</span><span class="p_operator">(</span><span class="p_identifier">sel</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">index</span><span class="p_default">&nbsp;</span><span class="p_operator">!=-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">SetSelection</span><span class="p_operator">(</span><span class="p_identifier">index</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="clearselections">
<h3><a class="toc-backref" href="#id155" name="clearselections">ClearSelections</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">ClearSelections</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">idx_list</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">GetSelections</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#note&nbsp;you&nbsp;can't&nbsp;just&nbsp;use&nbsp;the&nbsp;indexes&nbsp;of&nbsp;the&nbsp;SelectCurrent&nbsp;since&nbsp;they&nbsp;may&nbsp;have&nbsp;clicked&nbsp;before&nbsp;cancelling</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">idx_list</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">lb</span><span class="p_operator">.</span><span class="p_identifier">Deselect</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="class-maildialog">
<h2><a class="toc-backref" href="#id156" name="class-maildialog">class MailDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">MailDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id157" name="id8">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultSize</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxSTAY_ON_TOP</span><span class="p_operator">|</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTHICK_FRAME</span><span class="p_operator">|</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">|</span><span class="p_identifier">wxSYSTEM_MENU</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">recipients</span><span class="p_operator">=</span><span class="p_character">''</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">subject</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">''</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">body</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">''</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">recipients</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">";&nbsp;"</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">recipients</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">label</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxStaticText</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"To:"</span><span class="p_operator">,</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">40</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxALIGN_LEFT</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">RTC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">recipients</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">480</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">label</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">RTC</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#sizer.Add(10,10,0)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">label</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxStaticText</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Subject:"</span><span class="p_operator">,</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">40</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxALIGN_LEFT</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">STC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">subject</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">480</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">))</span><span class="p_default">&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">label</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">STC</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">BTC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">body</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">500</span><span class="p_operator">,</span><span class="p_number">400</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxTE_MULTILINE</span><span class="p_operator">|</span><span class="p_identifier">wxTE_RICH2</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">BTC</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"SEND&nbsp;MAIL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"CANCEL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetAutoLayout</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Fit</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">RTC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">RTC</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">STC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">STC</span><span class="p_default"><br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">BTC</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">BTC</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="class-calendardialog">
<h2><a class="toc-backref" href="#id158" name="class-calendardialog">class CalendarDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">CalendarDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id9">
<h3><a class="toc-backref" href="#id159" name="id9">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultSize</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">=</span><span class="p_number">0</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_word">not</span><span class="p_default">&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">date</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxDateTime_Now</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cal</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCalendarCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">date</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_commentline">#pos&nbsp;=&nbsp;(25,50),</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">style</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCAL_SHOW_HOLIDAYS</span><span class="p_default">&nbsp;</span><span class="p_operator">|</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCAL_SUNDAY_FIRST</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_CALENDAR</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cal</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCalSelected</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#EVT_CLOSE(self,&nbsp;self.OnCloseWindow)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">cal</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">cal</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;Set&nbsp;up&nbsp;control&nbsp;to&nbsp;display&nbsp;a&nbsp;set&nbsp;of&nbsp;holidays:</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_CALENDAR_MONTH</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cal</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnChangeMonth</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">holidays</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[(</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">10</span><span class="p_operator">,</span><span class="p_number">31</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">12</span><span class="p_operator">,</span><span class="p_number">25</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_operator">]</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;(these&nbsp;don't&nbsp;move&nbsp;around)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnChangeMonth</span><span class="p_operator">()</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#-------------------------------------------------------------------------&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer2</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">cal</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">line</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxStaticLine</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">20</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLI_HORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">line</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxRIGHT</span><span class="p_operator">|</span><span class="p_identifier">wxTOP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"OK"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer2</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"CANCEL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#btn.SetDefault()</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer2</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer2</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetAutoLayout</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer1</span><span class="p_operator">.</span><span class="p_identifier">Fit</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="oncalselected">
<h3><a class="toc-backref" href="#id160" name="oncalselected">OnCalSelected</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnCalSelected</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">result</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">.</span><span class="p_identifier">GetDate</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EndModal</span><span class="p_operator">(</span><span class="p_identifier">wxID_OK</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="onchangemonth">
<h3><a class="toc-backref" href="#id161" name="onchangemonth">OnChangeMonth</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnChangeMonth</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">cur_month</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">cal</span><span class="p_operator">.</span><span class="p_identifier">GetDate</span><span class="p_operator">().</span><span class="p_identifier">GetMonth</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;convert&nbsp;wxDateTime&nbsp;0-11&nbsp;=&gt;&nbsp;1-12</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">month</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">day</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">holidays</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">month</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">cur_month</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">cal</span><span class="p_operator">.</span><span class="p_identifier">SetHoliday</span><span class="p_operator">(</span><span class="p_identifier">day</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onclosewindow">
<h3><a class="toc-backref" href="#id162" name="onclosewindow">OnCloseWindow</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnCloseWindow</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">event</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#self.cal.Destroy</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#self.Destroy()</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"I&nbsp;got&nbsp;to&nbsp;close&nbsp;window"</span>
</div>
</div>
<div class="section" id="getdate">
<h3><a class="toc-backref" href="#id163" name="getdate">GetDate</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">GetDate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">result</span>
</div>
</div>
</div>
<div class="section" id="class-finddialog">
<h2><a class="toc-backref" href="#id164" name="class-finddialog">class FindDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">FindDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id165" name="id10">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">300</span><span class="p_operator">,</span><span class="p_number">120</span><span class="p_operator">)):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxSTAY_ON_TOP</span><span class="p_operator">|</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindText</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,(</span><span class="p_number">200</span><span class="p_operator">,</span><span class="p_number">24</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_a</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_a</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">FindText</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTER</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_b</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"OK"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_b</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTER</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"CANCEL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_b</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTER</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_a</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box_b</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">MatchCase</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCheckBox</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Match&nbsp;Case"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">MatchWhole</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCheckBox</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Match&nbsp;Whole&nbsp;Word"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_c</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_c</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">MatchCase</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLEFT</span><span class="p_operator">|</span><span class="p_identifier">wxBOTTOM</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_c</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">MatchWhole</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLEFT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SearchNotes</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCheckBox</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Search&nbsp;Notes"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SearchFinished</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCheckBox</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Search&nbsp;Finished"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_d</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_d</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SearchNotes</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLEFT</span><span class="p_operator">|</span><span class="p_identifier">wxBOTTOM</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_d</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SearchFinished</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLEFT</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_e</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_e</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box_c</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_e</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box_d</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box_a</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box_e</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_BUTTON</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">.</span><span class="p_identifier">FindString</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="class-evaldialog">
<h2><a class="toc-backref" href="#id166" name="class-evaldialog">class EvalDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">EvalDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id11">
<h3><a class="toc-backref" href="#id167" name="id11">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">300</span><span class="p_operator">,</span><span class="p_number">80</span><span class="p_operator">)):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxSTAY_ON_TOP</span><span class="p_operator">|</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EvalText</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,(</span><span class="p_number">200</span><span class="p_operator">,</span><span class="p_number">24</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_a</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_a</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">EvalText</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTER</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_b</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"OK"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_b</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTER</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"CANCEL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_b</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTER</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box_a</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box_b</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">box_a</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EvalText</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">EvalText</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">parent</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#EVT_BUTTON(self,&nbsp;wxID_OK,&nbsp;self.PostOKEvent)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_BUTTON</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">.</span><span class="p_identifier">OnEvaluate</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="postokevent">
<h3><a class="toc-backref" href="#id168" name="postokevent">PostOKEvent</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">PostOKEvent</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxPostEvent</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">)</span>
</div>
</div>
</div>
<div class="section" id="class-loggerdialog">
<h2><a class="toc-backref" href="#id169" name="class-loggerdialog">class LoggerDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">LoggerDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id12">
<h3><a class="toc-backref" href="#id170" name="id12">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=(-</span><span class="p_number">1</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">500</span><span class="p_operator">,</span><span class="p_number">300</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">dir</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#if&nbsp;pos&nbsp;==&nbsp;(-1,-1):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#self.CenterOnScreen(wxBOTH)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">dir</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">dir</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">dir</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">dir</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">getcwd</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">text</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">msg</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">450</span><span class="p_operator">,</span><span class="p_number">250</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTE_MULTILINE</span><span class="p_default">&nbsp;</span><span class="p_operator">|</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTE_READONLY</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">text</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Close"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ID_SAVE</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxNewId</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">ID_SAVE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Save&nbsp;to&nbsp;File"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetAutoLayout</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Fit</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">text</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_BUTTON</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">ID_SAVE</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnSave</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="onsave">
<h3><a class="toc-backref" href="#id171" name="onsave">OnSave</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnSave</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">path</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">os</span><span class="p_operator">.</span><span class="p_identifier">path</span><span class="p_operator">.</span><span class="p_identifier">join</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">dir</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'logfile.txt'</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">file</span><span class="p_operator">(</span><span class="p_identifier">path</span><span class="p_operator">,</span><span class="p_character">'a'</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">write</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">())</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">f</span><span class="p_operator">.</span><span class="p_identifier">close</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxMessageDialog</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_string">"Appended&nbsp;text&nbsp;to&nbsp;logfile.text"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Notice"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxICON_INFORMATION</span><span class="p_operator">|</span><span class="p_identifier">wxOK</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">ShowModal</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">dlg</span><span class="p_operator">.</span><span class="p_identifier">Destroy</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">Clear</span><span class="p_operator">()</span>
</div>
</div>
</div>
<div class="section" id="class-finisheddialog">
<h2><a class="toc-backref" href="#id172" name="class-finisheddialog">class FinishedDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">FinishedDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id13">
<h3><a class="toc-backref" href="#id173" name="id13">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultSize</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">days</span><span class="p_operator">=</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">spin_label</span><span class="p_operator">=</span><span class="p_string">""</span><span class="p_operator">,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">check_label</span><span class="p_operator">=</span><span class="p_string">""</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">title</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Centre</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">check</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxCheckBox</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">check_label</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">days</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">check</span><span class="p_operator">.</span><span class="p_identifier">SetValue</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">days</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">panel</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxPanel</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),(</span><span class="p_number">225</span><span class="p_operator">,</span><span class="p_number">75</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxStaticText</span><span class="p_operator">(</span><span class="p_identifier">panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">spin_label</span><span class="p_operator">,(</span><span class="p_number">15</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">15</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTextCtrl</span><span class="p_operator">(</span><span class="p_identifier">panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">str</span><span class="p_operator">(</span><span class="p_identifier">days</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">30</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">50</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">30</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">h</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">GetSize</span><span class="p_operator">().</span><span class="p_identifier">height</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">spin</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSpinButton</span><span class="p_operator">(</span><span class="p_identifier">panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">56</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">50</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_identifier">h</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">h</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxSP_VERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxStaticText</span><span class="p_operator">(</span><span class="p_identifier">panel</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_character">'days'</span><span class="p_operator">,(</span><span class="p_number">76</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">53</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">spin</span><span class="p_operator">.</span><span class="p_identifier">SetRange</span><span class="p_operator">(</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">14</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">spin</span><span class="p_operator">.</span><span class="p_identifier">SetValue</span><span class="p_operator">(</span><span class="p_identifier">days</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">H_sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">line</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxStaticLine</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">20</span><span class="p_operator">,-</span><span class="p_number">1</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxLI_HORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"OK"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">H_sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"CANCEL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">H_sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">V_sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">V_sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">panel</span><span class="p_operator">,</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">wxALIGN_CENTER</span><span class="p_operator">|</span><span class="p_identifier">wxEXPAND</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">V_sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">V_sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">check</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_identifier">wxALIGN_LEFT</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">V_sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">line</span><span class="p_operator">,</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxTOP</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">V_sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">H_sizer</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxGROW</span><span class="p_operator">|</span><span class="p_identifier">wxALIGN_CENTER_VERTICAL</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">V_sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetAutoLayout</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">V_sizer</span><span class="p_operator">.</span><span class="p_identifier">Fit</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">48</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">49</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_SPIN</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">spin</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnSpin</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">50</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_CHECKBOX</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">check</span><span class="p_operator">.</span><span class="p_identifier">GetId</span><span class="p_operator">(),</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnCheck</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">51</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">52</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">check</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">53</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">spin</span><span class="p_operator">.</span><span class="p_identifier">Enable</span><span class="p_operator">(</span><span class="p_identifier">False</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">54</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">Enable</span><span class="p_operator">(</span><span class="p_identifier">False</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">55</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">56</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">Layout</span><span class="p_operator">()</span><span class="p_default">&nbsp;</span><span class="p_commentline">#doesn't&nbsp;appear&nbsp;necessary</span><span class="p_default"><br/>
</span><span class="p_number">57</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">58</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="onspin">
<h3><a class="toc-backref" href="#id174" name="onspin">OnSpin</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnSpin</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">):</span>
</div>
</div>
<div class="section" id="oncheck">
<h3><a class="toc-backref" href="#id175" name="oncheck">OnCheck</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnCheck</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">evt</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">check</span><span class="p_operator">.</span><span class="p_identifier">GetValue</span><span class="p_operator">():</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">spin</span><span class="p_operator">.</span><span class="p_identifier">Enable</span><span class="p_operator">(</span><span class="p_identifier">False</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">Enable</span><span class="p_operator">(</span><span class="p_identifier">False</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">spin</span><span class="p_operator">.</span><span class="p_identifier">Enable</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">text</span><span class="p_operator">.</span><span class="p_identifier">Enable</span><span class="p_operator">(</span><span class="p_identifier">True</span><span class="p_operator">)</span>
</div>
</div>
</div>
<div class="section" id="class-treedialog">
<h2><a class="toc-backref" href="#id176" name="class-treedialog">class TreeDialog</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">TreeDialog</span><span class="p_operator">(</span><span class="p_identifier">wxDialog</span><span class="p_operator">):</span>
</div>
<div class="section" id="id14">
<h3><a class="toc-backref" href="#id177" name="id14">__init__</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">=</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">=(</span><span class="p_number">300</span><span class="p_operator">,</span><span class="p_number">400</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">tree</span><span class="p_operator">={}):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">wxDialog</span><span class="p_operator">.</span><span class="p_identifier">__init__</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">parent</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">caption</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">pos</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">size</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">style</span><span class="p_operator">=</span><span class="p_identifier">wxSTAY_ON_TOP</span><span class="p_operator">|</span><span class="p_identifier">wxCAPTION</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTreeCtrl</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxDefaultPosition</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">(</span><span class="p_number">300</span><span class="p_operator">,</span><span class="p_number">400</span><span class="p_operator">),</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTR_HAS_BUTTONS</span><span class="p_operator">)</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#|wxTR_HIDE_ROOT)#wxDefaultSize,</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxVERTICAL</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTER</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxBoxSizer</span><span class="p_operator">(</span><span class="p_identifier">wxHORIZONTAL</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_OK</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"OK"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_operator">.</span><span class="p_identifier">SetDefault</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">btn</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxButton</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxID_CANCEL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"CANCEL"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">box</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">btn</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxALIGN_CENTRE</span><span class="p_operator">|</span><span class="p_identifier">wxALL</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">5</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sizer</span><span class="p_operator">.</span><span class="p_identifier">AddSizer</span><span class="p_operator">(</span><span class="p_identifier">box</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetAutoLayout</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">SetSizer</span><span class="p_operator">(</span><span class="p_identifier">sizer</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">il</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxImageList</span><span class="p_operator">(</span><span class="p_number">16</span><span class="p_operator">,</span><span class="p_number">16</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">fldridx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">il</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\folder.bmp'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">fldropenidx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">il</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\folder_open.bmp'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">listidx</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">il</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">wxBitmap</span><span class="p_operator">(</span><span class="p_character">'bitmaps\\list.bmp'</span><span class="p_operator">))</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetImageList</span><span class="p_operator">(</span><span class="p_identifier">il</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">root</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">AddRoot</span><span class="p_operator">(</span><span class="p_string">"List&nbsp;Manager"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemImage</span><span class="p_operator">(</span><span class="p_identifier">root</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">fldridx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTreeItemIcon_Normal</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemImage</span><span class="p_operator">(</span><span class="p_identifier">root</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">fldropenidx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTreeItemIcon_Expanded</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">tree</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">34</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">child</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">AppendItem</span><span class="p_operator">(</span><span class="p_identifier">root</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">host</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">35</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemImage</span><span class="p_operator">(</span><span class="p_identifier">child</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">fldridx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTreeItemIcon_Normal</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">36</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemImage</span><span class="p_operator">(</span><span class="p_identifier">child</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">fldropenidx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTreeItemIcon_Expanded</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">37</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">listname</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">tree</span><span class="p_operator">[</span><span class="p_identifier">host</span><span class="p_operator">]:</span><span class="p_default"><br/>
</span><span class="p_number">38</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">last</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">AppendItem</span><span class="p_operator">(</span><span class="p_identifier">child</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">listname</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">39</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemImage</span><span class="p_operator">(</span><span class="p_identifier">last</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">listidx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTreeItemIcon_Normal</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">40</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">SetItemImage</span><span class="p_operator">(</span><span class="p_identifier">last</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">listidx</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">wxTreeItemIcon_Selected</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">41</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">42</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">.</span><span class="p_identifier">Expand</span><span class="p_operator">(</span><span class="p_identifier">root</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">43</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">44</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">TreeCtrl</span><span class="p_default"><br/>
</span><span class="p_number">45</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">il</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">il</span><span class="p_default">&nbsp;</span><span class="p_commentline">#?&nbsp;prevents&nbsp;GC</span><span class="p_default"><br/>
</span><span class="p_number">46</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">47</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">EVT_LEFT_DCLICK</span><span class="p_operator">(</span><span class="p_identifier">TreeCtrl</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">OnLeftDClick</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="onleftdclick">
<h3><a class="toc-backref" href="#id178" name="onleftdclick">OnLeftDClick:</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnLeftDClick</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">event</span><span class="p_operator">=</span><span class="p_word">None</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">EndModal</span><span class="p_operator">(</span><span class="p_identifier">wxID_OK</span><span class="p_operator">)</span>
</div>
</div>
</div>
</div>
<div class="section" id="file-outlookaddin-py">
<h1><a class="toc-backref" href="#id179" name="file-outlookaddin-py">&#64;file outlookAddin.py</a></h1>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;@</span><span class="p_identifier">language</span><span class="p_default">&nbsp;</span><span class="p_identifier">python</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_identifier">outlookAddin</span><span class="p_default">&nbsp;</span><span class="p_identifier">declarations</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">__name__</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_character">'__main__'</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32com</span><span class="p_operator">.</span><span class="p_identifier">server</span><span class="p_operator">.</span><span class="p_identifier">register</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">win32com</span><span class="p_operator">.</span><span class="p_identifier">server</span><span class="p_operator">.</span><span class="p_identifier">register</span><span class="p_operator">.</span><span class="p_identifier">UseCommandLine</span><span class="p_operator">(</span><span class="p_identifier">OutlookAddin</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_string">"--unregister"</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">sys</span><span class="p_operator">.</span><span class="p_identifier">argv</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">UnregisterAddin</span><span class="p_operator">(</span><span class="p_identifier">OutlookAddin</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">RegisterAddin</span><span class="p_operator">(</span><span class="p_identifier">OutlookAddin</span><span class="p_operator">)</span>
</div>
<div class="section" id="outlookaddin-declarations">
<h2><a class="toc-backref" href="#id180" name="outlookaddin-declarations">&lt;&lt; outlookAddin declarations &gt;&gt;</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;This&nbsp;is&nbsp;mainly&nbsp;stolen&nbsp;from&nbsp;Mark&nbsp;Hammond's&nbsp;demo&nbsp;plugin&nbsp;for&nbsp;win32com.client</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;A&nbsp;demo&nbsp;plugin&nbsp;for&nbsp;Microsoft&nbsp;Outlook&nbsp;(NOT&nbsp;Outlook&nbsp;Express)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32com</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">universal</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32com</span><span class="p_operator">.</span><span class="p_identifier">server</span><span class="p_operator">.</span><span class="p_identifier">exception</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">COMException</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32com</span><span class="p_operator">.</span><span class="p_identifier">client</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">gencache</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">DispatchWithEvents</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32com</span><span class="p_operator">.</span><span class="p_identifier">client</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">Dispatch</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">winerror</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">pythoncom</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32com</span><span class="p_operator">.</span><span class="p_identifier">client</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">constants</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">win32ui</span><span class="p_default">&nbsp;</span><span class="p_commentblock">##</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">sys</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">from</span><span class="p_default">&nbsp;</span><span class="p_identifier">socket</span><span class="p_default">&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_operator">*</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">pickle</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;Support&nbsp;for&nbsp;COM&nbsp;objects&nbsp;we&nbsp;use.</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#sz&nbsp;comment&nbsp;gencache.EnsureModule&nbsp;makes&nbsp;sure&nbsp;you&nbsp;are&nbsp;using&nbsp;makepy&nbsp;if&nbsp;the&nbsp;makepy-derived</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#file&nbsp;doesn't&nbsp;already&nbsp;exist</span><span class="p_default"><br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#but&nbsp;as&nbsp;long&nbsp;as&nbsp;you&nbsp;did&nbsp;run&nbsp;makepy&nbsp;then&nbsp;you&nbsp;should&nbsp;just&nbsp;be&nbsp;alble&nbsp;to&nbsp;do&nbsp;a&nbsp;normal&nbsp;dispatch</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">mod</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">gencache</span><span class="p_operator">.</span><span class="p_identifier">EnsureModule</span><span class="p_operator">(</span><span class="p_character">'{00062FFF-0000-0000-C000-000000000046}'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">9</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">bForDemand</span><span class="p_operator">=</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;Outlook&nbsp;9</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">gencache</span><span class="p_operator">.</span><span class="p_identifier">EnsureModule</span><span class="p_operator">(</span><span class="p_character">'{2DF8D04C-5BFA-101B-BDE5-00AA0044DE52}'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">2</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">bForDemand</span><span class="p_operator">=</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;Office&nbsp;9</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;The&nbsp;TLB&nbsp;defining&nbsp;the&nbsp;interfaces&nbsp;we&nbsp;implement</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">universal</span><span class="p_operator">.</span><span class="p_identifier">RegisterInterfaces</span><span class="p_operator">(</span><span class="p_character">'{AC0714F2-3D04-11D1-AE7D-00A0C90F26F4}'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_string">"_IDTExtensibility2"</span><span class="p_operator">])</span><span class="p_default"><br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">Target</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_character">'mail_transfer'</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
<div class="section" id="class-buttonevent">
<h2><a class="toc-backref" href="#id181" name="class-buttonevent">class ButtonEvent</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">ButtonEvent</span><span class="p_operator">:</span>
</div>
<div class="section" id="onclick">
<h3><a class="toc-backref" href="#id182" name="onclick">OnClick</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnClick</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">button</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">cancel</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#activeExplorer&nbsp;and&nbsp;MailTransferFolder&nbsp;are&nbsp;globals&nbsp;defined&nbsp;in&nbsp;OnConnection</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">sel</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">activeExplorer</span><span class="p_operator">.</span><span class="p_identifier">Selection</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">range</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">sel</span><span class="p_operator">.</span><span class="p_identifier">Count</span><span class="p_operator">+</span><span class="p_number">1</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">sel</span><span class="p_operator">.</span><span class="p_identifier">Item</span><span class="p_operator">(</span><span class="p_identifier">i</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">Move</span><span class="p_operator">(</span><span class="p_identifier">MailTransferFolder</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;<br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;</span><span class="p_identifier">cancel</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;</span>
</div>
</div>
</div>
<div class="section" id="class-folderevent">
<h2><a class="toc-backref" href="#id183" name="class-folderevent">class FolderEvent</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">FolderEvent</span><span class="p_operator">:</span>
</div>
<div class="section" id="onitemadd">
<h3><a class="toc-backref" href="#id184" name="onitemadd">OnItemAdd</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnItemAdd</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">s</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">socket</span><span class="p_operator">(</span><span class="p_identifier">AF_INET</span><span class="p_operator">,</span><span class="p_identifier">SOCK_STREAM</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">s</span><span class="p_operator">.</span><span class="p_identifier">connect</span><span class="p_operator">((</span><span class="p_character">'localhost'</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">8888</span><span class="p_operator">))</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">d</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">{}</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'Parent.Name'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">Parent</span><span class="p_operator">.</span><span class="p_identifier">Name</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'SenderName'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">SenderName</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'Subject'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">Subject</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'Body'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">Body</span><span class="p_operator">[:</span><span class="p_number">5000</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">d</span><span class="p_operator">[</span><span class="p_character">'CreationTime'</span><span class="p_operator">]</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">CreationTime</span><span class="p_operator">.</span><span class="p_identifier">Format</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">str</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">pickle</span><span class="p_operator">.</span><span class="p_identifier">dumps</span><span class="p_operator">(</span><span class="p_identifier">d</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">s</span><span class="p_operator">.</span><span class="p_identifier">send</span><span class="p_operator">(</span><span class="p_identifier">str</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#&nbsp;?Receive&nbsp;no&nbsp;more&nbsp;than&nbsp;1024&nbsp;bytes</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">s</span><span class="p_operator">.</span><span class="p_identifier">close</span><span class="p_operator">()</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">win32ui</span><span class="p_operator">.</span><span class="p_identifier">MessageBox</span><span class="p_operator">(</span><span class="p_string">"Sent&nbsp;%s&nbsp;to&nbsp;ListManager"</span><span class="p_operator">%</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">Subject</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pass</span>
</div>
</div>
</div>
<div class="section" id="class-outlookaddin">
<h2><a class="toc-backref" href="#id185" name="class-outlookaddin">class OutlookAddin</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">OutlookAddin</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_operator">&lt;&lt;</span><span class="p_default">&nbsp;</span><span class="p_word">class</span><span class="p_default">&nbsp;</span><span class="p_classname">OutlookAddin</span><span class="p_default">&nbsp;</span><span class="p_identifier">declarations</span><span class="p_default">&nbsp;</span><span class="p_operator">&gt;&gt;</span>
</div>
<div class="section" id="class-outlookaddin-declarations">
<h3><a class="toc-backref" href="#id186" name="class-outlookaddin-declarations">&lt;&lt; class OutlookAddin declarations &gt;&gt;</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">_com_interfaces_</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[</span><span class="p_character">'_IDTExtensibility2'</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">_public_methods_</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_operator">[]</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">_reg_clsctx_</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">pythoncom</span><span class="p_operator">.</span><span class="p_identifier">CLSCTX_INPROC_SERVER</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">_reg_clsid_</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"{0F47D9F3-598B-4d24-B7E3-92AC15ED27E2}"</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">_reg_progid_</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Python.Test.OutlookAddin"</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_identifier">_reg_policy_spec_</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"win32com.server.policy.EventHandlerPolicy"</span>
</div>
</div>
<div class="section" id="onconnection">
<h3><a class="toc-backref" href="#id187" name="onconnection">OnConnection</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_default">&nbsp;</span><span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnConnection</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">application</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">connectMode</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">addin</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">custom</span><span class="p_operator">):</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">global</span><span class="p_default">&nbsp;</span><span class="p_identifier">MailTransferFolder</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">global</span><span class="p_default">&nbsp;</span><span class="p_identifier">activeExplorer</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#&nbsp;ActiveExplorer&nbsp;may&nbsp;be&nbsp;none&nbsp;when&nbsp;started&nbsp;without&nbsp;a&nbsp;UI&nbsp;(eg,&nbsp;WinCE&nbsp;synchronisation)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">activeExplorer</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">application</span><span class="p_operator">.</span><span class="p_identifier">ActiveExplorer</span><span class="p_operator">()</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">activeExplorer</span><span class="p_operator">:</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">bars</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">activeExplorer</span><span class="p_operator">.</span><span class="p_identifier">CommandBars</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">toolbar</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">bars</span><span class="p_operator">.</span><span class="p_identifier">Item</span><span class="p_operator">(</span><span class="p_string">"Standard"</span><span class="p_operator">)</span><span class="p_default"><br/>
&nbsp;</span><span class="p_number">9</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">toolbar</span><span class="p_operator">.</span><span class="p_identifier">Controls</span><span class="p_operator">.</span><span class="p_identifier">Add</span><span class="p_operator">(</span><span class="p_identifier">Type</span><span class="p_operator">=</span><span class="p_identifier">constants</span><span class="p_operator">.</span><span class="p_identifier">msoControlButton</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">Temporary</span><span class="p_operator">=</span><span class="p_identifier">True</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">10</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">toolbarButton</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">DispatchWithEvents</span><span class="p_operator">(</span><span class="p_identifier">item</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">ButtonEvent</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#?&nbsp;just&nbsp;need&nbsp;this&nbsp;to&nbsp;be&nbsp;an&nbsp;ivar</span><span class="p_default"><br/>
</span><span class="p_number">11</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">Caption</span><span class="p_operator">=</span><span class="p_string">"List&nbsp;Manager"</span><span class="p_default"><br/>
</span><span class="p_number">12</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">TooltipText</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_string">"Click&nbsp;to&nbsp;move"</span><span class="p_default"><br/>
</span><span class="p_number">13</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">item</span><span class="p_operator">.</span><span class="p_identifier">Enabled</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">True</span><span class="p_default"><br/>
</span><span class="p_number">14</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_commentline">#self.toolbarButton&nbsp;=&nbsp;DispatchWithEvents(item,&nbsp;ButtonEvent)&nbsp;#need&nbsp;something&nbsp;that&nbsp;won't&nbsp;get&nbsp;GC'd.&nbsp;Note&nbsp;Dispatch&nbsp;returns&nbsp;item</span><span class="p_default"><br/>
</span><span class="p_number">15</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">16</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">ns</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">application</span><span class="p_operator">.</span><span class="p_identifier">GetNamespace</span><span class="p_operator">(</span><span class="p_string">"MAPI"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">17</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">Folders</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">ns</span><span class="p_operator">.</span><span class="p_identifier">Folders</span><span class="p_default"><br/>
</span><span class="p_number">18</span><span class="p_default">&nbsp;&nbsp;<br/>
</span><span class="p_number">19</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">range</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">Folders</span><span class="p_operator">)+</span><span class="p_number">1</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">20</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">Folders</span><span class="p_operator">[</span><span class="p_identifier">i</span><span class="p_operator">].</span><span class="p_identifier">Name</span><span class="p_operator">.</span><span class="p_identifier">find</span><span class="p_operator">(</span><span class="p_string">"Mailbox"</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_operator">!=</span><span class="p_default">&nbsp;</span><span class="p_operator">-</span><span class="p_number">1</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">21</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">folders</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">Folders</span><span class="p_operator">[</span><span class="p_identifier">i</span><span class="p_operator">].</span><span class="p_identifier">Folders</span><span class="p_default"><br/>
</span><span class="p_number">22</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">break</span><span class="p_default"><br/>
</span><span class="p_number">23</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">24</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">win32ui</span><span class="p_operator">.</span><span class="p_identifier">MessageBox</span><span class="p_operator">(</span><span class="p_string">"Can't&nbsp;find&nbsp;Mailbox!"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">25</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">return</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">26</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
</span><span class="p_number">27</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">for</span><span class="p_default">&nbsp;</span><span class="p_identifier">i</span><span class="p_default">&nbsp;</span><span class="p_word">in</span><span class="p_default">&nbsp;</span><span class="p_identifier">range</span><span class="p_operator">(</span><span class="p_number">1</span><span class="p_operator">,</span><span class="p_identifier">len</span><span class="p_operator">(</span><span class="p_identifier">folders</span><span class="p_operator">)+</span><span class="p_number">1</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">28</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">if</span><span class="p_default">&nbsp;</span><span class="p_identifier">folders</span><span class="p_operator">[</span><span class="p_identifier">i</span><span class="p_operator">].</span><span class="p_identifier">Name</span><span class="p_default">&nbsp;</span><span class="p_operator">==</span><span class="p_default">&nbsp;</span><span class="p_identifier">Target</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">29</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">MailTransferFolder</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">folders</span><span class="p_operator">[</span><span class="p_identifier">i</span><span class="p_operator">]</span><span class="p_default"><br/>
</span><span class="p_number">30</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">self</span><span class="p_operator">.</span><span class="p_identifier">targetMailbox</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">DispatchWithEvents</span><span class="p_operator">(</span><span class="p_identifier">folders</span><span class="p_operator">[</span><span class="p_identifier">i</span><span class="p_operator">].</span><span class="p_identifier">Items</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">FolderEvent</span><span class="p_operator">)</span><span class="p_default">&nbsp;</span><span class="p_commentline">#?&nbsp;just&nbsp;need&nbsp;this&nbsp;to&nbsp;be&nbsp;an&nbsp;ivar</span><span class="p_default"><br/>
</span><span class="p_number">31</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">win32ui</span><span class="p_operator">.</span><span class="p_identifier">MessageBox</span><span class="p_operator">(</span><span class="p_string">"Enabled:&nbsp;%s\nOutlookAddin3"</span><span class="p_operator">%</span><span class="p_identifier">Target</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">32</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">break</span><span class="p_default"><br/>
</span><span class="p_number">33</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">else</span><span class="p_operator">:</span>
</div>
</div>
<div class="section" id="ondisconnection">
<h3><a class="toc-backref" href="#id188" name="ondisconnection">OnDisconnection</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnDisconnection</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">mode</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">custom</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"OnDisconnection"</span>
</div>
</div>
<div class="section" id="onaddinsupdate">
<h3><a class="toc-backref" href="#id189" name="onaddinsupdate">OnAddInsUpdate</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnAddInsUpdate</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">custom</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"OnAddInsUpdate"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">custom</span>
</div>
</div>
<div class="section" id="onstartupcomplete">
<h3><a class="toc-backref" href="#id190" name="onstartupcomplete">OnStartupComplete</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnStartupComplete</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">custom</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"OnStartupComplete"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">custom</span>
</div>
</div>
<div class="section" id="onbeginshutdown">
<h3><a class="toc-backref" href="#id191" name="onbeginshutdown">OnBeginShutdown</a></h3>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">OnBeginShutdown</span><span class="p_operator">(</span><span class="p_identifier">self</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">custom</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">print</span><span class="p_default">&nbsp;</span><span class="p_string">"OnBeginShutdown"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">custom</span>
</div>
</div>
</div>
<div class="section" id="registeraddin">
<h2><a class="toc-backref" href="#id192" name="registeraddin">RegisterAddin</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">RegisterAddin</span><span class="p_operator">(</span><span class="p_identifier">klass</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">key</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">CreateKey</span><span class="p_operator">(</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">HKEY_CURRENT_USER</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Software\\Microsoft\\Office\\Outlook\\Addins"</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">subkey</span><span class="p_default">&nbsp;</span><span class="p_operator">=</span><span class="p_default">&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">CreateKey</span><span class="p_operator">(</span><span class="p_identifier">key</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">klass</span><span class="p_operator">.</span><span class="p_identifier">_reg_progid_</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">SetValueEx</span><span class="p_operator">(</span><span class="p_identifier">subkey</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"CommandLineSafe"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">REG_DWORD</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">SetValueEx</span><span class="p_operator">(</span><span class="p_identifier">subkey</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"LoadBehavior"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">REG_DWORD</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">3</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">7</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">SetValueEx</span><span class="p_operator">(</span><span class="p_identifier">subkey</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Description"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">REG_SZ</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">klass</span><span class="p_operator">.</span><span class="p_identifier">_reg_progid_</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">8</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">SetValueEx</span><span class="p_operator">(</span><span class="p_identifier">subkey</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"FriendlyName"</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_number">0</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">REG_SZ</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_identifier">klass</span><span class="p_operator">.</span><span class="p_identifier">_reg_progid_</span><span class="p_operator">)</span>
</div>
</div>
<div class="section" id="unregisteraddin">
<h2><a class="toc-backref" href="#id193" name="unregisteraddin">UnregisterAddin</a></h2>
<p><strong>code</strong>:</p>
<div class="code-block">
<span class="p_number">1</span><span class="p_default">&nbsp;&nbsp;</span><span class="p_word">def</span><span class="p_default">&nbsp;</span><span class="p_defname">UnregisterAddin</span><span class="p_operator">(</span><span class="p_identifier">klass</span><span class="p_operator">):</span><span class="p_default"><br/>
</span><span class="p_number">2</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">import</span><span class="p_default">&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_default"><br/>
</span><span class="p_number">3</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">try</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">4</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">DeleteKey</span><span class="p_operator">(</span><span class="p_identifier">_winreg</span><span class="p_operator">.</span><span class="p_identifier">HKEY_CURRENT_USER</span><span class="p_operator">,</span><span class="p_default">&nbsp;</span><span class="p_string">"Software\\Microsoft\\Office\\Outlook\\Addins\\"</span><span class="p_default">&nbsp;</span><span class="p_operator">+</span><span class="p_default">&nbsp;</span><span class="p_identifier">klass</span><span class="p_operator">.</span><span class="p_identifier">_reg_progid_</span><span class="p_operator">)</span><span class="p_default"><br/>
</span><span class="p_number">5</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_word">except</span><span class="p_default">&nbsp;</span><span class="p_identifier">WindowsError</span><span class="p_operator">:</span><span class="p_default"><br/>
</span><span class="p_number">6</span><span class="p_default">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="p_identifier">pass</span>
</div>
</div>
</div>
</div>
</body>

<!-- Mirrored from webpages.charter.net/edreamleo/ListManagerDocs.html by HTTrack Website Copier/3.x [XR&CO'2010], Fri, 22 Feb 2013 17:56:05 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
</html>
